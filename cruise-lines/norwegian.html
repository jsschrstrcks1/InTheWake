<!doctype html>
<html lang="en">
<head>
<!-- ai-breadcrumbs
     entity: Norwegian Cruise Line
     type: Cruise Line Comparison
     parent: /cruise-lines.html
     category: Cruise Line Information
     updated: 2025-11-18
     expertise: Cruise line comparisons, fleet analysis, policy research, cruise planning
     target-audience: Cruise line comparison shoppers, first-time cruisers, travel planners
     answer-first: Norwegian: Freestyle Cruising with flexible dining, no set schedules, modern ships from Jewel to Prima Class, go-kart tracks, Broadway shows, The Haven luxury suites.
     core-facts: Freestyle Cruising philosophy (flexible dining, no set schedules); fleet ranges from Jewel Class to Prima Class; signature features include The Haven suites, Broadway shows, go-kart tracks; no mandatory formal nights
     decisions-informed: which Norwegian ship class matches your style; how Freestyle dining works; whether The Haven luxury experience is worth the upgrade
     -->
  <!--
    In the Wake — Norwegian Cruise Line (v3.007a)
    Reverently crafted. Soli Deo Gloria.
  -->

  <!-- Analytics -->
  <script defer src="https://cloud.umami.is/script.js"
          data-website-id="9661a449-3ba9-49ea-88e8-4493363578d2"></script>

  <!-- Standards: absolute URL + origin normalizer -->
  <script>
  (function(){
    const ORIGIN=(location.origin||(location.protocol+"//"+location.host)).replace(/\/$/,'');
    window._abs=p=>{p=String(p||''); if(!p.startsWith('/')) p='/'+p; return ORIGIN+p};
    document.addEventListener('DOMContentLoaded',()=>{
      const sel=[
        'a[href^="https://www.cruisinginthewake.com/"]',
        'img[src^="https://www.cruisinginthewake.com/"]',
        'link[href^="https://www.cruisinginthewake.com/"]',
        'script[src^="https://www.cruisinginthewake.com/"]'
      ].join(',');
      document.querySelectorAll(sel).forEach(el=>{
        const attr=el.hasAttribute('href')?'href':'src';
        try{ const u=new URL(el.getAttribute(attr));
             el.setAttribute(attr, ORIGIN+u.pathname+u.search+u.hash);
        }catch(_){}
      });
    },{once:true});
  })();
  </script>

  <!-- External link hardening -->
  <script>
  document.addEventListener('click',e=>{
    const a=e.target.closest&&e.target.closest('a[href]'); if(!a) return;
    try{ const u=new URL(a.href,location.href);
         if(u.origin!==location.origin){ a.target='_blank'; a.rel='noopener'; }
    }catch(_){}
  },{capture:true});
  </script>

  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Norwegian — In the Wake (v3.007a)</title>
  <meta name="version" content="3.010.300"/>
  <meta name="description" content="Norwegian Cruise Line at a glance — ship classes, standout venues, accessibility notes, and practical tips."/>
  <meta name="robots" content="index,follow"/>

  <!-- ICP-Lite v1.0: AI-First Metadata -->
  <meta name="ai-summary" content="Norwegian Cruise Line guide: Freestyle Cruising with flexible dining, no set schedules, Broadway shows, The Haven luxury suites, go-kart tracks, and modern ships from Jewel to Prima Class."/>
  <meta name="last-reviewed" content="2025-11-18"/>
  <meta name="content-protocol" content="ICP-Lite v1.0"/>

  <!-- Canonical / Social -->
  <link rel="canonical" href="https://www.cruisinginthewake.com/cruise-lines/norwegian.html"/>
  <meta property="og:type" content="website"/>
  <meta property="og:site_name" content="In the Wake"/>
  <meta property="og:url" content="https://www.cruisinginthewake.com/cruise-lines/norwegian.html"/>
  <meta property="og:title" content="Norwegian Cruise Line — In the Wake"/>
  <meta property="og:description" content="Freestyle cruising with ship classes, venues, and honest traveler notes."/>
  <meta property="og:image" content="https://www.cruisinginthewake.com/assets/social/cruise-lines-hero.jpg?v=3.007a"/>
  <meta name="twitter:card" content="summary_large_image"/>

  <!-- Structured Data -->
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[
    {"@type":"ListItem","position":1,"name":"Home","item":"https://www.cruisinginthewake.com/"},
    {"@type":"ListItem","position":2,"name":"Cruise Lines","item":"https://www.cruisinginthewake.com/cruise-lines/"},
    {"@type":"ListItem","position":3,"name":"Norwegian","item":"https://www.cruisinginthewake.com/cruise-lines/norwegian.html"}
  ]}
  </script>

  <!-- JSON-LD: WebPage (ICP-Lite) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Norwegian Cruise Line — In the Wake",
    "url": "https://www.cruisinginthewake.com/cruise-lines/norwegian.html",
    "description": "Norwegian Cruise Line guide: Freestyle Cruising with flexible dining, no set schedules, Broadway shows, The Haven luxury suites, go-kart tracks, and modern ships from Jewel to Prima Class."
  }
  </script>

  <!-- JSON-LD: FAQPage (ICP-Lite) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What is Freestyle Cruising on Norwegian?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Freestyle Cruising is Norwegian's signature approach: no set dining times, flexible dress codes, and freedom to choose from multiple restaurants each night. Guests dine when they want, wear what feels comfortable, and skip the rigid schedules common on other lines."
        }
      },
      {
        "@type": "Question",
        "name": "What is The Haven on Norwegian Cruise Line?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The Haven is Norwegian's ship-within-a-ship luxury experience, offering exclusive suites, a private sundeck, dedicated pool, concierge service, and priority access to shows and dining. It's perfect for guests seeking premium accommodations with VIP treatment."
        }
      },
      {
        "@type": "Question",
        "name": "What ship classes does Norwegian operate?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Norwegian operates Prima Class (newest, with go-kart tracks), Breakaway and Breakaway Plus Classes (urban-inspired design), Jewel Class (mid-size family ships), and other classes ranging from intimate to mega-ship scale."
        }
      },
      {
        "@type": "Question",
        "name": "Does Norwegian require formal nights?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Norwegian's Freestyle philosophy means no mandatory formal nights. While some specialty restaurants encourage smart casual or elegant attire, guests have the freedom to dress comfortably throughout the cruise."
        }
      }
    ]
  }
  </script>

  <!-- SiteCache + SW -->
  <script src="/assets/js/site-cache.js" defer></script>
  <script>
  if('serviceWorker' in navigator){
    addEventListener('load',()=>navigator.serviceWorker.register('/sw.js').catch(()=>{}));
  }
  </script>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/styles.css?v=3.007a"/>
  <link rel="preload" as="image" href="/assets/compass_rose.svg"/>

  <!-- Page styles (single hero; no duplication with global .hero) -->
  <style>
    :root{ --rope:#D9B382; --ink:#0f2a3a; --foam:#eef7fb; --accent:#0e6e8e; }
    body.page{ background:linear-gradient(var(--foam),#fff 240px); color:var(--ink); }

    /* Keep global hero but adjust vibrancy only, without adding a second hero layer */
    .hero-header .hero{
      filter:saturate(1.18) contrast(1.06) brightness(1.04);
    }
    .hero::before,.hero::after{ content:none!important; }

    /* Hide duplicate brand title blocks from older snippets */
    .brand-title{ display:none!important; }

    /* Card watermark, subtle and accessible */
    .card{ position:relative; overflow:hidden }
    .card::after{
      content:""; position:absolute; inset:0; margin:auto;
      width:min(60%,360px); height:min(60%,360px);
      background:url('/assets/watermark.png') center/contain no-repeat;
      opacity:.06; pointer-events:none;
    }

    /* Local grids for gallery & lists */
    .grid{ display:grid; gap:1rem; }
    .grid.gallery{ grid-template-columns:1fr; }
    @media (min-width:800px){ .grid.gallery{ grid-template-columns:repeat(2,minmax(0,1fr)); } }

    /* Small badges */
    .badge{ display:inline-block; font-size:.78rem; padding:.1rem .45rem; border:1px solid var(--rope);
            border-radius:999px; background:#fff; margin-left:.35rem; }

    /* Search area */
    .search{ display:flex; gap:.5rem; flex-wrap:wrap; align-items:center; }
    .search input[type="search"]{ flex:1 1 260px; padding:.55rem .7rem; border:1px solid #cfe1ea; border-radius:10px; }
    .search button{ padding:.55rem .8rem; border:1px dashed var(--rope); border-radius:10px; background:#fff; cursor:pointer; }
    #searchResults .result{ padding:.6rem .7rem; border:1px solid var(--rope); border-radius:12px; background:#fff; }
  /* Header / Hero */
  .hero-header {
    position: relative;
    border-bottom: 6px double var(--rope);
    background: #eaf6f6;
    z-index: 9000;
  }

  .navbar {
    max-width: 1100px;
    margin: 0 auto;
    display: flex;
    align-items: flex-end;
    gap: .6rem;
    padding: .5rem .9rem .35rem;
    position: relative;
    z-index: 2000;
    overflow: visible;
  }

  .brand {
    display: flex;
    align-items: flex-end;
    gap: .6rem;
  }

  .brand img {
    height: 28px;
    width: auto;
  }

  .version-badge {
    font-size: .72rem;
    opacity: .8;
    color: var(--text-muted);
  }
  </style>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Ken Baker",
  "url": "https://inthewake.com/about/ken-baker.html",
  "jobTitle": "Cruise Research Analyst & Data Specialist",
  "description": "Cruise industry analyst specializing in ship comparisons, deck plan analysis, and dining venue research.",
  "knowsAbout": [
    "Cruise Ship Analysis",
    "Deck Plans",
    "Royal Caribbean",
    "Cruise Dining",
    "Ship Comparisons"
  ]
}
</script>
</head>

<body class="page">
  <a class="skip-link" href="#content">Skip to main content</a>

  <header class="hero-header">
    <div class="navbar">
      <div class="brand">
        <img src="/assets/logo_wake_256.png" srcset="/assets/logo_wake_256.png 1x, /assets/logo_wake_512.png 2x" width="256" height="259" alt="In the Wake wordmark" decoding="async"/>
        <span class="version-badge tiny">v3.007a</span>
      </div>
            <nav class="site-nav" aria-label="Main site navigation">
        <a class="nav-pill" href="/">Home</a>

        <!-- Planning Dropdown -->
        <div class="nav-dropdown" id="nav-planning">
          <button class="nav-pill" type="button" aria-expanded="false" aria-haspopup="true">
            Planning <span class="caret">&#9662;</span>
          </button>
          <div class="dropdown-menu" role="menu">
            <a href="/planning.html">Planning (overview)</a>
            <a href="/ships.html">Ships</a>
            <a href="/restaurants.html">Restaurants &amp; Menus</a>
            <a href="/ports.html">Ports</a>
            <a href="/drink-packages.html">Drink Packages</a>
            <a href="/drink-calculator.html">Drink Calculator</a>
            <a href="/stateroom-check.html">Stateroom Check</a>
            <a href="/cruise-lines.html">Cruise Lines</a>
            <a href="/packing-lists.html">Packing Lists</a>
            <a href="/accessibility.html">Accessibility</a>
          </div>
        </div>

        <!-- Travel Dropdown -->
        <div class="nav-dropdown" id="nav-travel">
          <button class="nav-pill" type="button" aria-expanded="false" aria-haspopup="true">
            Travel <span class="caret">&#9662;</span>
          </button>
          <div class="dropdown-menu" role="menu">
            <a href="/travel.html">Travel (overview)</a>
            <a href="/solo.html">Solo</a>
          </div>
        </div>

        <a class="nav-pill" href="/tools/port-tracker.html">Port Tracker</a>
        <a class="nav-pill" href="/tools/ship-tracker.html">Ship Tracker</a>
        <a class="nav-pill" href="/search.html">Search</a>
        <a class="nav-pill" href="/about-us.html">About</a>
      </nav>
      
    </div>

    <div class="hero" role="img" aria-label="Ship wake at sunrise">
      <div class="latlon-grid" aria-hidden="true"></div>
      <img class="hero-compass" src="/assets/compass_rose.svg?v=3.010.300" width="180" height="180" alt="" aria-hidden="true" decoding="async"/>
      <div class="hero-title">
        <img class="logo" src="/assets/logo_wake_560.png" srcset="/assets/logo_wake_560.png 1x, /assets/logo_wake_1120.png 2x" alt="In the Wake" decoding="async" fetchpriority="high" width="560" height="567"/>
      </div>
      <div class="tagline" aria-hidden="true">A Cruise Traveler's Logbook</div>
      <div class="hero-credit">
        <a class="pill long" href="https://www.instagram.com/flickersofmajesty/" target="_blank" rel="noopener">Photo by Flickers of Majesty — Instagram</a>
      </div>
    </div>
  </header>

  <main class="wrap" id="content">
    <!-- ICP-Lite v1.0: Answer-First Content -->
    <section class="icp-header card" aria-labelledby="line-name">
      <h1 id="line-name">Norwegian Cruise Line</h1>
      <p class="answer-line"><strong>Quick Answer:</strong> Norwegian Cruise Line pioneered Freestyle Cruising—flexible dining with no set times, relaxed dress codes, and freedom to choose from multiple restaurants each night. The fleet ranges from Jewel Class to modern Prima Class ships featuring go-kart tracks, The Haven luxury suites, Broadway shows, and diverse dining options.</p>

      <div class="fit-guidance">
        <h2>Is Norwegian Right for You?</h2>
        <p>Norwegian invites cruisers who prefer flexibility over formality. Freestyle Cruising means you dine when you want, wear what feels comfortable, and skip the rigid schedules that define traditional cruising. From Broadway productions to poolside movies, go-kart racing to serene spa days, Norwegian balances active energy with relaxed freedom.</p>
        <p>Perfect for families wanting variety, solo travelers (with studio cabins designed for singles), and couples who appreciate choice without fuss. The Haven offers a ship-within-a-ship luxury experience for those seeking elevated service. Dining reservations are recommended but never mandatory—spontaneity is encouraged.</p>
      </div>

      <div class="key-facts">
        <h2>Key Facts at a Glance</h2>
        <ul>
          <li><strong>Ship Classes:</strong> Prima, Breakaway Plus, Breakaway, Jewel, and earlier classes</li>
          <li><strong>Signature Philosophy:</strong> Freestyle Cruising (flexible dining, no set schedules, relaxed dress)</li>
          <li><strong>Best For:</strong> Flexibility-focused travelers, families, solo cruisers, Broadway fans</li>
          <li><strong>Unique Features:</strong> The Haven luxury suites, go-kart tracks (Prima/Encore), studio cabins for solo travelers</li>
          <li><strong>Resources Available:</strong> Ship search, class overviews, venue details, detailed ship pages (coming soon)</li>
        </ul>
      </div>
    </section>

    <section class="card">
      <h2>Gallery</h2>
      <div class="grid gallery">
        <figure>
          <img src="https://jsschrstrcks1.github.io/assets/cruise-lines/norwegian-hero-1.jpg" alt="Norwegian Cruise Line ship at sea">
          <figcaption class="tiny">Image: Wikimedia Commons — replace with final credited media.</figcaption>
        </figure>
        <figure>
          <img src="https://jsschrstrcks1.github.io/assets/cruise-lines/norwegian-hero-2.jpg" alt="Norwegian Cruise Line deck view">
          <figcaption class="tiny">Image: Wikimedia Commons — replace with final credited media.</figcaption>
        </figure>
      </div>
    </section>

    <section id="classes" class="card">
      <h2>Ship Classes</h2>
      <div class="grid">
        <div class="card">
          <h3>Prima Class <span class="badge">launched 2022</span></h3>
          <ul>
            <li><a href="https://jsschrstrcks1.github.io/ships/ncl-prima.html">Norwegian Prima</a></li>
            <li><a href="https://jsschrstrcks1.github.io/ships/ncl-viva.html">Norwegian Viva</a></li>
          </ul>
        </div>
        <div class="card">
          <h3>Breakaway Plus <span class="badge">launched 2015</span></h3>
          <ul>
            <li><a href="https://jsschrstrcks1.github.io/ships/ncl-bliss.html">Norwegian Bliss</a></li>
            <li><a href="https://jsschrstrcks1.github.io/ships/ncl-encore.html">Norwegian Encore</a></li>
            <li><a href="https://jsschrstrcks1.github.io/ships/ncl-escape.html">Norwegian Escape</a></li>
            <li><a href="https://jsschrstrcks1.github.io/ships/ncl-joy.html">Norwegian Joy</a></li>
          </ul>
        </div>
      </div>
    </section>

    <section id="ships" class="card">
      <h2>Ships A–Z</h2>
      <ul>
        <li><a href="https://jsschrstrcks1.github.io/ships/ncl-bliss.html">Norwegian Bliss</a></li>
        <li><a href="https://jsschrstrcks1.github.io/ships/ncl-encore.html">Norwegian Encore</a></li>
        <li><a href="https://jsschrstrcks1.github.io/ships/ncl-escape.html">Norwegian Escape</a></li>
        <li><a href="https://jsschrstrcks1.github.io/ships/ncl-joy.html">Norwegian Joy</a></li>
        <li><a href="https://jsschrstrcks1.github.io/ships/ncl-prima.html">Norwegian Prima</a></li>
        <li><a href="https://jsschrstrcks1.github.io/ships/ncl-viva.html">Norwegian Viva</a></li>
      </ul>
    </section>

    <section id="coming" class="card">
      <h2>Coming Soon</h2>
      <p>We’re charting a full <em>depth sounding</em> of the Norwegian experience. Expect clear, practical breakdowns of each ship class — how Prima differs from Breakaway Plus in layout and feel, where the quiet corners hide, and which decks hum after dark. You’ll see cabin tips, pool-deck realities, and traffic-flow notes that help your days run smooth.</p>
      <p>Dining gets equal treatment: complimentary mainstays vs. specialty favorites, sample prices, and which venues shine for breakfast, date night, or a late bite. We’ll connect menus and <a href="/accessibility.html">accessibility</a> notes to specific ships and sailings so you can plan with confidence, not guesswork.</p>
      <p>Finally, we’ll thread it all together with practical “you’ll-thank-yourself” advice — embarkation timing, show reservations, thermal-suite etiquette, and what to pack for NCL’s vibe. No brochure fluff, just hard-won traveler insight to make your cruise sing.</p>
    </section>

    <section id="search" class="card">
      <h2>Search Ships</h2>
      <div class="search" role="search">
        <input id="shipSearch" type="search" placeholder="Type a ship name… (tolerates typos)" aria-label="Search Norwegian ships"/>
        <button id="btnSearch" type="button">Search</button>
      </div>
      <div id="searchResults" class="grid" aria-live="polite" aria-busy="false"></div>
    </section>

    <!-- ICP-Lite v1.0: FAQ Section -->
    <section class="card faq" aria-labelledby="faq-heading">
      <h2 id="faq-heading">Frequently Asked Questions</h2>

      <div class="faq-item">
        <h3>What is Freestyle Cruising on Norwegian?</h3>
        <p>Freestyle Cruising is Norwegian's signature approach: no set dining times, flexible dress codes, and freedom to choose from multiple restaurants each night. Guests dine when they want, wear what feels comfortable, and skip the rigid schedules common on other lines.</p>
      </div>

      <div class="faq-item">
        <h3>What is The Haven on Norwegian Cruise Line?</h3>
        <p>The Haven is Norwegian's ship-within-a-ship luxury experience, offering exclusive suites, a private sundeck, dedicated pool, concierge service, and priority access to shows and dining. It's perfect for guests seeking premium accommodations with VIP treatment.</p>
      </div>

      <div class="faq-item">
        <h3>What ship classes does Norwegian operate?</h3>
        <p>Norwegian operates Prima Class (newest, with go-kart tracks), Breakaway and Breakaway Plus Classes (urban-inspired design), Jewel Class (mid-size family ships), and other classes ranging from intimate to mega-ship scale.</p>
      </div>

      <div class="faq-item">
        <h3>Does Norwegian require formal nights?</h3>
        <p>Norwegian's Freestyle philosophy means no mandatory formal nights. While some specialty restaurants encourage smart casual or elegant attire, guests have the freedom to dress comfortably throughout the cruise.</p>
      </div>
    </section>

    <section class="card">
      <h3>Image Credits</h3>
      <p class="tiny">Hero and supplemental images: Wikimedia Commons (place final, specific attributions upon publication).</p>
    </section>
  </main>

  <footer class="wrap" role="contentinfo" style="text-align:center">
    © 2025 In the Wake — A Cruise Traveler’s Logbook · <a href="/accessibility.html">Accessibility &amp; WCAG 2.1 AA Commitment</a>
  </footer>

  <!-- Tiny, self-contained typo-tolerant ship search -->
  <script>
  (function(){
    const DATA = [
      {name:"Norwegian Prima",  url:"ncl-prima.html",  aliases:["NCL Prima","Norweigan Prima","Norweigian Prima"]},
      {name:"Norwegian Viva",   url:"ncl-viva.html",   aliases:["NCL Viva","Norweigan Viva"]},
      {name:"Norwegian Escape", url:"ncl-escape.html", aliases:["NCL Escape","Norweigan Escape"]},
      {name:"Norwegian Bliss",  url:"ncl-bliss.html",  aliases:["NCL Bliss","Norweigan Bliss"]},
      {name:"Norwegian Joy",    url:"ncl-joy.html",    aliases:["NCL Joy","Norweigan Joy"]},
      {name:"Norwegian Encore", url:"ncl-encore.html", aliases:["NCL Encore","Norweigan Encore"]}
    ];
    const $=s=>document.querySelector(s);
    const $$=s=>Array.from(document.querySelectorAll(s));
    const norm=s=>String(s||'').toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').trim();

    function score(q, text){
      // simple contains + prefix boost; crude but fast and kind to typos
      if(!q) return 1;
      if(text.startsWith(q)) return 0.1;
      if(text.includes(q))   return 0.3;
      // one-off deletion/insertion tolerance
      const a=text, b=q; let i=0,j=0,err=0;
      while(i<a.length && j<b.length){
        if(a[i]===b[j]){i++;j++;continue;}
        err++; if(err>1) return 10;
        (a.length>b.length)?i++:(a.length<b.length)?j++:(i++,j++);
      }
      return 0.6;
    }

    function setup(){
      const input=$('#shipSearch'), btn=$('#btnSearch'), out=$('#searchResults');
      if(!input||!btn||!out) return;
      function run(){
        const q=norm(input.value);
        out.setAttribute('aria-busy','true');
        const items=DATA.map(d=>{
          const hay=[d.name].concat(d.aliases||[]).map(norm).join(' | ');
          return {d, sc: Math.min(
            score(q, norm(d.name)),
            ...((d.aliases||[]).map(a=>score(q, norm(a))))
          )};
        }).filter(x=>!q || x.sc<10).sort((a,b)=>a.sc-b.sc).slice(0,12);
        out.innerHTML = items.length
          ? items.map(x=>`<a class="result" href="${x.d.url}"><strong>${x.d.name}</strong><br><small>${(x.d.aliases||[]).join(', ')}</small></a>`).join('')
          : `<div class="result"><em>No matches yet. Try “Prima” or “Encore”.</em></div>`;
        out.setAttribute('aria-busy','false');
      }
      input.addEventListener('input', ()=>{ clearTimeout(input._t); input._t=setTimeout(run,90); });
      btn.addEventListener('click', run);
      run();
    }
    (document.readyState==='loading')?document.addEventListener('DOMContentLoaded',setup,{once:true}):setup();
  })();
  </script>

    <!-- Navigation dropdown functionality (New Clean Implementation) -->
  <script>
  (function() {
    'use strict';
    var dropdowns = document.querySelectorAll('.nav-dropdown');
    function toggleDropdown(dropdown) {
      var isOpen = dropdown.classList.contains('open');
      closeAllDropdowns();
      if (!isOpen) {
        dropdown.classList.add('open');
        var btn = dropdown.querySelector('button');
        if (btn) btn.setAttribute('aria-expanded', 'true');
      }
    }
    function closeAllDropdowns() {
      dropdowns.forEach(function(dd) {
        dd.classList.remove('open');
        var btn = dd.querySelector('button');
        if (btn) btn.setAttribute('aria-expanded', 'false');
      });
    }
    dropdowns.forEach(function(dropdown) {
      var btn = dropdown.querySelector('button');
      if (btn) {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          toggleDropdown(dropdown);
        });
        btn.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') { closeAllDropdowns(); btn.focus(); }
          if (e.key === 'ArrowDown') {
            e.preventDefault();
            dropdown.classList.add('open');
            btn.setAttribute('aria-expanded', 'true');
            var firstLink = dropdown.querySelector('.dropdown-menu a');
            if (firstLink) firstLink.focus();
          }
        });
      }
      var menu = dropdown.querySelector('.dropdown-menu');
      if (menu) {
        menu.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') { closeAllDropdowns(); if (btn) btn.focus(); }
        });
      }
    });
    document.addEventListener('click', function(e) {
      var isInsideDropdown = false;
      dropdowns.forEach(function(dd) { if (dd.contains(e.target)) isInsideDropdown = true; });
      if (!isInsideDropdown) closeAllDropdowns();
    });
  })();
  </script>
</body>
</html>
