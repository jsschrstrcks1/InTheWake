<!doctype html>
<html lang="en">
<head>
  <!-- ===== Critical meta first (v3.006.016) ===== -->
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="referrer" content="no-referrer"/>
  <meta name="robots" content="index, follow"/>
  <meta name="version" content="3.006.016"/>

  <title>Grandeur of the Seas — Deck Plans, Live Tracker, Dining & Videos | In the Wake</title>
  <meta name="description" content="Grandeur of the Seas: deck plans, live tracker, dining venues, and stateroom videos. Plan your Royal Caribbean cruise with In the Wake."/>

  <!-- Canonical -->
  <link rel="canonical" href="https://www.cruisinginthewake.com/ships/rcl/grandeur-of-the-seas.html"/>

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="article"/>
  <meta property="og:site_name" content="In the Wake"/>
  <meta property="og:url" content="https://www.cruisinginthewake.com/ships/rcl/grandeur-of-the-seas.html"/>
  <meta property="og:title" content="Grandeur of the Seas — Deck Plans, Live Tracker, Dining & Videos"/>
  <meta property="og:description" content="All the essentials for Grandeur of the Seas: live map, dining, stats, and videos."/>
  <meta property="og:image" content="https://www.cruisinginthewake.com/ships/assets/grandeur-of-the-seas1.jpg?v=3.006.016"/>
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="Grandeur of the Seas — Deck Plans, Live Tracker, Dining & Videos"/>
  <meta name="twitter:description" content="Live tracker, dining, deck plans, and videos for Grandeur of the Seas."/>
  <meta name="twitter:image" content="https://www.cruisinginthewake.com/ships/assets/grandeur-of-the-seas1.jpg?v=3.006.016"/>

  <!-- Organization -->
  <script type="application/ld+json">{
    "@context":"https://schema.org","@type":"Organization",
    "name":"In the Wake","url":"https://www.cruisinginthewake.com/",
    "logo":"https://www.cruisinginthewake.com/assets/logo_wake.png",
    "sameAs":["https://www.instagram.com/flickersofmajesty/","https://www.youtube.com/@cruisinginthewake"]
  }</script>

  <!-- WebSite + SearchAction -->
  <script type="application/ld+json">{
    "@context":"https://schema.org","@type":"WebSite",
    "name":"In the Wake","url":"https://www.cruisinginthewake.com/",
    "potentialAction":{"@type":"SearchAction",
      "target":"https://www.cruisinginthewake.com/search.html?q={query}",
      "query-input":"required name=query"}
  }</script>

  <!-- Breadcrumbs -->
  <script type="application/ld+json">{
    "@context":"https://schema.org","@type":"BreadcrumbList","name":"Site Breadcrumbs",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://www.cruisinginthewake.com/"},
      {"@type":"ListItem","position":2,"name":"Ships","item":"https://www.cruisinginthewake.com/ships/ships.html"},
      {"@type":"ListItem","position":3,"name":"Grandeur of the Seas","item":"https://www.cruisinginthewake.com/ships/rcl/grandeur-of-the-seas.html"}
    ]
  }</script>

  <!-- Review -->
  <script type="application/ld+json">{
    "@context":"https://schema.org","@type":"Review",
    "name":"Grandeur of the Seas Overview",
    "author":{"@type":"Person","name":"In the Wake Editorial Team"},
    "reviewBody":"Grandeur of the Seas brings Vision-class intimacy, warm service, and easy days onboard—classic Royal in a smaller package.",
    "reviewRating":{"@type":"Rating","ratingValue":"4.5","bestRating":"5","worstRating":"1"},
    "itemReviewed":{"@type":"Cruise","name":"Grandeur of the Seas",
      "provider":{"@type":"Organization","name":"Royal Caribbean International","url":"https://www.royalcaribbean.com"},
      "url":"https://www.cruisinginthewake.com/ships/rcl/grandeur-of-the-seas.html",
      "image":"https://www.cruisinginthewake.com/ships/assets/grandeur-of-the-seas1.jpg?v=3.006.016",
      "description":"A Vision-class cruise ship operated by Royal Caribbean International."}
  }</script>

  <!-- ===== Standards helpers (absolute URL + origin normalizer) ===== -->
  <script>
  (function(){
    const ORIGIN=(location.origin||(location.protocol+'//'+location.host)).replace(/\/$/,'');
    window._abs=function(path){ path=String(path||''); if(!path.startsWith('/')) path='/'+path; return ORIGIN+path; };
    document.addEventListener('DOMContentLoaded', function(){
      const sel=[
        'a[href^="https://www.cruisinginthewake.com/"]',
        'img[src^="https://www.cruisinginthewake.com/"]',
        'link[href^="https://www.cruisinginthewake.com/"]',
        'script[src^="https://www.cruisinginthewake.com/"]'
      ].join(',');
      document.querySelectorAll(sel).forEach(el=>{
        const attr=el.hasAttribute('href')?'href':'src';
        try{ const u=new URL(el.getAttribute(attr));
          el.setAttribute(attr, ORIGIN+u.pathname+u.search+u.hash);
        }catch(_){}
      });
    },{once:true});
  })();
  </script>

  <!-- ===== CSS (versioned) ===== -->
  <link rel="preload" as="style" href="https://www.cruisinginthewake.com/assets/styles.css?v=3.006.016">
  <link rel="stylesheet" href="https://www.cruisinginthewake.com/assets/styles.css?v=3.006.016">

  <!-- Preload only assets used at first paint -->
  <link rel="preload" as="image" href="https://www.cruisinginthewake.com/assets/index_hero.jpg?v=3.006.016">
  <link rel="preload" as="image" href="https://www.cruisinginthewake.com/assets/compass_rose.svg?v=3.006.016">

  <!-- Swiper (primary + CDN fallback) -->
  <script>
  (function ensureSwiper(){
    function addCSS(h){ const l=document.createElement('link'); l.rel='stylesheet'; l.href=h; document.head.appendChild(l); }
    function addJS(src, ok, fail){
      const s=document.createElement('script'); s.src=src; s.async=true; s.onload=ok; s.onerror=fail||function(){}; document.head.appendChild(s);
    }
    const primaryCSS=_abs('/vendor/swiper/swiper-bundle.min.css?v=3.006.016');
    const primaryJS =_abs('/vendor/swiper/swiper-bundle.min.js?v=3.006.016');
    const cdnCSS    ="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css";
    const cdnJS     ="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js";
    addCSS(primaryCSS);
    addJS(primaryJS, function(){ window.__swiperReady=true; }, function(){ addCSS(cdnCSS); addJS(cdnJS, function(){ window.__swiperReady=true; }); });
  })();
  </script>

  <!-- Page micro CSS (scoped; aligns to standards) -->
  <style>
    .hidden{display:none!important}
    .pills,.class-pills,.related-pills,.button-group{display:flex;gap:.5rem;flex-wrap:wrap;justify-content:center;text-align:center}
    .pill{display:inline-block;padding:.35rem .7rem;border-radius:10px;border:1px dashed var(--rope,#d9b382);background:#fff;font-size:.9rem;color:var(--accent,#0e6e8e);text-decoration:none}
    .pill:hover{text-decoration:none;background:#f9fdfd}
    body::before{content:"";position:fixed;inset:0;background:url("https://www.cruisinginthewake.com/assets/watermark.png") center right/420px auto no-repeat;opacity:.06;pointer-events:none;z-index:0}
    body>*{position:relative;z-index:1}

    .wrap{max-width:1100px;margin:0 auto;padding:20px 14px 36px}
    .card{background:#fff;border:2px solid var(--rope,#d9b382);border-radius:14px;padding:1rem;margin:.8rem 0;box-shadow:0 2px 6px rgba(8,48,65,.08);position:relative;overflow:hidden}

    .grid-2{display:grid;gap:1rem;align-items:stretch}
    .grid-2>.card{display:flex;flex-direction:column}
    @media (min-width:980px){.grid-2{grid-template-columns:1fr 1fr}}

    /* First Look carousel */
    .swiper.firstlook{position:relative;overflow:hidden}
    .swiper.firstlook .swiper-wrapper{display:flex}
    .swiper.firstlook .swiper-slide{flex:0 0 100%}
    .swiper.firstlook img{display:block;width:100%;height:auto;border-radius:10px}
    .swiper.firstlook .swiper-button-prev,.swiper.firstlook .swiper-button-next{
      position:absolute;top:50%;transform:translateY(-50%);display:flex!important;opacity:1!important;visibility:visible!important;pointer-events:auto!important;z-index:7!important;width:44px;height:44px;align-items:center;justify-content:center;color:#0a3d62
    }
    .swiper.firstlook .swiper-button-prev{left:8px}
    .swiper.firstlook .swiper-button-next{right:8px}
    .swiper.firstlook .swiper-button-prev::after,.swiper.firstlook .swiper-button-next::after{
      font-size:18px;background:#fff;border-radius:999px;padding:10px;box-shadow:0 2px 8px rgba(0,0,0,.18)
    }
    .swiper.firstlook .swiper-pagination{z-index:7!important}
    .swiper.firstlook .swiper-pagination-bullet{background:#0a3d62;opacity:.45}
    .swiper.firstlook .swiper-pagination-bullet-active{opacity:1}

    /* Stats */
    .ship-stats.card.mini{margin-top:.6rem}
    .stats-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:.4rem .8rem;font-size:.95rem}
    .stat-line{display:flex;gap:.35rem;justify-content:space-between;border-bottom:1px dashed #e4e9ec;padding:.2rem 0}
    .stat-key{color:#355;font-weight:600}.stat-val{color:#024}

    /* Videos */
    .swiper{width:100%;max-width:820px;margin:0 auto}
    .swiper-slide iframe{width:100%;aspect-ratio:16/9;display:block;border:0;border-radius:12px}
    .swiper .swiper-button-prev,.swiper .swiper-button-next,.swiper .swiper-pagination{z-index:4}
  </style>
</head>

<body class="page no-hero-filter">
  <header class="hero-header">
    <div class="navbar">
      <div class="brand">
        <img src="https://www.cruisinginthewake.com/assets/logo_wake.png?v=3.006.016" alt="In the Wake wordmark"/>
        <span class="version-badge">v3.006.016</span>
      </div>
      <nav class="pills" aria-label="Primary">
        <a class="pill" href="https://www.cruisinginthewake.com/index.html">Home</a>
        <a class="pill" href="https://www.cruisinginthewake.com/ships/ships.html">Ships</a>
        <a class="pill" href="https://www.cruisinginthewake.com/restaurants.html">Restaurants &amp; Menus</a>
        <a class="pill" href="https://www.cruisinginthewake.com/ports.html">Ports</a>
        <a class="pill" href="https://www.cruisinginthewake.com/disability-at-sea.html">Disability at Sea</a>
        <a class="pill" href="https://www.cruisinginthewake.com/drink-packages.html">Drink Packages</a>
        <a class="pill" href="https://www.cruisinginthewake.com/packing-lists.html">Packing Lists</a>
        <a class="pill" href="https://www.cruisinginthewake.com/cruise-lines/royal-caribbean.html">Cruise Lines</a>
      </nav>
    </div>

    <div class="hero" role="img" aria-label="Grandeur of the Seas hero image">
      <div class="latlon-grid" aria-hidden="true">
        <svg viewBox="0 0 100 60" preserveAspectRatio="none">
          <g class="grid-lines" stroke-width="0.35">
            <line x1="10" y1="0" x2="10" y2="60"/><line x1="20" y1="0" x2="20" y2="60"/>
            <line x1="30" y1="0" x2="30" y2="60"/><line x1="40" y1="0" x2="40" y2="60"/>
            <line x1="50" y1="0" x2="50" y2="60"/><line x1="60" y1="0" x2="60" y2="60"/>
            <line x1="70" y1="0" x2="70" y2="60"/><line x1="80" y1="0" x2="80" y2="60"/>
            <line x1="90" y1="0" x2="90" y2="60"/>
            <line x1="0" y1="10" x2="100" y2="10"/><line x1="0" y1="20" x2="100" y2="20"/>
            <line x1="0" y1="30" x2="100" y2="30"/><line x1="0" y1="40" x2="100" y2="40"/>
          </g>
        </svg>
      </div>
      <img class="hero-compass" src="https://www.cruisinginthewake.com/assets/compass_rose.svg?v=3.006.016" alt="" aria-hidden="true"/>
      <div class="hero-title">
        <img class="logo" src="https://www.cruisinginthewake.com/assets/logo_wake.png?v=3.006.016" alt="In the Wake">
        <div class="tagline">A Cruise Traveler’s Logbook</div>
      </div>
      <div class="hero-credit">
        <a class="pill long" href="https://www.flickersofmajesty.com" target="_blank" rel="noopener">Photo © Flickers of Majesty — Instagram</a>
      </div>
    </div>
  </header>

  <main class="wrap" id="content" tabindex="-1">
    <!-- Row 1: First Look + Dining -->
    <section class="grid-2">
      <!-- First Look + Stats -->
      <section class="card" aria-labelledby="first-look">
        <h2 id="first-look">A First Look</h2>

        <!-- Your original three Flickers of Majesty photos -->
        <div class="swiper firstlook" aria-label="Grandeur of the Seas photo carousel">
          <div class="swiper-wrapper">
            <div class="swiper-slide">
              <figure>
                <img src="https://www.cruisinginthewake.com/assets/ships/grandeur-of-the-seas%20-%203.jpeg?v=3.006.016" alt="Grandeur — at Labadee Haiti in the rain" loading="lazy">
                <figcaption class="tiny">Photo © <a href="https://www.instagram.com/flickersofmajesty/" target="_blank" rel="noopener">Flickers of Majesty</a> — <a href="https://flickersofmajesty.com/" target="_blank" rel="noopener">flickersofmajesty.com</a></figcaption>
              </figure>
            </div>
            <div class="swiper-slide">
              <figure>
                <img src="https://www.cruisinginthewake.com/assets/ships/grandeur-of-the-seas%20-%201.jpeg?v=3.006.016" alt="Grandeur — through the trees" loading="lazy">
                <figcaption class="tiny">Photo © <a href="https://www.instagram.com/flickersofmajesty/" target="_blank" rel="noopener">Flickers of Majesty</a> — <a href="https://flickersofmajesty.com/" target="_blank" rel="noopener">flickersofmajesty.com</a></figcaption>
              </figure>
            </div>
            <div class="swiper-slide">
              <figure>
                <img src="https://www.cruisinginthewake.com/assets/ships/grandeur-of-the-seas%20-%202.jpeg?v=3.006.016" alt="Grandeur — in the fog" loading="lazy">
                <figcaption class="tiny">Photo © <a href="https://www.instagram.com/flickersofmajesty/" target="_blank" rel="noopener">Flickers of Majesty</a> — <a href="https://flickersofmajesty.com/" target="_blank" rel="noopener">flickersofmajesty.com</a></figcaption>
              </figure>
            </div>
          </div>
          <div class="swiper-pagination" aria-hidden="true"></div>
          <div class="swiper-button-prev" aria-label="Previous image"></div>
          <div class="swiper-button-next" aria-label="Next image"></div>
        </div>

        <!-- Stats -->
        <section class="ship-stats card mini" aria-labelledby="statsHeading">
          <h3 id="statsHeading">Grandeur at a Glance</h3>
          <div id="ship-stats" class="stats-grid" data-slug="grandeur-of-the-seas"></div>
          <script type="application/json" id="ship-stats-fallback">
          {
            "slug": "grandeur-of-the-seas",
            "name": "Grandeur of the Seas",
            "class": "Vision Class",
            "entered_service": 1996,
            "gt": "73,817 GT",
            "guests": "1,992 (double) ~2,400 (max)",
            "crew": "760",
            "length": "916 ft (279 m)",
            "beam": "106 ft (32 m)",
            "registry": "Bahamas"
          }
          </script>
        </section>
      </section>

      <!-- Dining -->
      <section id="dining-card" class="card" data-ship="Grandeur of the Seas" aria-labelledby="diningHeading">
        <h2 id="diningHeading">Dining Venues on Grandeur of the Seas</h2>

        <img id="dining-hero" class="card-hero"
             src="/ships/assets/img/Cordelia_Empress_Food_Court.jpg?v=3.006.016"
             alt="Grandeur dining venue seating with ocean view" loading="lazy"
             onerror="(function(img){var fb=[_abs('/ships/assets/grandeur-of-the-seas1.jpg?v=3.006.016')];img._fbi=(img._fbi||0);if(img._fbi<fb.length){img.src=fb[img._fbi++];}})(this)"/>

        <div class="dining-content" id="dining-content" aria-live="polite"></div>

        <script type="application/json" id="dining-data-source">{
          "provider":"rcl",
          "json":"/assets/data/venues.json",
          "ship_slug":"grandeur-of-the-seas",
          "aliases":["Grandeur of the Seas","Grandeur"]
        }</script>
      </section>
    </section>

    <!-- LOGBOOK -->
    <section class="card note-kens-logbook" aria-labelledby="logbook">
      <h2 id="logbook">The Logbook — Tales From the Wake</h2>

      <!-- Fallback: your review (shown unless JSON is present) -->
      <article class="story" id="logbook-fallback">
        <h3 tabindex="0">Ken’s Logbook — Grandeur of the Seas</h3>
        <div class="story-body">
          <p>We sailed <em>Grandeur of the Seas</em> in an ocean-view stateroom—bright - with views of epic sunrises; a great way to start each morning. Dining was a highlight: <strong>Chops Grille</strong> delivered a fantastic filet, and the <strong>Main Dining Room</strong> impressed with thoughtful pacing and spot-on recommendations. Service all around was warm and proactive: Miguel (Philippines) at Chops provided truly excellent, personable care; at Guest Services, Vincent D’Cruz resolved our requests quickly and professionally; and in <strong>Windjammer</strong>, Vergel noticed a morning pattern and brought fresh eggs to our table before we asked—a small kindness that says a lot about this crew.</p>
          <p>We tried <strong>Taste of Royal</strong>: the tuna tartare was tasty; shrimp could have used a touch more heat; the fried cheesecake stole the show. (Pro tip: the Saint Peter’s spritzer really pops if you squeeze the orange wedge.) Our Eastern Caribbean itinerary hit Aruba, Curaçao, and Bonaire. We snorkeled in Aruba (hello, flamingos), toured the Curaçao distillery and a sun-warmed cave, and in Bonaire took a quick taxi to <a href="https://buddydive.com/" target="_blank" rel="noopener">Buddy Dive Center</a>—great value rentals (as of Nov 2024), clear water, and a drop-off reef that rewards confident snorkelers and divers. Labadee beach time was still fun despite weather nixing our planned dive excursion. So we took in the Local Artists - who can be VERY assertive; a firm “no, thanks” works in at least three languages.</p>
          <p>Embark and debark in Fort Lauderdale were smooth, though port driving/parking can be confusing and pricey—off-port parking plus a taxi often beats the on-site rates. In the evenings, we caught <em>Broadway Rhythm &amp; Rhyme</em> and <em>Tango Buenos Aires</em>—the latter stood out with world-class dancing and vocals. Bottom line: <em>Grandeur</em> delivers that extra dose of personal connection big ships can’t replicate, backed by classic Royal fun and friendly, attentive service.</p>
        </div>
      </article>

      <div id="logbook-stories" class="prose"></div>
    </section>

    <!-- Videos -->
    <section class="card" aria-labelledby="video-highlights">
      <h2 id="video-highlights">Watch: Grandeur Highlights</h2>
      <p class="small">Swipe through ship walkthroughs, top-10s, and stateroom tours (including accessible where available).</p>
      <div class="swiper videos" aria-label="Featured video carousel">
        <div class="swiper-wrapper" id="featuredVideos"></div>
        <div class="swiper-pagination" aria-hidden="true"></div>
        <div class="swiper-button-prev" aria-label="Previous slide"></div>
        <div class="swiper-button-next" aria-label="Next slide"></div>
      </div>
      <div id="videoFallback" class="tiny hidden">Videos will appear once our sources sync for this ship.</div>
    </section>

    <!-- Row: Deck Plans + Live Tracker -->
    <section class="grid-2">
      <section class="card" aria-labelledby="deck-plans">
        <h2 id="deck-plans">Ship Map (Deck Plans)</h2>
        <p><a class="pill" href="https://www.royalcaribbean.com/cruise-ships/grandeur-of-the-seas/deck-plans" target="_blank" rel="noopener">Open Official Deck Plans →</a></p>
        <figure>
          <img src="https://www.cruisinginthewake.com/assets/ship-map.png?v=3.006.016" alt="Grandeur of the Seas simplified deck plan preview" loading="lazy"/>
        </figure>
      </section>

      <!-- Live tracker (robust fallback chain + auto-refresh) -->
      <section class="card itinerary" aria-labelledby="liveTrackHeading"
               data-imo="9115627" data-name="GRANDEUR-OF-THE-SEAS" data-cm="598">
        <h2 id="liveTrackHeading">Where Is Grandeur Right Now?</h2>
        <p>See the ship’s current position, speed, and next port on a live tracker.</p>
        <div id="vf-map" style="width:100%;height:300px;background:var(--sky)"></div>
        <iframe id="vf-iframe" title="Live ship tracker for Grandeur of the Seas"
                width="100%" height="300" frameborder="0" loading="lazy"
                referrerpolicy="no-referrer" allowfullscreen
                style="border-radius:12px;background:var(--sky);display:none"></iframe>
        <p class="tiny">Tip: The map refreshes automatically while this tab is open.</p>
      </section>
    </section>

    <!-- Related -->
    <section class="related-row">
      <section class="card carousel related-ships" aria-labelledby="related-ships">
        <h2 id="related-ships" class="card-title">Vision Class — Sister Ships</h2>
        <div class="related-pills" aria-label="Vision-class ships">
          <a class="pill" href="https://www.cruisinginthewake.com/ships/rcl/vision-of-the-seas.html">Vision of the Seas</a>
          <a class="pill" href="https://www.cruisinginthewake.com/ships/rcl/rhapsody-of-the-seas.html">Rhapsody of the Seas</a>
          <a class="pill" href="https://www.cruisinginthewake.com/ships/rcl/enchantment-of-the-seas.html">Enchantment of the Seas</a>
        </div>
        <p style="text-align:center"><a href="https://www.cruisinginthewake.com/ships/ships.html" class="pill">See All Ships</a></p>
      </section>

      <section class="card carousel related-classes" aria-labelledby="related-classes">
        <h2 id="related-classes" class="card-title">Explore Royal Caribbean Classes</h2>
        <p class="small">Hop between ship classes to compare size, venues, and vibes.</p>
        <div class="class-pills">
          <a class="pill" href="https://www.cruisinginthewake.com/cruise-lines/royal-caribbean.html#vision">Vision Class</a>
          <a class="pill" href="https://www.cruisinginthewake.com/cruise-lines/royal-caribbean.html#radiance">Radiance Class</a>
          <a class="pill" href="https://www.cruisinginthewake.com/cruise-lines/royal-caribbean.html#voyager">Voyager Class</a>
          <a class="pill" href="https://www.cruisinginthewake.com/cruise-lines/royal-caribbean.html#freedom">Freedom Class</a>
          <a class="pill" href="https://www.cruisinginthewake.com/cruise-lines/royal-caribbean.html#quantum">Quantum Class</a>
          <a class="pill" href="https://www.cruisinginthewake.com/cruise-lines/royal-caribbean.html#oasis">Oasis Class</a>
          <a class="pill" href="https://www.cruisinginthewake.com/cruise-lines/royal-caribbean.html#icon">Icon Class</a>
        </div>
        <p style="text-align:center"><a href="https://www.cruisinginthewake.com/ships/ships.html" class="pill">Browse All Ships</a></p>
      </section>
    </section>

    <!-- Attribution -->
    <section class="card attributions">
      <h2>Image Attributions</h2>
      <ul>
        <li>Grandeur of the Seas photography © <a href="https://www.flickersofmajesty.com" target="_blank" rel="noopener">Flickers of Majesty</a> — <a href="https://instagram.com/flickersofmajesty" target="_blank" rel="noopener">Instagram</a>. All rights reserved.</li>
        <li>Additional imagery via Wikimedia Commons where noted; see individual file pages for licenses.</li>
      </ul>
    </section>
  </main>

  <footer class="wrap">© <span id="yr"></span> In the Wake — A Cruise Traveler’s Logbook</footer>
  <script>document.getElementById('yr').textContent=new Date().getFullYear();</script>

  <!-- ===== First Look init ===== -->
  <script>
  (function initFirstLook(){
    function go(){
      if(!window.__swiperReady||!window.Swiper) return setTimeout(go,120);
      try{
        new Swiper('.swiper.firstlook',{
          loop:false,lazy:true,watchOverflow:true,
          pagination:{el:'.swiper.firstlook .swiper-pagination',clickable:true},
          navigation:{nextEl:'.swiper.firstlook .swiper-button-next',prevEl:'.swiper.firstlook .swiper-button-prev'},
          a11y:{enabled:true}
        });
      }catch(_){}
    }
    go();
  })();
  </script>

  <!-- ===== Logbook loader with 60% Fuel block insertion ===== -->
  <script>
  (function initShipLogbook(){
    const mount=document.getElementById('logbook-stories'); if(!mount) return;
    const fallbackEl=document.getElementById('logbook-fallback');
    const slug='grandeur-of-the-seas', line='rcl';
    function abs(p){return (window._abs?_abs(p):p);}
    function clamp(n,a,b){return Math.max(a,Math.min(b,n));}

    // >>> Replace the inner HTML below with your canonical "Fuel Your Voyage" copy if it differs
    const FUEL_HTML = `
      <article class="story fuel-upsell" aria-live="polite">
        <h3 tabindex="0">Fuel Your Voyage</h3>
        <div class="story-body">
          <p class="small">Quick hops to the most-used tools and guides while you plan:</p>
          <div class="pills" role="group" aria-label="Planning shortcuts">
            <a class="pill" href="https://www.cruisinginthewake.com/restaurants.html">Restaurants &amp; Menus</a>
            <a class="pill" href="https://www.cruisinginthewake.com/ports.html">Ports</a>
            <a class="pill" href="https://www.cruisinginthewake.com/drink-packages.html">Drink Packages</a>
            <a class="pill" href="https://www.cruisinginthewake.com/packing-lists.html">Packing Lists</a>
            <a class="pill" href="https://www.cruisinginthewake.com/disability-at-sea.html">Disability at Sea</a>
            <a class="pill" href="https://www.cruisinginthewake.com/solo.html">Solo</a>
            <a class="pill" href="https://www.cruisinginthewake.com/travel.html">Travel</a>
          </div>
        </div>
      </article>`;

    const SOURCES=[
      abs('/ships/'+line+'/assets/'+slug+'.json?v=3.006.016'),
      abs('/assets/data/logbook/'+line+'/'+slug+'.json?v=3.006.016'),
      abs('/assets/data/ships/'+line+'/'+slug+'.json?v=3.006.016')
    ];
    function fetchFirst(i){i=i||0; if(i>=SOURCES.length) return Promise.resolve(null);
      return fetch(SOURCES[i],{cache:'no-store'}).then(r=>r.ok?r.json():fetchFirst(i+1)).catch(()=>fetchFirst(i+1));}

    function mdToHtml(src){
      let html=String(src||'').trim(); if(!html) return '';
      html=html.replace(/^###?\s+(.+)$/gm,'<h3>$1</h3>')
               .replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>')
               .replace(/\*(.+?)\*/g,'<em>$1</em>');
      html='<p>'+html.replace(/\n{2,}/g,'</p><p>').replace(/\n/g,'<br/>')+'</p>';
      return html.replace(/^<p>\s*<\/p>/,'');
    }

    const state={i:0,items:[]};
    function renderOne(p){
      if(p && p.__fuel) return FUEL_HTML;
      const title=String(p.title||p.persona_label||p.heading||'Guest Perspective').replace(/</g,'&lt;');
      const body=String(p.markdown||p.body||p.content||p.html||p.text||p.story||p.notes||'').trim();
      if(!body) return '';
      return '<article class="story" aria-live="polite"><h3 tabindex="0">'+title+'</h3><div class="story-body">'+mdToHtml(body)+'</div></article>';
    }

    function ensureNav(){
      if(document.getElementById('logbook-nav')) return;
      const nav=document.createElement('div'); nav.id='logbook-nav'; nav.className='button-group'; nav.setAttribute('role','group'); nav.setAttribute('aria-label','Logbook navigation');
      const prev=document.createElement('button'); prev.type='button'; prev.className='pill'; prev.id='logbook-prev'; prev.textContent='◀ Port'; prev.onclick=()=>go(state.i-1,true);
      const pos=document.createElement('span'); pos.id='logbook-pos'; pos.className='tiny'; pos.style.minWidth='8ch'; pos.style.textAlign='center';
      const next=document.createElement('button'); next.type='button'; next.className='pill'; next.id='logbook-next'; next.textContent='Starboard ▶'; next.onclick=()=>go(state.i+1,true);
      nav.append(prev,pos,next); mount.parentNode.insertBefore(nav,mount);
      window.addEventListener('keydown',e=>{ if(!state.items.length) return; if(e.key==='ArrowLeft') go(state.i-1,true); if(e.key==='ArrowRight') go(state.i+1,true);});
    }
    function updatePos(){
      const pos=document.getElementById('logbook-pos'); if(!pos) return;
      const total=state.items.length||0; pos.textContent=total?((state.i+1)+' / '+total):'';
      const prev=document.getElementById('logbook-prev'); const next=document.getElementById('logbook-next');
      if(prev) prev.disabled=(state.i<=0); if(next) next.disabled=(state.i>=total-1);
    }
    function go(idx,focusHeading){
      if(!state.items.length) return;
      state.i=clamp(idx,0,state.items.length-1);
      mount.innerHTML=renderOne(state.items[state.i])||'<article class="story"><p class="small">Story unavailable.</p></article>';
      updatePos();
      if(focusHeading){const h=mount.querySelector('h3'); if(h) h.focus();}
      const base=location.href.split('#')[0]; history.replaceState(null,'',base+'#logbook-'+(state.i+1));
    }
    function normalizePayload(data){
      if(!data) return [];
      if(Array.isArray(data)) return data;
      if(Array.isArray(data.personas)) return data.personas;
      if(Array.isArray(data.stories)) return data.stories;
      if(data[slug]){const d=data[slug]; if(Array.isArray(d.personas)) return d.personas; if(Array.isArray(d.stories)) return d.stories;}
      if(data.logbook){ const b=data.logbook; if(Array.isArray(b.personas)) return b.personas; if(Array.isArray(b.stories)) return b.stories; }
      if(data.ships&&data.ships[slug]){const s=data.ships[slug]; if(Array.isArray(s.personas)) return s.personas; if(Array.isArray(s.stories)) return s.stories;}
      let merged=[]; Object.keys(data||{}).forEach(k=>{const v=data[k]; if(Array.isArray(v)) merged=merged.concat(v)});
      return merged;
    }

    fetchFirst().then(data=>{
      let items=normalizePayload(data).map(p=>({
        title:(p.title||p.persona_label||p.heading||p.name||'Guest Perspective'),
        markdown:(p.markdown||p.body||p.content||p.html||p.text||p.story||p.notes||'')
      })).filter(p=>String(p.markdown||'').trim().length);

      if(!items.length){ 
        // Keep your fallback visible; also append Fuel block after it
        mount.innerHTML = FUEL_HTML;
        return;
      }

      // Insert Fuel block at the 60% mark (rounded down)
      const insertAt = Math.max(0, Math.floor(items.length * 0.6));
      items.splice(insertAt, 0, {__fuel:true});

      // Hide fallback, render carousel
      if(fallbackEl) fallbackEl.remove();
      state.items=items; ensureNav(); go(0,false);
    }).catch(()=>{
      // Keep fallback; still show Fuel block beneath it
      mount.innerHTML = FUEL_HTML;
    });
  })();
  </script>

  <!-- ===== Dining loader (venues.json same origin) ===== -->
  <script>
  (function(){
    const DATA_PATH='/assets/data/venues.json';
    const DATA_URL=(typeof _abs==='function')?_abs(DATA_PATH):DATA_PATH;
    let _cache=null,_pending=null,_venuesIndex=null,_ships=null;

    function load(){
      if(_cache) return Promise.resolve(_cache);
      if(_pending) return _pending;
      _pending=fetch(DATA_URL,{credentials:'omit',referrerPolicy:'no-referrer'}).then(r=>r.json()).then(json=>{
        if(!json||!Array.isArray(json.venues)||!json.ships) throw new Error('Invalid venues.json shape');
        _venuesIndex=Object.fromEntries(json.venues.map(v=>[v.slug,v]));
        _ships=json.ships; _cache=json; return json;
      }).finally(()=>{_pending=null;});
      return _pending;
    }
    async function getShipVenues(shipSlug){
      const data=await load(); const ship=_ships[shipSlug];
      if(!ship) return {meta:data.meta||{},ship:null,venues:[]};
      const venues=(ship.venues||[]).map(slug=>{
        const v=_venuesIndex[slug];
        return v?Object.assign({slug},v):{slug,name:slug,category:'unknown'};
      });
      return {meta:data.meta||{},ship,venues};
    }
    window.getShipVenues=getShipVenues;
  })();
  </script>

  <!-- ===== Dining card render ===== -->
  <script>
  (async function renderDining(){
    const host=document.getElementById('dining-content');
    const cfgEl=document.getElementById('dining-data-source');
    if(!host||!cfgEl) return;
    let cfg={}; try{ cfg=JSON.parse(cfgEl.textContent||'{}'); }catch(_){}
    const shipSlug=(cfg.ship_slug||'grandeur-of-the-seas').toLowerCase();
    try{
      const data=await (window.getShipVenues?getShipVenues(shipSlug):Promise.resolve({ship:null,venues:[]}));
      const list=(data.venues||[]);
      if(!list.length){ host.innerHTML='<p class="tiny">Dining details coming soon.</p>'; return; }
      host.innerHTML=list.map(v=>{
        const type=(v.type||v.category||'included').toLowerCase();
        const label=type==='premium'?'Premium':'Included';
        const dress=(v.slug==='chefs-table')?'Formal encouraged':'Smart casual by default';
        const url=(v.href||('/restaurants/'+(v.slug||'')+'.html'));
        return `
          <article class="card" style="margin:.5rem 0;padding:.75rem">
            <h3 style="margin:.25rem 0">${v.name||v.slug}</h3>
            <div class="tiny">${label} · ${dress}</div>
            ${v.blurb?`<p class="tiny">${v.blurb}</p>`:''}
            <p><a class="pill" href="${_abs(url)}">Open venue page →</a></p>
          </article>`;
      }).join('');
    }catch(e){
      host.innerHTML='<p class="tiny">Could not load dining data.</p>';
    }
  })();
  </script>

  <!-- ===== Videos ===== -->
  <script>
  (function initGrandeurVideos(){
    const sec=document.querySelector('[aria-labelledby="video-highlights"]'); if(!sec) return;
    const slug='grandeur-of-the-seas';
    const WRAP=document.getElementById('featuredVideos'); if(!WRAP) return;
    const CONTAINER=sec.querySelector('.swiper.videos');
    const fallback=document.getElementById('videoFallback');
    const SOURCES=[_abs('/ships/rcl/assets/videos/grandeur.json?v=3.006.016'),_abs('/videos/grandeur.json?v=3.006.016')];

    function fetchFirst(i){i=i||0; if(i>=SOURCES.length) return Promise.resolve(null);
      return fetch(SOURCES[i],{cache:'no-store'}).then(r=>r.ok?r.json():fetchFirst(i+1)).catch(()=>fetchFirst(i+1));}

    const STATIC = [
      {"id":"-NS3BhWqzD4","title":"Grandeur of the Seas — Full Ship Walkthrough (4K)"},
      {"id":"iIo4HNqNzbs","title":"Top Things To Do on Grandeur of the Seas"},
      {"id":"tXQ8hic0O_U","title":"Grandeur — Accessible Stateroom & Wheelchair Walkthrough"},
      {"id":"kYAwcRPmH5c","title":"Interior Room Tour — Grandeur"},
      {"id":"1PgDMCgw6uI","title":"Ocean View Stateroom Tour — Grandeur"},
      {"id":"0YONwODd98c","title":"Balcony & Interior Quick Tour — Grandeur"}
    ];

    function ytId(v){
      if(v&&typeof v==='object'){ if(v.video_id) return String(v.video_id); if(v.youtube_id) return String(v.youtube_id); if(v.id&&/^[A-Za-z0-9_-]{6,}$/.test(v.id)) return String(v.id); }
      const u=String((v&&(v.video_url||v.url||v.embed_url))||'');
      const m=u.match(/(?:\?|&)v=([A-Za-z0-9_-]{6,})/)||u.match(/youtu\.be\/([A-Za-z0-9_-]{6,})/)||u.match(/\/embed\/([A-Za-z0-9_-]{6,})/);
      return m?m[1]:'';
    }

    function buildSlides(items){
      const seen=Object.create(null), slides=[];
      items.forEach(v=>{const id=ytId(v)||v.id; if(!id||seen[id]) return; seen[id]=1;
        const title=String(v.title||'Ship video').replace(/"/g,'&quot;');
        slides.push('<div class="swiper-slide"><iframe title="'+title+'" src="https://www.youtube-nocookie.com/embed/'+id+'" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading="lazy"></iframe></div>');
      });
      return slides;
    }

    function whenSwiperReady(cb){(function poll(){ if(window.__swiperReady&&window.Swiper) cb(); else setTimeout(poll,80); })();}

    fetchFirst().then(json=>{
      let slides=[];
      if(json && (Array.isArray(json)?json:(json.videos||json[slug]))) {
        const arr = Array.isArray(json)?json:(json.videos||json[slug]||[]);
        slides = buildSlides(arr);
      }
      if(!slides.length){ slides = buildSlides(STATIC); }
      if(!slides.length){ if(fallback) fallback.classList.remove('hidden'); CONTAINER.classList.add('carousel-fallback'); return; }
      WRAP.innerHTML=slides.join('');
      whenSwiperReady(function(){ try{
        new Swiper('.swiper.videos',{loop:false,lazy:true,watchOverflow:true,
          pagination:{el:'.swiper.videos .swiper-pagination',clickable:true},
          navigation:{nextEl:'.swiper.videos .swiper-button-next',prevEl:'.swiper.videos .swiper-button-prev'},
          a11y:{enabled:true}
        });
      }catch(_){ CONTAINER.classList.add('carousel-fallback'); }});
    });
  })();
  </script>

  <!-- ===== Ship stats loader ===== -->
  <script>
  (async function loadShipStats(){
    const el=document.getElementById('ship-stats'); if(!el) return;
    const SOURCES=[
      _abs('/ships/assets/data/fleet/fleet_index.json?v=3.006.016'),
      _abs('/assets/data/fleet_index.json?v=3.006.016')
    ];
    async function tryFetch(u){ try{const r=await fetch(u,{cache:'no-store'}); if(r.ok) return await r.json();}catch(_){} return null; }
    let data=null; for(const u of SOURCES){ data=await tryFetch(u); if(data) break; }
    if(!data){
      try{const fb=JSON.parse(document.getElementById('ship-stats-fallback').textContent||'{}'); data={ships:[fb]};}
      catch(_){}
    }
    if(!data){ el.innerHTML='<p class="tiny">Stats coming soon.</p>'; return; }

    function norm(s){ return String(s||'').toLowerCase().replace(/’/g,"'").trim(); }
    function* walk(n){ if(!n) return; if(Array.isArray(n)){ for(const it of n) yield* walk(it); return; } if(typeof n==='object'){ yield n; for(const v of Object.values(n)) yield* walk(v); } }
    const targetSlug=norm(el.getAttribute('data-slug')||''); let ship=null;
    for(const obj of walk(data)){
      const rawSlug=obj&&(obj.slug||obj.id||(obj.attributes&&obj.attributes.slug));
      const nslug=norm(rawSlug);
      const nname=norm((obj&&(obj.name||obj.title||obj.ship))||(obj&&obj.attributes&&obj.attributes.name));
      if((targetSlug&&nslug===targetSlug)||nname==='grandeur of the seas'){ ship=obj; break; }
    }
    if(!ship){ el.innerHTML='<p class="tiny">Stats coming soon.</p>'; return; }
    const a=ship.attributes||ship;
    const rows=[
      ['Class',a.class||a.ship_class||((a.notes&&/vision/i.test(a.notes))?'Vision Class':'')],
      ['Entered Service',a.year_built_or_entered||a.entered_service||a.inaugural||a.launched],
      ['Gross Tonnage',a.gt||a.gross_tonnage||a.tonnage],
      ['Guests',a.capacity||a.passengers||a.guests],
      ['Crew',a.crew],
      ['Length',a.length||a.length_overall],
      ['Beam',a.beam||a.width],
      ['Registry',a.flag||a.registry]
    ].filter(p=>p[1]!=null && String(p[1]).trim()!=='')
     .map(p=>'<div class="stat-line"><span class="stat-key">'+p[0]+':</span><span class="stat-val">'+p[1]+'</span></div>').join('');
    el.innerHTML=rows||'<p class="tiny">Stats coming soon.</p>';
  })();
  </script>

  <!-- ===== Live tracker (AISMap + multi-iframe fallbacks + auto-refresh) ===== -->
  <script>
  (function initLiveTracker(){
    const card = document.querySelector('.card.itinerary'); if(!card) return;
    const name = (card.dataset.name||'').trim();
    const imo  = (card.dataset.imo||'').trim();
    const cmId = (card.dataset.cm||'').trim(); // CruiseMapper numeric id (598)
    const mapEl = document.getElementById('vf-map');
    const fr    = document.getElementById('vf-iframe');
    const STEP  = 15*60*1000; // refresh every 15 minutes

    function stamp(){ return Math.floor(Date.now()/STEP); }
    function q(u){ return u + (u.includes('?')?'&':'?') + 'ts=' + stamp(); }

    // Try VF widget first
    function tryWidget(){
      return new Promise(resolve=>{
        const s=document.createElement('script');
        s.src=q("https://www.vesselfinder.com/aismap.js");
        s.async=true;
        let done=false;
        s.onload=function(){ 
          try{
            if(window.AISMap && mapEl){
              new AISMap(mapEl,{width:"100%",height:300,zoom:8,names:true,show_track:1,track_days:1,vessel:"IMO:"+imo});
              done=true; resolve(true);
              // health check: if no canvas, fallback
              setTimeout(()=>{ if(!mapEl.querySelector('canvas,svg')) resolve(false); }, 2000);
            } else { resolve(false); }
          }catch(_){ resolve(false); }
        };
        s.onerror=function(){ resolve(false); };
        document.head.appendChild(s);
        // guard timeout
        setTimeout(()=>{ if(!done) resolve(false); }, 4500);
      });
    }

    // If widget fails, rotate through likely working iframes
    const iframeCandidates = [
      // VF vessel details by IMO (no name dependency)
      () => q("https://www.vesselfinder.com/vessels/details/imo/"+encodeURIComponent(imo))+"#map",
      // VF with plain query
      () => q("https://www.vesselfinder.com/")+"?imo="+encodeURIComponent(imo)+"#map",
      // CruiseMapper fallback (known-good)
      () => q("https://www.cruisemapper.com/ships/Grandeur-Of-The-Seas-"+(cmId||"598"))
    ];

    function showIframe(){
      for(const make of iframeCandidates){
        const url = make();
        fr.style.display='block';
        fr.src = url;
        // break after first; if site blocks, user still gets a page (404s here are rare with these URLs)
        break;
      }
      // auto-refresh when visible
      function refresh(){ if(document.hidden) return; fr.src = iframeCandidates[0](); }
      setInterval(refresh, STEP);
      document.addEventListener('visibilitychange', ()=>{ if(!document.hidden) refresh(); });
    }

    // Kick off
    tryWidget().then(ok=>{
      if(!ok) showIframe();
      else{
        // widget present: refresh by re-creating widget on interval (cheap but reliable)
        setInterval(()=>{
          if(document.hidden) return;
          mapEl.innerHTML='';
          try{ new AISMap(mapEl,{width:"100%",height:300,zoom:8,names:true,show_track:1,track_days:1,vessel:"IMO:"+imo}); }catch(_){}
        }, STEP);
        document.addEventListener('visibilitychange', ()=>{
          if(!document.hidden){
            mapEl.innerHTML='';
            try{ new AISMap(mapEl,{width:"100%",height:300,zoom:8,names:true,show_track:1,track_days:1,vessel:"IMO:"+imo}); }catch(_){}
          }
        });
      }
    });
  })();
  </script>
</body>
</html>
