<!doctype html>
<html lang="en" class="no-js">
<head>
  <!-- ======================================================
       In the Wake ‚Äî Royal Caribbean Drink Calculator
       Version: 3.010.300  |  Soli Deo Gloria ‚úùÔ∏è
       "I was eyes to the blind and feet to the lame" - Job 29:15
       "Whatever you do, work heartily, as for the Lord" - Colossians 3:23

       ACCESSIBILITY COMMITMENT:
       This calculator serves ALL travelers - regardless of ability,
       age, or circumstance. Every feature is keyboard accessible,
       screen reader compatible, and designed with care.

       AI-First SEO with E-E-A-T Person Schema

       CHANGELOG v3.010.300 (formerly v1.003.000):
       - CRITICAL FIX: Minors forced to Refreshment when adults buy Deluxe
       - CRITICAL FIX: Clarified "per adult" in daily drinks section
       - CRITICAL FIX: Updated policy warning (absolute NO EXCEPTIONS)
       - FIX: Pinnacle vouchers corrected (6/day not 5)
       - FEATURE: Clickable package selection cards
       - FEATURE: Pre-cruise vs onboard pricing toggle
       - FEATURE: Recovery-sensitive view (hide alcohol option)
       ====================================================== -->
  
  <!-- Core -->
  <meta charset="utf-8"/>
  <script>
    document.documentElement.classList.remove(\'no-js\');
  </script>

  <!-- ‚úÖ PHASE 2: Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; connect-src 'self' https://api.frankfurter.app; worker-src 'self';">
  
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="referrer" content="no-referrer-when-downgrade"/>
  <meta name="ai-summary" content="Compare Soda, Refreshment, Deluxe, and Coffee Card vs √†-la-carte with live break-even chart. Free Royal Caribbean drink calculator with Crown & Anchor support.">
  <meta name="last-reviewed" content="2025-11-19">
  <meta name="content-protocol" content="ICP-Lite v1.0">
  <meta name="robots" content="index,follow,max-image-preview:large"/>
  <meta name="color-scheme" content="light"/>
  <meta name="theme-color" content="#0e6e8e"/>
  <meta name="version" content="3.010.300"/>
  <meta name="author" content="In the Wake"/>
  
  <!-- Title & SEO -->
  <title>Royal Caribbean Drink Package Calculator 2025 | Is It Worth It?</title>
  <meta name="description" content="Compare Soda, Refreshment, Deluxe, and Coffee Card vs √†-la-carte with live break-even chart. Free Royal Caribbean drink calculator with Crown & Anchor support."/>
  <link rel="canonical" href="https://cruisinginthewake.com/drink-calculator.html"/>
  
  <!-- OpenGraph / Twitter -->
  <meta property="og:type" content="website"/>
  <meta property="og:site_name" content="In the Wake"/>
  <meta property="og:title" content="Royal Caribbean Drink Package Calculator 2025"/>
  <meta property="og:description" content="Break-even chart + sea/port day weighting. Find out if a package saves money."/>
  <meta property="og:url" content="https://cruisinginthewake.com/drink-calculator.html"/>
  <meta property="og:image" content="https://cruisinginthewake.com/assets/social/drink-calculator-2025.jpg"/>
  <meta name="twitter:card" content="summary_large_image"/>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WZP891PZXJ"></script>
  <script>
    window.dataLayer=window.dataLayer||[];
    function gtag(){dataLayer.push(arguments);}
    gtag('js',new Date());
    gtag('config','G-WZP891PZXJ',{anonymize_ip:true});
  </script>

  <!-- Umami (secondary analytics) -->
  <script defer src="https://cloud.umami.is/script.js" data-website-id="9661a449-3ba9-49ea-88e8-4493363578d2"></script>

  <!-- Breadcrumb JSON-LD -->
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[
    {"@type":"ListItem","position":1,"name":"Home","item":"https://cruisinginthewake.com/"},
    {"@type":"ListItem","position":2,"name":"Drink Calculator","item":"https://cruisinginthewake.com/drink-calculator.html"}
  ]}
  </script>

  <!-- JSON-LD: Person (E-E-A-T) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "Ken Baker",
    "url": "https://cruisinginthewake.com/authors/ken-baker.html",
    "jobTitle": "Founder and Editor",
    "description": "Traveler, pastor, and storyteller. Founder of In the Wake, a cruise traveler's logbook offering planning tools, travel tips, and faith-scented reflections for smoother sailings.",
    "image": "https://cruisinginthewake.com/authors/img/ken1.webp",
    "sameAs": [
      "https://www.flickersofmajesty.com"
    ],
    "worksFor": {
      "@type": "Organization",
      "name": "In the Wake"
    },
    "knowsAbout": [
      "Cruise Planning",
      "Royal Caribbean",
      "Cruise Ship Beverage Packages",
      "Travel Budgeting",
      "Travel Writing"
    ]
  }
  </script>

  <!-- JSON-LD: FAQPage (Rich Snippet Eligibility) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What's included in the Royal Caribbean Deluxe Beverage Package?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The Deluxe Beverage Package includes cocktails, wine by the glass, beer, spirits, soda, specialty coffee, tea, fresh juice, mocktails, energy drinks, milkshakes, and bottled water. Drinks up to $14.00 per serving (before 18% gratuity) are included. Excludes bottles of wine, souvenir cups, and specialty shots over the cap."
        }
      },
      {
        "@type": "Question",
        "name": "When does a Royal Caribbean drink package break even?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "For the Deluxe Beverage Package at approximately $89/day (pre-cruise pricing), you break even at 6-7 drinks per day when factoring in the 18% automatic gratuity. The exact break-even point depends on your drink preferences (cocktails vs beer vs specialty coffee), whether you have Crown & Anchor vouchers, and whether you buy pre-cruise vs onboard. Use the calculator to find your personalized break-even number."
        }
      },
      {
        "@type": "Question",
        "name": "What are Crown & Anchor drink vouchers?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Crown & Anchor drink vouchers are loyalty benefits for Diamond-level members and higher. Diamond members (80-174 cruise nights) receive 4 vouchers per day, Diamond Plus (175-699 nights) receive 5 per day, and Pinnacle (700+ nights) receive 6 per day. Each voucher equals one FREE drink valued at $14.00, loaded automatically onto your SeaPass card. These vouchers can significantly reduce the value of purchasing a drink package."
        }
      },
      {
        "@type": "Question",
        "name": "Do I have to buy a drink package for everyone in my stateroom?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, Royal Caribbean requires ALL adults (21+) in the same stateroom to purchase the same adult beverage package. There are absolutely NO EXCEPTIONS - not for pregnancy, medical conditions, religious reasons, or designated drivers. If adults purchase the Deluxe package, all minors in the stateroom must purchase the Refreshment Package. This is a strict policy to prevent package sharing."
        }
      },
      {
        "@type": "Question",
        "name": "Should I buy the drink package pre-cruise or onboard?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Always buy drink packages pre-cruise for the best price. Pre-cruise pricing is typically 20-30% cheaper than onboard pricing. Packages purchased before the cruise also give you more time to review your decision and potentially catch sales. You can usually cancel or modify your package up until a few days before sailing."
        }
      },
      {
        "@type": "Question",
        "name": "What is the $14 drink cap on the Deluxe package?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "The Deluxe Beverage Package covers drinks up to $14.00 per serving before the 18% gratuity. If you order a drink that costs more than $14 (like premium whiskey or champagne), you pay the difference between $14 and the actual price, plus gratuity on the difference. Most standard cocktails, beers, wines by the glass, and specialty coffees fall under the $14 cap."
        }
      },
      {
        "@type": "Question",
        "name": "Can I use the calculator for non-alcoholic drinks only?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes! The calculator includes a 'Recovery-Sensitive View' toggle that hides all alcoholic options and shows only non-alcoholic beverages (soda, specialty coffee, tea, juice, mocktails, energy drinks, milkshakes, and water). This mode is designed for travelers in recovery, pregnant cruisers, designated drivers, or anyone preferring alcohol-free options."
        }
      },
      {
        "@type": "Question",
        "name": "How does sea day vs port day weighting work?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Sea days (when the ship is cruising) typically result in more drink consumption as passengers relax by the pool or in lounges. Port days (when passengers are off exploring) often mean fewer onboard drinks. The calculator's sea/port weighting feature adjusts your estimates: sea days are increased by your chosen percentage (default 20%), port days are decreased by the same amount, then averaged across your itinerary for a more realistic total."
        }
      }
    ]
  }
  </script>

  <!-- JSON-LD: WebApplication (Tool Classification) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Royal Caribbean Drink Package Calculator",
    "url": "https://cruisinginthewake.com/drink-calculator.html",
    "description": "Interactive break-even calculator for Royal Caribbean drink packages. Compare Soda, Refreshment, Deluxe, and Coffee Card packages vs √†-la-carte pricing with multi-currency support, Crown & Anchor voucher tracking, and personalized drinking habit analysis.",
    "applicationCategory": "UtilityApplication",
    "operatingSystem": "Any (Web-based)",
    "browserRequirements": "Requires JavaScript. Works on all modern browsers including Chrome, Firefox, Safari, Edge.",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": [
      "Multi-currency support (USD, GBP, EUR, CAD, AUD)",
      "Live exchange rates via Frankfurter API",
      "Crown & Anchor loyalty voucher tracking",
      "Package comparison (Soda, Refreshment, Deluxe, Coffee Card)",
      "Sea day vs port day weighting",
      "Group calculations (adults and minors)",
      "Pre-cruise vs onboard pricing comparison",
      "Recovery-sensitive mode (non-alcoholic only)",
      "Interactive break-even chart with Chart.js",
      "7 drinking habit presets",
      "Coffee Card punch tracking",
      "WCAG 2.1 AA accessibility compliant",
      "Offline support via Service Worker",
      "Print-optimized results"
    ],
    "screenshot": "https://cruisinginthewake.com/assets/social/drink-calculator-2025.jpg",
    "softwareVersion": "3.010.300",
    "datePublished": "2024-01-15",
    "dateModified": "2025-11-15",
    "author": {
      "@type": "Person",
      "name": "Ken Baker",
      "url": "https://cruisinginthewake.com/authors/ken-baker.html"
    },
    "provider": {
      "@type": "Organization",
      "name": "In the Wake",
      "url": "https://cruisinginthewake.com"
    },
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.8",
      "ratingCount": "1247",
      "bestRating": "5",
      "worstRating": "1"
    },
    "isAccessibleForFree": true,
    "inLanguage": "en-US"
  }
  </script>

  <!-- Favicon / PWA -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/in_the_wake_icon_32x32.png"/>
  <link rel="manifest" href="/manifest.webmanifest"/>
  
  <!-- Performance -->
  <link rel="preconnect" href="https://api.frankfurter.app"/>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin/>
  
  <!-- ‚úÖ Chart.js with Fallback -->
  <script 
    src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js" 
    defer
    id="chartjs-cdn"
  ></script>
  
  <!-- Fallback loader -->
  <script>
  window.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
      if (!window.Chart) {

        const fallback = document.createElement('script');
        fallback.src = '/assets/vendor/chart.umd.min.js?v=3.010.300';
        fallback.defer = true;
        document.head.appendChild(fallback);
      }
    }, 100);
  });
  </script>

  <!-- JSON-LD: WebPage (ICP-Lite) -->
  <script type="application/ld+json">
  {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Royal Caribbean Drink Package Calculator 2025",
  "url": "https://www.cruisinginthewake.com/drink-calculator.html",
  "description": "Compare Soda, Refreshment, Deluxe, and Coffee Card vs \u00e0-la-carte with live break-even chart. Free Royal Caribbean drink calculator with Crown & Anchor support."
}
  </script><!-- Styles -->
  <!-- Service Worker Registration -->
  <script>
  if('serviceWorker' in navigator){
    window.addEventListener('load',()=>navigator.serviceWorker.register('/sw.js').catch(()=>{}));
  }
  </script>

  <link rel="stylesheet" href="/assets/styles.css?v=3.010.300"/>
  <link rel="stylesheet" href="/assets/css/calculator.css?v=3.010.300"/>
  
  <!-- ‚úÖ Accessibility Styles -->
  <style>
    /* Screen reader only content */
    .sr-only {
      position: absolute !important;
      left: -10000px !important;
      width: 1px !important;
      height: 1px !important;
      overflow: hidden !important;
    }
    
    /* Skip link */
    .skip-link {
      position: absolute;
      left: -10000px;
      width: 1px;
      height: 1px;
      overflow: hidden;
    }
    
    .skip-link:focus {
      position: static;
      width: auto;
      height: auto;
      left: 0;
      background: #0e6e8e;
      color: white;
      padding: 12px 24px;
      text-decoration: none;
      font-weight: 700;
      z-index: 10000;
      display: block;
    }
    
    /* Winner highlighting */
    .package-card.winner {
      background: linear-gradient(135deg, #e6f4f8 0%, #d4f1e8 100%);
      border: 3px solid #10b981;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }
    
    .winner-badge {
      background: #10b981;
      color: white;
      padding: 6px 12px;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: 700;
      display: inline-block;
      margin-bottom: 8px;
    }
    
    .winner-badge-minors {
      background: #8b5cf6;
    }
    
    /* Focus indicators (WCAG 2.1 AA required) */
    *:focus {
      outline: 2px solid #0e6e8e;
      outline-offset: 2px;
    }
    
    button:focus,
    a:focus,
    [tabindex="0"]:focus {
      outline: 3px solid #0e6e8e;
      outline-offset: 3px;
    }
    
    /* Reduced motion (accessibility requirement) */
    @media (prefers-reduced-motion: reduce) {
      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }
    
    /* High contrast mode support */
    @media (prefers-contrast: high) {
      .winner-badge {
        border: 2px solid currentColor;
      }
    }
    
    /* Preset buttons */
    .preset-btn {
      margin: 4px;
      padding: 8px 16px;
      background: white;
      border: 2px solid #cbd5e1;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: all 0.2s;
    }
    
    .preset-btn:hover {
      background: #f1f5f9;
      border-color: #0e6e8e;
      transform: translateY(-1px);
    }
    
    .preset-btn:active {
      transform: translateY(0);
    }

    /* Cost Comparison Summary Table */
    .cost-option-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px;
      margin: 8px 0;
      border-radius: 8px;
      background: #f8fafc;
      border: 2px solid #e2e8f0;
      transition: all 0.2s ease;
    }

    .cost-option-row.best-value {
      background: linear-gradient(135deg, #e6f4f8 0%, #d4f1e8 100%);
      border: 3px solid #10b981;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
      transform: scale(1.02);
    }

    .cost-option-row.baseline {
      background: #fff;
      border: 2px solid #cbd5e1;
    }

    .cost-option-left {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
    }

    .cost-option-icon {
      font-size: 28px;
      line-height: 1;
    }

    .cost-option-info h4 {
      margin: 0;
      font-size: 1.1rem;
      font-weight: 600;
      color: #1e293b;
    }

    .cost-option-info p {
      margin: 2px 0 0 0;
      font-size: 0.85rem;
      color: #64748b;
    }

    .cost-option-right {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 4px;
    }

    .cost-option-price {
      font-size: 1.3rem;
      font-weight: 700;
      color: #0f172a;
    }

    .cost-option-row.best-value .cost-option-price {
      color: #059669;
    }

    .cost-option-savings {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .cost-option-savings.positive {
      color: #059669;
    }

    .cost-option-savings.negative {
      color: #dc2626;
    }

    .cost-option-badge {
      display: inline-block;
      background: #10b981;
      color: white;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 700;
      margin-top: 4px;
    }

    @media (max-width: 640px) {
      .cost-option-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 12px;
      }

      .cost-option-right {
        align-items: flex-start;
        width: 100%;
      }

      .cost-option-price {
        font-size: 1.5rem;
      }
    }

    /* Drink Input Grid */
    .drink-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 12px;
      margin: 1rem 0;
    }

    .drink-grid .row {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin: 0;
    }

    .drink-grid label {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      font-weight: 500;
      color: #1e293b;
      font-size: 0.9rem;
    }

    .drink-price {
      font-weight: 700;
      color: #059669;
      font-size: 0.95rem;
      margin-left: 8px;
    }

    .drink-grid input {
      width: 100%;
      padding: 10px 12px;
      border: 2px solid #cbd5e1;
      border-radius: 6px;
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    .drink-grid input:focus {
      border-color: #0e6e8e;
      outline: none;
    }

    .drink-section-title {
      font-weight: 600;
      color: #334155;
      margin: 1.5rem 0 0.75rem 0;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #e2e8f0;
      font-size: 1rem;
    }

    /* Split row for coffee inputs (small + large on same row) */
    .row-split {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin: 0;
    }

    .row-split-item {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .row-split-item label {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      font-weight: 500;
      color: #1e293b;
      font-size: 0.9rem;
      flex-wrap: wrap;
    }

    .row-split-item input {
      width: 100%;
      padding: 10px 12px;
      border: 2px solid #cbd5e1;
      border-radius: 6px;
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    .row-split-item input:focus {
      border-color: #0e6e8e;
      outline: none;
    }

    @media (max-width: 640px) {
      .drink-grid {
        grid-template-columns: 1fr;
      }

      /* Stack coffee inputs vertically on mobile */
      .row-split {
        grid-template-columns: 1fr;
      }
    }

    /* Header / Hero / Navbar Base Styles */
    .hero-header {
      position: relative;
      border-bottom: 6px double var(--rope);
      background: #eaf6f6;
      z-index: 9000;
    }

    .navbar {
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      align-items: flex-end;
      gap: .6rem;
      padding: .5rem .9rem .35rem;
      position: relative;
      z-index: 2000;
      overflow: visible;
    }

    .brand {
      display: flex;
      align-items: flex-end;
      gap: .6rem;
    }

    .brand img {
      height: 28px;
      width: auto;
    }

    .version-badge {
      font-size: .72rem;
      opacity: .8;
      color: var(--text-muted);
    }

    /* Navigation */
    .nav {
      flex: 1 1 auto;
      min-width: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: .5rem;
      white-space: nowrap;
      flex-wrap: nowrap;
      overflow: visible;
      padding-inline: .75rem;
    }

    @media (max-width: 768px) {

    }

    /* Print Styles */
    @media print {
      /* Show header with logo and compass */
      .hero-header {
        display: block !important;
        page-break-after: avoid;
      }

      .hero {
        display: block !important;
        min-height: 120px !important;
        background: white !important;
      }

      .navbar {
        display: flex !important;
      }

      .hero-compass {
        opacity: 0.3 !important;
        filter: grayscale(1) !important;
      }

      .hero-title .logo {
        max-width: 300px !important;
      }

      /* Hide navigation and interactive elements */
      .navbar nav, .skip-link, .btn, button:not(.print-keep),
      .quiz-modal, .email-cta, #share-btn, #reset-btn,
      .preset-btn, .rail, aside {
        display: none !important;
      }

      /* Format main content */
      .wrap {
        max-width: 100% !important;
        padding: 0 !important;
      }

      .page-grid {
        display: block !important;
      }

      .card {
        page-break-inside: avoid;
        box-shadow: none !important;
        border: 1px solid #ddd !important;
      }

      h1, h2, h3 {
        page-break-after: avoid;
      }

      /* Show version and copyright */
      footer {
        text-align: center !important;
        margin-top: 2rem !important;
        page-break-before: avoid;
      }

      /* Hide the invisible Soli Deo Gloria */
      footer p[aria-hidden="true"] {
        display: none !important;
      }
    }
  
    /* Navigation */
    .nav {
      flex: 1 1 auto;
      min-width: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: .5rem;
      white-space: nowrap;
      flex-wrap: nowrap;
      overflow: visible;
      padding-inline: .75rem;
    }

    @media (max-width: 768px) {

    }
  
    /* Navigation */
    .nav {
      flex: 1 1 auto;
      min-width: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: .5rem;
      white-space: nowrap;
      flex-wrap: nowrap;
      overflow: visible;
      padding-inline: .75rem;
    }

    @media (max-width: 768px) {

    }
  </style>

  <!-- LCP Optimization: Preload critical hero images -->
  <link rel="preload" as="image" href="/assets/logo_wake_560.png" fetchpriority="high"/>
  <link rel="preload" as="image" href="/assets/compass_rose.svg?v=3.010.300" fetchpriority="high"/>
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- ai-breadcrumbs
       entity: Royal Caribbean Drink Package Calculator
       type: Interactive Web Application
       parent: /planning.html
       category: Cruise Planning Tools
       updated: 2025-11-15
       version: 3.010.300
       expertise: 50+ cruises, drink package analysis since 2020
       features: Multi-currency, break-even analysis, Crown & Anchor vouchers, accessibility-first
       target-audience: Royal Caribbean cruisers, budget planners, loyalty members, accessibility users
       answer-first: Most cruisers break even at 6-7 drinks/day on Deluxe package
       -->

  <!-- ‚úÖ Skip Link (WCAG 2.4.1) -->

  <!-- ‚úÖ ARIA Live Regions (WCAG 4.1.3) -->
  <div id="a11y-status" role="status" aria-live="polite" aria-atomic="true" class="sr-only"></div>
  <div id="a11y-alerts" role="alert" aria-live="assertive" aria-atomic="true" class="sr-only"></div>
  <div id="aria-live-region" role="status" aria-live="polite" aria-atomic="true" class="sr-only"></div>
  
  <!-- HEADER -->
  <header class="hero-header" role="banner">
    <div class="navbar">
      <div class="brand">
        <img src="/assets/logo_wake_256.png" srcset="/assets/logo_wake_256.png 1x, /assets/logo_wake_512.png 2x" width="256" height="259" alt="In the Wake wordmark" decoding="async"/>
        <span class="tiny version-badge">v3.010.300</span>
      </div>
            <nav class="site-nav" aria-label="Main site navigation">
        <a class="nav-pill" href="/">Home</a>

        <!-- Planning Dropdown -->
        <div class="nav-dropdown" id="nav-planning">
          <button class="nav-pill" type="button" aria-expanded="false" aria-haspopup="true">
            Planning <span class="caret">&#9662;</span>
          </button>
          <div class="dropdown-menu" role="menu">
            <a href="/planning.html">Planning (overview)</a>
            <a href="/ships.html">Ships</a>
            <a href="/restaurants.html">Restaurants &amp; Menus</a>
            <a href="/ports.html">Ports</a>
            <a href="/drink-packages.html">Drink Packages</a>
            <a href="/drink-calculator.html">Drink Calculator</a>
            <a href="/stateroom-check.html">Stateroom Check</a>
            <a href="/cruise-lines.html">Cruise Lines</a>
            <a href="/packing-lists.html">Packing Lists</a>
            <a href="/accessibility.html">Accessibility</a>
          </div>
        </div>

        <!-- Travel Dropdown -->
        <div class="nav-dropdown" id="nav-travel">
          <button class="nav-pill" type="button" aria-expanded="false" aria-haspopup="true">
            Travel <span class="caret">&#9662;</span>
          </button>
          <div class="dropdown-menu" role="menu">
            <a href="/travel.html">Travel (overview)</a>
            <a href="/solo.html">Solo</a>
          </div>
        </div>

        <a class="nav-pill" href="/tools/port-tracker.html">Port Tracker</a>
        <a class="nav-pill" href="/tools/ship-tracker.html">Ship Tracker</a>
        <a class="nav-pill" href="/search.html">Search</a>
        <a class="nav-pill" href="/about-us.html">About</a>
      </nav></div>
    <div class="hero" role="img" aria-label="Ship wake at sunrise">
      <img class="hero-compass" src="/assets/compass_rose.svg?v=3.010.300" width="180" height="180" alt="" aria-hidden="true" decoding="async"/>
      <div class="hero-title">
        <img class="logo" src="/assets/logo_wake_560.png" srcset="/assets/logo_wake_560.png 1x, /assets/logo_wake_1120.png 2x" alt="In the Wake" decoding="async" fetchpriority="high" width="560" height="567"/>
        <div class="tagline">A Cruise Traveler's Logbook</div>
      </div>
      <div class="hero-credit">
        <a class="pill long" href="https://www.flickersofmajesty.com" target="_blank" rel="noopener">Photo ¬© Flickers of Majesty</a>
      </div>
    </div></header>
  
  <!-- MAIN CONTENT -->
  <main class="wrap calculator-grid" id="content">
    <!-- ICP-Lite Content Structure -->
    <section class="page-intro" style="grid-column: 2; grid-row: 1; margin: 1rem auto 1.5rem;">
      <p class="answer-line" style="margin: 0.75rem 0; padding: 0.5rem 0.75rem; border-left: 3px solid var(--rope, #d9b382); background: #f7fdff; border-radius: 8px;">
        <strong>Quick Answer:</strong> This page provides cruise planning resources for Royal Caribbean Drink Package Calculator 2025. Use the information below to help plan your cruise vacation.
      </p>

      <p class="fit-guidance" style="margin: 0.75rem 0; font-size: 0.95rem; color: #134; line-height: 1.6;">
        <strong>Best For:</strong> Cruisers researching royal caribbean drink package calculator 2025, comparing options, and gathering information for trip planning.
      </p>

      <div class="key-facts" style="margin: 1rem 0; padding: 1rem; background: #f7fdff; border-radius: 8px; border: 1px solid #e0f0f5;">
        <h3 style="margin: 0 0 0.5rem; font-size: 1rem; color: #134;">Key Facts</h3>
        <ul style="margin: 0; padding-left: 1.25rem;">
          <li><strong>Topic:</strong> Royal Caribbean Drink Package Calculator 2025</li>
          <li><strong>Purpose:</strong> Cruise planning resource</li>
        </ul>
      </div>

      <!-- ‚úÖ Cost Comparison Summary Card (positioned near top of right rail) -->
      <section class="card" id="cost-summary-card" style="display:none; margin-top: 1rem;">
        <h3>üí∞ Your Total Cost Comparison</h3>
        <p class="small muted" style="margin-bottom: 1rem;">Based on your drink selections for the entire cruise</p>

        <div id="cost-comparison-table">
          <!-- JavaScript will populate this -->
        </div>
      </section>
    </section>

    <!-- LEFT COLUMN -->
    <div>
      <!-- Loading State -->
      <div class="loading" id="loading-state">
        <span>Loading calculator</span>
      </div>
      
      <!-- Calculator App -->
      <section id="calculator-app" style="display:none;">
        <h1>Royal Caribbean Drink Package Calculator</h1>

        <!-- Quick Answer Section (AI-First SEO + Answer-First Philosophy) -->
        <div class="quick-answer" role="region" aria-label="Quick answer" style="background:linear-gradient(135deg, #e3f2fd 0%, #e1f5fe 100%);border-left:5px solid #0277bd;padding:1.25rem 1.5rem;margin:1.25rem 0;border-radius:8px;">
          <p style="margin:0 0 0.75rem 0;font-size:1.125rem;line-height:1.6;color:#01579b;">
            <strong>‚ö° Quick Answer:</strong> Most cruisers break even on the Deluxe Beverage Package at <strong>6-7 drinks per day</strong> (mix of cocktails, beer, specialty coffee).
            The Soda Package breaks even at ~4 sodas/day, and the Refreshment Package at ~5 specialty drinks/day.
          </p>
          <p style="margin:0;font-size:1rem;line-height:1.5;color:#0277bd;">
            üí° Use the calculator below to find <em>your exact break-even point</em> based on your drinking habits, Crown & Anchor vouchers, and trip length.
            It takes 60 seconds and includes all current pricing (updated Nov 2025).
          </p>
        </div>

        <!-- Best Value Banner -->
        <div class="banner" role="status" aria-live="polite">
          <span id="best-chip" class="badge">Calculating...</span>
          <span id="best-text" class="small"></span>
        </div>
        
        <!-- ‚úÖ NEW: Package Selection Status Banner -->
        <div id="package-selector-status" class="selector-status" role="status" aria-live="polite" style="display:none;">
          <!-- JavaScript will populate this -->
        </div>
        
        <!-- Offline Banners -->
        <p id="fallback-banner" hidden class="banner-warn">‚ö†Ô∏è Live prices unavailable; using defaults</p>
        <p id="offline-rates-chip" hidden class="banner-warn">‚ö†Ô∏è Offline exchange rates (may be stale)</p>
        
        <!-- Quick Start Quiz -->
        <div class="card quiz-cta">
          <h3 style="margin-top:0">üéØ Not sure what you drink?</h3>
          <p class="small">Take our 60-second quiz to get personalized recommendations.</p>
          <button class="btn" type="button" id="quiz-open-btn" aria-label="Start drink preference quiz">Start Quiz</button>
        </div>
        
        <!-- Calculator Inputs -->
        <section class="card inputs">
          <h2>
            <span id="totals" aria-live="polite">Calculating...</span>
            <small class="tiny"> ‚Äî includes 18% gratuity</small>
          </h2>
          
          <!-- ‚úÖ NEW: Recovery-Sensitive View Toggle -->
          <div class="view-options" style="background:#f5f5f5;border:2px solid #e0e0e0;border-radius:8px;padding:1rem;margin:1rem 0;">
            <label class="toggle-switch" style="display:flex;align-items:center;gap:0.75rem;cursor:pointer;user-select:none;">
              <input type="checkbox" id="non-alcohol-view" aria-label="Show only non-alcoholic options" style="position:absolute;opacity:0;width:0;height:0;">
              <span class="toggle-slider" style="position:relative;width:52px;height:28px;background:#ccc;border-radius:28px;transition:background 0.3s;">
                <span style="position:absolute;width:22px;height:22px;left:3px;top:3px;background:white;border-radius: 12px;transition:transform 0.3s;box-shadow:0 2px 4px rgba(0,0,0,0.2);"></span>
              </span>
              <span class="toggle-label" style="font-weight:500;color:#212121;">Non-alcoholic beverages only</span>
            </label>
          </div>
          
          <!-- ‚úÖ NEW: Recovery Affirmation Message (hidden by default) -->
          <div id="recovery-affirmation" class="recovery-affirmation" style="display:none;background:linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);border:2px solid #4caf50;border-radius:8px;padding:1.25rem;margin:1rem 0;">
            <p style="margin:0.5rem 0;color:#1b5e20;line-height:1.6;">
              <strong>We support your journey.</strong> This view focuses on non-alcoholic beverages to help you plan a fulfilling cruise experience.
            </p>
          </div>
          
          <!-- Currency & Brand Selectors -->
          <div class="controls-inline">
            <label for="currency-select">Display currency</label>
            <select id="currency-select" aria-label="Select display currency">
              <option value="USD">USD $</option>
              <option value="GBP">GBP ¬£</option>
              <option value="EUR">EUR ‚Ç¨</option>
              <option value="CAD">CAD $</option>
              <option value="AUD">AUD $</option>
            </select>
            <span id="fx-note" class="tiny muted"></span>
          </div>
          
          <div class="controls-inline" style="margin-top:0.75rem">
            <label for="brand-select">Cruise line</label>
            <select id="brand-select" aria-label="Select cruise line">
              <option value="royal-caribbean" selected>‚öì Royal Caribbean</option>
              <option value="celebrity" disabled>üö¢ Celebrity Cruises (coming soon)</option>
              <option value="carnival" disabled>üéâ Carnival (coming soon)</option>
              <option value="princess" disabled>üëë Princess (coming soon)</option>
              <option value="norwegian" disabled>üåä Norwegian (coming soon)</option>
              <option value="msc" disabled>üåç MSC Cruises (coming soon)</option>
            </select>
            <span id="brand-note" class="tiny muted"></span>
          </div>
          
          <!-- ‚úÖ NEW: Pre-Cruise Pricing Toggle -->
          <div class="pricing-context" style="background:#e3f2fd;border:2px solid #2196f3;border-radius:8px;padding:1rem;margin:1rem 0;">
            <label for="pricing-type" style="display:block;font-weight:600;color:#0d47a1;margin-bottom:0.5rem;">When are you buying packages?</label>
            <select id="pricing-type" style="width:100%;padding:0.625rem;font-size:1rem;border:2px solid #2196f3;border-radius:6px;background:white;cursor:pointer;">
              <option value="pre" selected>Pre-cruise (cheapest - recommended)</option>
              <option value="onboard">Onboard (typically 20-30% higher)</option>
            </select>
            <p class="helper" style="margin-top:0.75rem;font-size:0.9375rem;color:#0d47a1;line-height:1.5;">
              üí° <strong>Pro tip:</strong> Always buy packages pre-cruise for significant savings!
            </p>
          </div>
          
          <!-- ‚úÖ NEW: Quick Presets with Dynamic Rendering -->
          <div class="controls-inline" style="margin-bottom:12px">
            <strong class="small">Quick presets:</strong>
            <div id="preset-buttons" role="group" aria-label="Drinking habit presets">
              <!-- JavaScript will render all 7 preset buttons here -->
            </div>
          </div>
          
          <!-- Preset Explanation -->
          <div id="preset-explanation" class="preset-explain" style="display:none;">
            <h4 style="margin-top:0;">üìã <span id="preset-name">Preset</span> Breakdown</h4>
            <p class="small" id="preset-desc"></p>
            <div id="preset-drinks"></div>
            <p class="tiny muted preset-tip">
              <strong>üí° Tip:</strong> These are averages. Adjust any field above to match your exact preferences.
            </p>
          </div>
          
          <hr class="divider"/>
          
          <!-- Basic Inputs -->
          <div class="row">
            <label for="input-days">Cruise days</label>
            <input id="input-days" type="text" inputmode="numeric" value="7" data-input="days" aria-label="Number of cruise days"/>
          </div>
          
          <div class="row">
            <label for="input-seadays">Sea days</label>
            <input id="input-seadays" type="text" inputmode="numeric" value="3" data-input="seadays" aria-label="Number of sea days"/>
          </div>
          
          <!-- Sea Day Weighting -->
          <details open>
            <summary style="cursor:pointer;font-weight:700;margin:12px 0">‚öñÔ∏è Sea/Port Variability</summary>
            <p class="tiny muted" style="margin-bottom:8px">
              üí° <strong>How it works:</strong> Sea days often mean more drinks (relaxing by the pool). Port days often mean fewer (off exploring). 
              This setting adjusts estimates accordingly. Sea days will be increased by this percentage; port days decreased by the same amount, then averaged over your itinerary.
            </p>
            <div class="row">
              <label>
                <input type="checkbox" id="sea-toggle" checked data-input="seaapply" aria-label="Apply sea day weighting"/>
                Apply weighting
              </label>
              <div class="controls-inline">
                <label for="sea-weight">¬±%</label>
                <input id="sea-weight" type="range" min="0" max="40" value="20" data-input="seaweight" aria-label="Sea day weight percentage"/>
                <span id="sea-weight-val" aria-live="polite">20%</span>
              </div>
            </div>
          </details>
          
          <!-- Group -->
          <details open>
            <summary style="cursor:pointer;font-weight:700;margin:12px 0">Group in stateroom</summary>
            <div class="row">
              <label for="input-adults">Adults (21+)</label>
              <input id="input-adults" type="text" inputmode="numeric" value="1" data-input="adults" aria-label="Number of adults"/>
            </div>
            <div class="row">
              <label for="input-minors">Minors (under 21)</label>
              <input id="input-minors" type="text" inputmode="numeric" value="0" data-input="minors" aria-label="Number of minors"/>
            </div>
          </details>
          
          <!-- ‚úÖ UPDATED: Crown & Anchor Vouchers (Pinnacle fixed to 6/day) -->
          <details id="cna-vouchers">
            <summary style="cursor:pointer;font-weight:700;margin:12px 0">
              üëë Crown & Anchor Vouchers
              <span class="badge-gold">Diamond+ Members</span>
            </summary>
            
            <div class="cna-explainer">
              <h4 style="margin-top:0;color:#a67c00;">üíé Loyalty Drink Vouchers</h4>
              <p class="small"><strong>Got 80+ cruise nights?</strong> You're probably Diamond or higher! These vouchers add up FAST.</p>
              
              <div class="cna-tiers">
                <div class="cna-tier">
                  <div class="tier-header">
                    <span class="tier-icon">üíé</span>
                    <strong>Diamond</strong>
                    <span class="tiny muted">(80-174 nights)</span>
                  </div>
                  <p class="small"><strong>4 drink vouchers per day</strong>, loaded on your SeaPass</p>
                  <p class="tiny muted">= $56/day in free drinks ($392/week cruise)</p>
                </div>
                
                <div class="cna-tier">
                  <div class="tier-header">
                    <span class="tier-icon">üíéüíé</span>
                    <strong>Diamond Plus</strong>
                    <span class="tiny muted">(175-699 nights)</span>
                  </div>
                  <p class="small"><strong>5 drink vouchers per day</strong>, loaded on your SeaPass</p>
                  <p class="tiny muted">= $70/day in free drinks ($490/week cruise)</p>
                </div>
                
                <div class="cna-tier">
                  <div class="tier-header">
                    <span class="tier-icon">üëë</span>
                    <strong>Pinnacle</strong>
                    <span class="tiny muted">(700+ nights)</span>
                  </div>
                  <p class="small"><strong>6 drink vouchers per day</strong>, loaded on your SeaPass</p>
                  <p class="tiny muted">= $84/day in free drinks ($588/week cruise)</p>
                </div>
              </div>
              
              <div class="cna-tip">
                <p class="small"><strong>üí° Pro tip:</strong> If you're not sure whether you're Diamond, you're probably not (yet!). Check your Crown & Anchor number on royalcaribbean.com or the app.</p>
                <p class="tiny muted">Each voucher = <strong>$14.00</strong> toward any beverage (alcoholic or non-alcoholic). Vouchers work as FREE DRINKS, not dollar credits.</p>
              </div>
            </div>
            
            <div class="row">
              <label for="input-voucher-adult">
                Adult vouchers/day
                <span class="tiny muted">(4 for Diamond, 5 for Diamond+, 6 for Pinnacle)</span>
              </label>
              <input id="input-voucher-adult" type="text" inputmode="numeric" value="0" data-input="voucher-adult" min="0" max="10" placeholder="0-6" aria-label="Adult vouchers per day"/>
            </div>
            
            <div class="row">
              <label for="input-voucher-minor">
                Minor vouchers/day
                <span class="tiny muted">(Great for specialty drinks, juices, mocktails!)</span>
              </label>
              <input id="input-voucher-minor" type="text" inputmode="numeric" value="0" data-input="voucher-minor" min="0" max="10" placeholder="0" aria-label="Minor vouchers per day"/>
            </div>
            
            <p class="tiny muted voucher-note">
              <strong>Deluxe package cap:</strong> 
              <span id="cap-badge" class="cap-badge">$14.00</span>
              <span> per drink before gratuity. Drinks over this, you pay the difference.</span>
            </p>
          </details>
          
          <!-- Coffee Card Option -->
          <details id="coffee-card-section">
            <summary style="cursor:pointer;font-weight:700;margin:12px 0">
              ‚òï Coffee Card Option
              <span class="tiny muted">(alternative to packages)</span>
            </summary>
            
            <div class="coffee-card-explainer">
              <h4>‚òï Caf√© Select Coffee Card</h4>
              <p class="small">Prepaid punch card for 15 specialty coffees at ~$31 + gratuity</p>
              
              <div class="punch-info">
                <div class="punch-row">
                  <span class="punch-badge">1 PUNCH</span>
                  <span>Small espresso drinks, hot chocolate</span>
                </div>
                <div class="punch-row">
                  <span class="punch-badge">2 PUNCHES</span>
                  <span>Large drinks, iced beverages, extra shots</span>
                </div>
              </div>
              
              <!-- ‚úÖ NEW: Coffee Card Expiration Notice -->
              <p class="coffee-card-note" style="background:#fff9e6;border-left:4px solid #ffc107;padding:0.75rem;margin:0.75rem 0;border-radius:4px;font-size:0.9375rem;color:#424242;">
                ‚è∞ <strong style="color:#f57c00;">Note:</strong> Unused punches expire at cruise end. Check with Royal Caribbean if rollovers to future cruises are still allowed (policy varies‚Äîverify in Cruise Planner).
              </p>
              
              <p class="tiny muted"><strong>Sharing:</strong> Card can be shared among cabin guests. Not valid at licensed Starbucks stores but works at "We Proudly Serve" Starbucks locations. Can save up to 50% vs. paying individually.</p>
            </div>
            
            <div class="row">
              <label for="input-coffee-cards">Coffee Cards</label>
              <input id="input-coffee-cards" type="text" inputmode="numeric" value="0" data-input="coffee-cards" min="0" aria-label="Number of coffee cards"/>
            </div>
            
            <div class="row">
              <label for="input-coffee-punches-per-day">Avg punches/day</label>
              <input id="input-coffee-punches-per-day" type="text" inputmode="decimal" value="0" data-input="coffee-punches" min="0" max="5" step="0.5" aria-label="Average punches per day"/>
            </div>
          </details>
          
          <!-- ‚úÖ UPDATED: Daily drinks (clarified as "per adult") -->
          <details open>
            <summary style="cursor:pointer;font-weight:700;margin:12px 0">Daily drinks (average <strong style="color:#1976d2;">per adult</strong>)</summary>
            
            <!-- ‚úÖ NEW: Helper text for clarity -->
            <div class="input-helper" style="background:#e3f2fd;border-left:4px solid #2196f3;padding:1rem;margin:1rem 0;border-radius:6px;">
              <p style="margin:0.5rem 0;color:#212121;">
                ‚ÑπÔ∏è <strong style="color:#0d47a1;">Important:</strong> Enter drinks <strong style="color:#0d47a1;">per adult</strong> in your group, not the total for everyone.
              </p>
              <p class="helper-example" style="background:#fff;padding:0.75rem;border-radius:4px;margin-top:0.75rem;border-left:3px solid #4caf50;margin:0.5rem 0;color:#212121;">
                <strong style="color:#2e7d32;">Example:</strong> If you're 2 adults and each drinks 3 beers per day, enter <strong style="color:#2e7d32;">3</strong> (not 6). The calculator will multiply by your group size.
              </p>
            </div>
            
            <p class="preset-tip" style="font-size:0.9375rem;color:#616161;font-style:italic;margin-top:0.5rem;">
              üí° Tip: These are daily averages. Use the sea/port weighting above if your drinking varies by day type.
            </p>
            
            <!-- Drink inputs with data-category for recovery view -->
            <!-- ‚úÖ NEW: Grid layout with visible prices -->

            <h4 class="drink-section-title">ü•§ Non-Alcoholic Drinks</h4>
            <div class="drink-grid">
              <div class="row">
                <label for="drink-soda">Soda <span class="drink-price">$2.00</span></label>
                <input id="drink-soda" data-input="soda" type="text" inputmode="decimal" value="0" aria-label="Sodas per day"/>
              </div>

              <div class="row">
                <label for="drink-teaprem">Premium tea <span class="drink-price">$3.50</span></label>
                <input id="drink-teaprem" data-input="teaprem" type="text" inputmode="decimal" value="0" aria-label="Premium teas per day"/>
              </div>

              <!-- ‚úÖ NEW v1.003.003: Split coffee into small (1 punch) and large (2 punches) -->
              <!-- ‚úÖ LAYOUT FIX: Both coffees on same row -->
              <div class="row-split">
                <div class="row-split-item">
                  <label for="drink-coffee-small">Specialty coffee - small <span class="tiny muted">(1 punch)</span> <span class="drink-price">$4.50</span></label>
                  <input id="drink-coffee-small" data-input="coffeeSmall" type="text" inputmode="decimal" value="0" aria-label="Small specialty coffees per day (1 punch each)"/>
                </div>

                <div class="row-split-item">
                  <label for="drink-coffee-large">Specialty coffee - large/iced <span class="tiny muted">(2 punches)</span> <span class="drink-price">$4.50</span></label>
                  <input id="drink-coffee-large" data-input="coffeeLarge" type="text" inputmode="decimal" value="0" aria-label="Large or iced specialty coffees per day (2 punches each)"/>
                </div>
              </div>

              <div class="row">
                <label for="drink-freshjuice">Fresh juice <span class="drink-price">$6.00</span></label>
                <input id="drink-freshjuice" data-input="freshjuice" type="text" inputmode="decimal" value="0" aria-label="Fresh juices per day"/>
              </div>

              <div class="row">
                <label for="drink-mocktail">Mocktail <span class="drink-price">$6.50</span></label>
                <input id="drink-mocktail" data-input="mocktail" type="text" inputmode="decimal" value="0" aria-label="Mocktails per day"/>
              </div>

              <div class="row">
                <label for="drink-energy">Energy drink <span class="drink-price">$5.50</span></label>
                <input id="drink-energy" data-input="energy" type="text" inputmode="decimal" value="0" aria-label="Energy drinks per day"/>
              </div>

              <div class="row">
                <label for="drink-milkshake">Milkshake <span class="drink-price">$6.95</span></label>
                <input id="drink-milkshake" data-input="milkshake" type="text" inputmode="decimal" value="0" aria-label="Milkshakes per day"/>
              </div>

              <div class="row">
                <label for="drink-bottledwater">Bottled water <span class="drink-price">$2.95</span></label>
                <input id="drink-bottledwater" data-input="bottledwater" type="text" inputmode="decimal" value="0" aria-label="Bottled waters per day"/>
              </div>
            </div>

            <h4 class="drink-section-title">üç∫ Alcoholic Drinks</h4>
            <div class="drink-grid">
              <!-- Alcoholic drinks with data-category="alcohol" for recovery view -->
              <div class="row" data-category="alcohol">
                <label for="drink-beer">Beer <span class="drink-price">$8.50</span></label>
                <input id="drink-beer" data-input="beer" type="text" inputmode="decimal" value="0" aria-label="Beers per day"/>
              </div>

              <div class="row" data-category="alcohol">
                <label for="drink-wine">Wine <span class="drink-price">$11.00</span></label>
                <input id="drink-wine" data-input="wine" type="text" inputmode="decimal" value="0" aria-label="Wines per day"/>
              </div>

              <div class="row" data-category="alcohol">
                <label for="drink-cocktail">Cocktail <span class="drink-price">$13.00</span></label>
                <input id="drink-cocktail" data-input="cocktail" type="text" inputmode="decimal" value="0" aria-label="Cocktails per day"/>
              </div>

              <div class="row" data-category="alcohol">
                <label for="drink-spirits">Spirits <span class="drink-price">$10.00</span></label>
                <input id="drink-spirits" data-input="spirits" type="text" inputmode="decimal" value="0" aria-label="Spirits per day"/>
              </div>
            </div>
          </details>
          
          <!-- Chart -->
          <div id="breakeven-wrap">
            <div id="best-stamp" aria-hidden="true">Best value</div>
            <canvas id="breakeven-chart" role="img" aria-label="Package cost comparison chart" aria-describedby="chart-desc"></canvas>
            
            <!-- ‚úÖ Screen Reader Table (WCAG 2.1 AA Required) -->
            <table id="chart-desc" class="sr-only" aria-label="Package cost comparison data">
              <caption>Package cost comparison</caption>
              <thead>
                <tr>
                  <th scope="col">Package Option</th>
                  <th scope="col">Total Cost</th>
                  <th scope="col">Status</th>
                </tr>
              </thead>
              <tbody id="chart-sr-table">
                <!-- JavaScript will populate this -->
              </tbody>
            </table>
            
            <div id="range-note" class="tiny muted"></div>
          </div>
          
          <!-- Chart Help Text -->
          <div class="chart-help">
            <strong>üí° How to read:</strong> Blue bar = your actual drinking cost per day (including 18% gratuity). 
            Gray bars = what you'd pay for each package. <strong>Lower = better value.</strong>
            Hover over bars to see exact dollar amounts.
          </div>
          
          <!-- ‚úÖ NEW: Nudges Container (dynamically populated) -->
          <div id="nudges-container" role="region" aria-label="Breakeven tips" style="display:none;">
            <!-- JavaScript will populate nudges here -->
          </div>
          
          <!-- ‚úÖ NEW: Health Note Container (dynamically populated) -->
          <div id="health-note-container" role="region" aria-label="Health advisory" style="display:none;">
            <!-- JavaScript will populate health notes here -->
          </div>
          
          <!-- ‚úÖ UPDATED: Absolute Policy Warning -->
          <div id="policy-note" class="policy-alert critical" role="alert" aria-live="assertive" style="display:none;background:linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);border:3px solid #f57c00;border-radius:12px;padding:1.5rem;margin:2rem 0;box-shadow:0 4px 12px rgba(245, 124, 0, 0.2);">
            <h3 style="color:#e65100;margin-top:0;font-size:1.25rem;display:flex;align-items:center;gap:0.5rem;">üö® Royal Caribbean Policy (No Exceptions Since August 1, 2025)</h3>
            
            <div class="policy-mandate" style="background:#fff;border-left:5px solid #ff5722;padding:1.25rem;margin:1rem 0;border-radius:4px;">
              <p class="policy-rule" style="font-size:1.125rem;line-height:1.7;margin:0;color:#212121;">
                If <strong style="color:#d84315;font-weight:700;">ANY adult (21+)</strong> in your stateroom purchases the 
                <strong style="color:#d84315;font-weight:700;">Deluxe Beverage Package</strong>, <strong style="color:#d84315;font-weight:700;">ALL adults</strong> 
                in that stateroom <strong style="color:#d84315;font-weight:700;">MUST purchase it.</strong>
              </p>
            </div>
            
            <details class="policy-details" open style="margin:1.5rem 0;border:2px solid #ff9800;border-radius:8px;overflow:hidden;">
              <summary style="cursor:pointer;font-weight:700;color:#e65100;padding:1rem;background:#fff3e0;border-bottom:2px solid #ff9800;user-select:none;"><strong>NO EXCEPTIONS</strong> ‚Äî Click to see what's NOT exempt ‚ñº</summary>
              <div class="exceptions-content" style="padding:1.25rem;background:#fff;">
                <p class="exceptions-intro" style="font-weight:600;color:#212121;margin-bottom:0.75rem;">
                  Royal Caribbean does <strong>NOT</strong> grant exceptions for:
                </p>
                <ul class="no-exceptions-list" style="list-style:none;padding-left:0;margin:1rem 0;">
                  <li style="padding:0.5rem 0.75rem;font-weight:500;font-size:1rem;color:#424242;border-left:3px solid #ff5722;margin:0.5rem 0;background:#fafafa;">‚ùå Pregnant women</li>
                  <li style="padding:0.5rem 0.75rem;font-weight:500;font-size:1rem;color:#424242;border-left:3px solid #ff5722;margin:0.5rem 0;background:#fafafa;">‚ùå Medical conditions or medications</li>
                  <li style="padding:0.5rem 0.75rem;font-weight:500;font-size:1rem;color:#424242;border-left:3px solid #ff5722;margin:0.5rem 0;background:#fafafa;">‚ùå Religious reasons</li>
                  <li style="padding:0.5rem 0.75rem;font-weight:500;font-size:1rem;color:#424242;border-left:3px solid #ff5722;margin:0.5rem 0;background:#fafafa;">‚ùå Recovery from addiction</li>
                  <li style="padding:0.5rem 0.75rem;font-weight:500;font-size:1rem;color:#424242;border-left:3px solid #ff5722;margin:0.5rem 0;background:#fafafa;">‚ùå Personal preference ("I don't drink alcohol")</li>
                  <li style="padding:0.5rem 0.75rem;font-weight:500;font-size:1rem;color:#424242;border-left:3px solid #ff5722;margin:0.5rem 0;background:#fafafa;">‚ùå One person "doesn't want it"</li>
                </ul>
                <p class="policy-consequence" style="background:#ffebee;border:2px solid #f44336;border-radius:6px;padding:1rem;margin-top:1rem;color:#212121;">
                  <strong style="color:#c62828;">If you cannot afford packages for all adults:</strong><br>
                  Your only option is to <strong>skip drink packages entirely</strong> and pay per drink √† la carte.
                </p>
              </div>
            </details>
            
            <div class="policy-enforcement" style="background:#fff;border-radius:6px;padding:1rem;margin:1rem 0;border-left:4px solid #ff9800;">
              <p style="margin:0;color:#212121;">
                <strong style="color:#e65100;">‚öñÔ∏è Strictly Enforced:</strong> This policy is enforced by Royal Caribbean at booking and <strong>cannot be changed onboard</strong>.
              </p>
            </div>
            
            <p class="policy-source" style="margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(0,0,0,0.1);color:#757575;font-size:0.875rem;">
              Policy change effective August 1, 2025. 
              <a href="https://www.royalcaribbeanblog.com/2025/08/02/royal-caribbean-drops-drink-package-exception-rule" 
                 target="_blank" 
                 rel="noopener noreferrer"
                 style="color:#ff5722;text-decoration:none;font-weight:600;">
                Source: Royal Caribbean Blog ‚Üó
              </a>
            </p>
          </div>
          
          <!-- ‚úÖ NEW: Family Policy Note (Minors + Deluxe) -->
          <div class="policy-alert family-note" role="region" aria-labelledby="family-policy-title" style="display:none;background:linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);border:3px solid #4caf50;border-radius:12px;padding:1.5rem;margin:2rem 0;">
            <h4 id="family-policy-title" style="color:#2e7d32;margin-top:0;display:flex;align-items:center;gap:0.5rem;">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Important for Families with Minors</h4>
            
            <div class="family-rule" style="background:#fff;border-left:5px solid #4caf50;padding:1.25rem;margin:1rem 0;border-radius:4px;">
              <p style="margin:0;font-size:1.0625rem;line-height:1.6;color:#212121;">
                When adults purchase the <strong style="color:#2e7d32;">Deluxe Beverage Package</strong>, 
                Royal Caribbean <strong style="color:#2e7d32;">requires all minors</strong> (under 21) in the 
                stateroom to purchase the <strong style="color:#2e7d32;">Refreshment Package</strong>.
              </p>
            </div>
            
            <div class="family-details" style="background:#fff;padding:1rem;border-radius:6px;margin:1rem 0;">
              <p style="margin:0.5rem 0;color:#212121;"><strong style="color:#2e7d32;">Example:</strong> If 2 adults + 1 teen (age 16):</p>
              <ul style="margin:0.75rem 0;padding-left:1.5rem;">
                <li style="padding:0.25rem 0;color:#424242;">2 adults √ó Deluxe Package = <strong>2 Deluxe packages required</strong></li>
                <li style="padding:0.25rem 0;color:#424242;">1 minor √ó Refreshment Package = <strong>1 Refreshment package required</strong></li>
              </ul>
              <p class="family-note" style="font-weight:600;color:#1b5e20;margin-top:0.75rem;">
                This applies even if the minor doesn't plan to use the package. <strong>Factor this into your total cost calculation.</strong>
              </p>
            </div>
            
            <div class="family-usa-rule" style="background:#e3f2fd;border-left:3px solid #1976d2;padding:0.75rem;margin-top:1rem;border-radius:4px;">
              <p style="margin:0;color:#0d47a1;">
                <small>
                  üá∫üá∏ <strong>USA Departures:</strong> Minors under 21 cannot purchase or consume alcoholic beverages on cruises departing from US ports, regardless of package type.
                </small>
              </p>
            </div>
          </div>
          
          <!-- Category Breakdown -->
          <div id="category-breakdown" class="category-summary" hidden>
            <h4 style="margin-top:0">üí∞ Where Your Money Goes (per day)</h4>
            <div class="category-grid" id="category-grid"></div>
          </div>
          
          <!-- Actions -->
          <div class="controls-inline action-buttons">
            <button class="btn" type="button" onclick="window.print()" aria-label="Print calculator results">Print Results</button>
            <button class="btn ghost" type="button" id="share-btn" aria-label="Copy link to share">Copy Link</button>
            <button class="btn" type="button" id="reset-btn" aria-label="Reset calculator to defaults">Reset</button>
          </div>
        </section>
        
        <!-- Group Breakdown -->
        <section style="grid-column: 1;" class="card" id="group-breakdown" hidden>
          <h2>Group Breakdown (Per Person)</h2>
          <table class="group-table">
            <thead>
              <tr><th scope="col">Traveler</th><th scope="col">Package</th><th scope="col">Daily</th><th scope="col">Trip</th></tr>
            </thead>
            <tbody id="group-table-body"></tbody>
          </table>
        </section>
        
        <!-- Stewardship Statement -->
        <section style="grid-column: 1;" class="card legal-block" role="note" aria-label="Disclaimers and responsible use">
          <p><strong>Stewardship & Responsible Use:</strong> This calculator helps you plan wisely‚Äînot encourage excess. Packages include far more than alcohol (water, coffee, juice). Hydrate, pace yourself, look after your crew. <em>Moderation honors wallet, body, and spirit.</em></p>
          
          <p class="tiny" style="margin-top:0.75rem">
            <strong>Pricing disclaimer:</strong> Estimates based on recent community data. Actual prices vary by ship/itinerary. Always verify in Cruise Planner. Not financial advice.
          </p>
        </section>
        
        <!-- Email CTA -->
        <section class="card email-cta" id="email-cta" hidden>
          <h3 style="margin-top:0">üìß Save Your Results</h3>
          <p class="small">Get this breakdown emailed for easy reference later.</p>
          <form id="email-form">
            <input type="email" name="email" placeholder="you@example.com" required aria-label="Email address"/>
            <input type="hidden" name="savings" id="email-savings"/>
            <input type="hidden" name="recommendation" id="email-rec"/>
            <input type="hidden" name="days" id="email-days"/>
            <button class="btn" type="submit">Email Me</button>
          </form>
        </section>
      </section>
    </div>
    
    <!-- RIGHT RAIL -->
    <aside class="rail" role="complementary" aria-label="Package comparison and additional information" style="grid-column: 2; grid-row: 2;">
      <!-- Package Cards -->
      <section>
        <h3>Package Comparison</h3>
        
        <div class="package-card info-card" data-card="coffee">
          <h4>‚òï Coffee Card</h4>
          <div class="price">
            <span data-pkg-price="coffee" data-edit-price="coffee" tabindex="0" role="button" aria-label="Edit coffee card price. Current value: $31.00">$31.00</span>
          </div>
          <p class="small">15 punches (~$2.07/punch)</p>
          <p class="tiny muted">One-time purchase, not a daily package</p>
        </div>
        
        <div class="package-card" data-card="soda" data-package="soda">
          <h4>Classic Soda</h4>
          <div class="price">
            <span data-pkg-price="soda" data-edit-price="soda" tabindex="0" role="button" aria-label="Edit soda package price. Current value: $13.99">$13.99</span>
          </div>
          <p class="small">per person, per day</p>
          <p class="tiny muted">Fountain soda, Coca-Cola Freestyle</p>
          <div class="tiny" data-inc="soda">Includes: $0/day</div>
        </div>
        
        <div class="package-card" data-card="refresh" data-package="refresh">
          <h4>Refreshment</h4>
          <div class="price">
            <span data-pkg-price="refresh" data-edit-price="refresh" tabindex="0" role="button" aria-label="Edit refreshment package price. Current value: $34.00">$34.00</span>
          </div>
          <p class="small">per person, per day</p>
          <p class="tiny muted">Non-alcoholic specialty drinks</p>
          <div class="tiny" data-inc="refresh">Includes: $0/day</div>
        </div>
        
        <div class="package-card" data-card="deluxe" data-package="deluxe">
          <h4>Deluxe (Alcoholic)</h4>
          <div class="price">
            <span data-pkg-price="deluxe" data-edit-price="deluxe" tabindex="0" role="button" aria-label="Edit deluxe package price. Current value: $85.00">$85.00</span>
          </div>
          <p class="small">per person, per day</p>
          <p class="tiny muted">Cocktails, beer, wine up to $14/drink</p>
          <div class="tiny" data-inc="deluxe">Includes: $0/day</div>
          <div class="tiny overcap-note" id="overcap-est">Over-cap: $0/day</div>
        </div>
      </section>

      <!-- Author -->
      <section class="card author-card">
        <h3>About the Author</h3>
        <div class="author-info">
          <a href="/authors/ken-baker.html" class="author-link">
            <picture>
              <source srcset="/authors/img/ken1.webp?v=3.010.300" type="image/webp"/>
              <img class="author-avatar" src="/authors/img/ken1_96.webp" srcset="/authors/img/ken1_96.webp 1x, /authors/img/ken1_192.webp 2x" width="96" height="96" alt="Author photo" style="border-radius: 12px;" decoding="async" loading="lazy"/>
            </picture>
          </a>
          <div>
            <h4><a href="/authors/ken-baker.html">Ken Baker</a></h4>
            <p class="tiny">Founder of In the Wake; writer and editor of the logbook.</p>
            <p class="tiny">
              <a href="https://www.flickersofmajesty.com" target="_blank" rel="noopener">Flickers of Majesty</a>
            </p>
          </div>
        </div>
      </section>
      
      <!-- Recent Articles -->
      <section class="card" aria-labelledby="recent-rail-title">
        <h3 id="recent-rail-title">Recent Stories</h3>
        <p class="tiny" style="margin-bottom: 1rem; color: var(--ink-mid, #3d5a6a); line-height: 1.5;">
          Real cruising experiences, practical guides, and heartfelt reflections from our community. Explore stories that inform, inspire, and connect.
        </p>
        <div id="recent-rail" class="rail-list" aria-live="polite"></div>
        <p id="recent-rail-fallback" class="tiny" style="display:none">Loading articles‚Ä¶</p>
      </section>
    
    </aside>
  
    <!-- ICP-Lite FAQ Section -->
    <section class="card faq" id="faq" style="margin: 1.5rem 0; padding: 1rem;">
      <h2 style="margin: 0 0 1rem; font-size: 1.25rem;">Frequently Asked Questions</h2>

      <details style="margin: 0.5rem 0; padding: 0.5rem 0; border-bottom: 1px solid #e0e8f0;">
        <summary style="cursor: pointer; font-weight: 600; padding: 0.5rem 0;">What information does this page provide?</summary>
        <p style="margin: 0.5rem 0; padding-left: 1rem;">This page provides planning resources and information about royal caribbean drink package calculator 2025. Use it alongside official cruise line resources when planning your trip.</p>
      </details>

      <details style="margin: 0.5rem 0; padding: 0.5rem 0; border-bottom: 1px solid #e0e8f0;">
        <summary style="cursor: pointer; font-weight: 600; padding: 0.5rem 0;">Is this information official?</summary>
        <p style="margin: 0.5rem 0; padding-left: 1rem;">This page provides community insights and planning resources. Always confirm details with your cruise line or travel advisor before making final decisions.</p>
      </details>

      <details style="margin: 0.5rem 0; padding: 0.5rem 0;">
        <summary style="cursor: pointer; font-weight: 600; padding: 0.5rem 0;">How can I get more help?</summary>
        <p style="margin: 0.5rem 0; padding-left: 1rem;">For additional assistance, contact your cruise line directly or work with a travel advisor who specializes in cruises.</p>
      </details>
    </section>

</main>
  
  <!-- ‚úÖ Quiz Modal with Full Accessibility -->
  <div id="quiz-modal" 
       class="modal" 
       role="dialog" 
       aria-modal="true" 
       aria-labelledby="quiz-title"
       aria-hidden="true" 
       style="display:none;">
    <div class="modal-content">
      <button class="modal-close" 
              id="quiz-close-btn" 
              type="button"
              aria-label="Close quiz">&times;</button>
      
      <div id="quiz-content">
        <h2 id="quiz-title" style="margin-top:0;">Find Your Perfect Package üéØ</h2>
        <p class="small modal-intro">Answer 3 quick questions to get a personalized recommendation</p>
        
        <!-- Step 1 -->
        <div id="quiz-step-1" class="quiz-step">
          <p><strong>Question 1 of 3:</strong> What type of cruise are you taking?</p>
          <div class="quiz-buttons">
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="family">
              <strong>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family Vacation</strong><br/>
              <span class="tiny">Traveling with kids and family</span>
            </button>
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="party">
              <strong>üéâ Party / Celebration</strong><br/>
              <span class="tiny">Bachelor/bachelorette, birthday, or friends trip</span>
            </button>
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="romantic">
              <strong>üíë Romantic Getaway</strong><br/>
              <span class="tiny">Couples cruise, honeymoon, or anniversary</span>
            </button>
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="solo">
              <strong>üß≥ Solo Adventure</strong><br/>
              <span class="tiny">Traveling alone and meeting new people</span>
            </button>
          </div>
        </div>
        
        <!-- Step 2 -->
        <div id="quiz-step-2" class="quiz-step" style="display:none;">
          <p><strong>Question 2 of 3:</strong> How much do you typically drink per day?</p>
          <div class="quiz-buttons">
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="light">
              <strong>ü•§ Light (1-2 drinks)</strong><br/>
              <span class="tiny">Occasional sipper, mostly water/soda</span>
            </button>
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="moderate">
              <strong>üç∑ Moderate (3-4 drinks)</strong><br/>
              <span class="tiny">Social drinker, wine with dinner</span>
            </button>
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="heavy">
              <strong>üçª Heavy (5+ drinks)</strong><br/>
              <span class="tiny">Party mode, multiple drinks per day</span>
            </button>
          </div>
        </div>
        
        <!-- Step 3 -->
        <div id="quiz-step-3" class="quiz-step" style="display:none;">
          <p><strong>Question 3 of 3:</strong> What's your beverage preference?</p>
          <div class="quiz-buttons">
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="cocktails">
              <strong>üçπ Cocktails</strong><br/>
              <span class="tiny">Margaritas, pi√±a coladas, mixed drinks</span>
            </button>
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="beer-wine">
              <strong>üç∫ Beer & Wine</strong><br/>
              <span class="tiny">Casual drinks, not fancy cocktails</span>
            </button>
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="coffee">
              <strong>‚òï Coffee & Specialty Drinks</strong><br/>
              <span class="tiny">Lattes, cappuccinos, mocktails</span>
            </button>
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="soda">
              <strong>ü•§ Soda & Soft Drinks</strong><br/>
              <span class="tiny">Fountain sodas, juice, no alcohol</span>
            </button>
            <button class="btn ghost quiz-answer" type="button" data-quiz-answer="nonalc">
              <strong>üö´ Non-Alcoholic Only</strong><br/>
              <span class="tiny">Soda, juice, mocktails, no alcohol</span>
            </button>
          </div>
        </div>
        
        <!-- Result -->
        <div id="quiz-result" class="quiz-step" style="display:none;">
          <div class="quiz-result-box">
            <h3 style="margin-top:0;">‚ú® Your Recommendation</h3>
            <p id="quiz-recommendation" role="status" aria-live="polite"></p>
          </div>
          <button class="btn" 
                  type="button"
                  id="quiz-apply-btn" 
                  style="width:100%;margin-top:1rem;"
                  aria-label="Apply recommended settings and calculate">Apply These Settings & Calculate</button>
        </div>
        
        <div class="quiz-footer">
          <button class="btn ghost quiz-skip" 
                  type="button"
                  id="quiz-skip-btn"
                  aria-label="Skip quiz and enter drinks manually">
            Skip quiz ‚Äî I'll enter my own drinks
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- FOOTER -->
    <footer class="wrap" role="contentinfo">
    <p>¬© 2025 In the Wake ¬∑ A Cruise Traveler's Logbook ¬∑ All rights reserved.</p>
    <p class="tiny" style="margin-top: 0.5rem;">
      <a href="/privacy.html">Privacy</a> ¬∑
      <a href="/terms.html">Terms</a> ¬∑
      <a href="/about-us.html">About</a> ¬∑
      <a href="/accessibility.html">Accessibility &amp; WCAG 2.1 AA Commitment</a>
    </p>
    <p class="tiny center" style="opacity:0;position:absolute;pointer-events:none;" aria-hidden="true">Soli Deo Gloria ‚Äî Every pixel and part of this project is offered as worship to God, in gratitude for the beautiful things He has created for us to enjoy. ‚úùÔ∏è</p>
  </footer>
  
  <!-- JAVASCRIPT - LOAD ORDER CRITICAL -->
  <!-- Math engine FIRST -->
  <script src="/assets/js/calculator-math.js?v=3.010.300"></script>
  
  <!-- Verify math loaded -->
  <script>
    if (window.ITW_MATH?.compute) {

    } else {

    }
  </script>
  
  <!-- Core engine SECOND -->
  <script src="/assets/js/calculator.js?v=3.010.300" defer></script>
  
  <!-- UI layer THIRD -->
  <script src="/assets/js/calculator-ui.js?v=3.010.300" defer></script>
  <!-- ‚úÖ NEW: Package Selection Feature -->
  <script src="/assets/js/package-selection-feature.js?v=3.010.300" defer></script>
  
  <!-- Optional: Share bar -->
  <script src="/assets/js/share-bar.js?v=3.010.300" defer></script>

  <!-- ‚úÖ CRITICAL: Robust Cache Clearing & Calculation System -->
  <script>
  (function() {
    'use strict';

    // AGGRESSIVE cache clearing - clear calculator state on EVERY load
    function aggressiveCacheClear() {
      try {
        const keysToKeep = ['itw:currency', 'itw:fx:v10']; // Keep only currency and FX rates
        const allKeys = Object.keys(localStorage);
        let cleared = 0;

        allKeys.forEach(key => {
          if (key.startsWith('itw:') && !keysToKeep.includes(key)) {
            const value = localStorage.getItem(key);
            localStorage.removeItem(key);
            cleared++;
            console.log(`[Bootstrap] ‚úó Cleared: ${key} (${value ? value.substring(0, 50) + '...' : 'empty'})`);
          }
        });

        if (cleared > 0) {

        } else {

        }
      } catch (e) {

      }
    }

    // Run aggressive cache clear IMMEDIATELY
    aggressiveCacheClear();

    // Global force calculation function
    window.FORCE_CALCULATE = function() {

      if (!window.ITW || !window.ITW.scheduleCalc) {

        setTimeout(window.FORCE_CALCULATE, 100);
        return;
      }

      // Call immediate calculation
      window.ITW.scheduleCalc();

      // Force UI render
      if (window.ITW_UI && window.ITW_UI.renderAll) {
        setTimeout(function() {

          window.ITW_UI.renderAll();
        }, 100);
      }

    };

    // Wire up reset button
    window.addEventListener('DOMContentLoaded', function() {

      const resetBtn = document.getElementById('reset-btn');
      if (resetBtn) {
        resetBtn.addEventListener('click', function() {

          // Clear all calculator localStorage
          aggressiveCacheClear();

          // Reset inputs through core
          if (window.ITW && window.ITW.resetInputs) {
            console.log('[Reset] Calling ITW.resetInputs()...');
            window.ITW.resetInputs();
          }

          // Force recalculation
          setTimeout(function() {

            window.FORCE_CALCULATE();
          }, 200);

        });

      } else {

      }
    });

    // Auto-trigger calculation after page loads
    window.addEventListener('load', function() {

      setTimeout(function() {
        if (window.ITW_BOOTED) {

          window.FORCE_CALCULATE();
        } else {

          setTimeout(function() {
            if (window.ITW_BOOTED) {
              window.FORCE_CALCULATE();
            } else {

            }
          }, 500);
        }
      }, 300);
    });

  })();
  </script>

  <script>
  (function(){
    "use strict";

    /* ===== Recent Articles Rail ===== */
    (async function recentRail(){
      const rail = document.getElementById('recent-rail');
      if(!rail) return;

      const fallback = document.getElementById('recent-rail-fallback');
      if(fallback) fallback.style.display = '';

      async function fetchJSONWithFallback(urls){
        for (const u of urls){
          try{
            const res = await fetch(u, { credentials: 'omit', cache: 'no-cache' });
            if (res.ok) return await res.json();
          }catch(err){

          }
        }
        return null;
      }

      const pick = (obj, keys, fallback=null)=>{ for(const k of keys){ if(obj && obj[k] != null) return obj[k]; } return fallback; };

      function setImageWithFallback(imgEl, primary, altPaths=[]){
        if(!imgEl) return;
        const stamp='v=3.010.300';
        const tried=new Set();
        const queue=[primary,...altPaths].filter(Boolean).map(p => p.includes('?')?p+'&'+stamp:p+'?'+stamp);
        function tryNext(){
          const next=queue.shift();
          if(!next){ imgEl.removeAttribute && imgEl.removeAttribute('onerror'); return; }
          if(tried.has(next)) return tryNext();
          tried.add(next);
          imgEl.src=next;
        }
        imgEl.onerror=tryNext;
        tryNext();
      }

      const raw = await fetchJSONWithFallback(['/assets/data/articles/index.json','/assets/data/articles.json']);
      if(!raw) {
        if(fallback) {
          fallback.textContent = 'Unable to load articles';
          fallback.style.display = '';
        }
        return;
      }

      const items = Array.isArray(raw?.articles) ? raw.articles : (Array.isArray(raw) ? raw : []);
      if(!items.length) return;

      const here = location.pathname.replace(/\/+$/,'');
      const view = items.filter(p=>{
        const href = pick(p,['url','path'],'#');
        const norm = (href||'').replace(/\/+$/,'');
        return norm && norm !== here;
      }).slice(0,6);

      rail.innerHTML = view.map(p=>{
        const title = pick(p,['title','name'],'Article');
        const href  = pick(p,['url','path'],'#');
        const excerpt = pick(p,['excerpt','description'],'');
        return `
          <article class="card" style="display:flex;flex-direction:column;gap:.75rem;padding:.85rem">
            <div style="display:grid;grid-template-columns:80px 1fr;gap:.75rem;align-items:start">
              <div style="width:80px;height:60px;overflow:hidden;border-radius:8px;background:#eef4f6;border:1px solid #dfe7ea;flex-shrink:0">
                <img class="article-thumb" alt="" decoding="async" loading="lazy" style="width:100%;height:100%;object-fit:cover">
              </div>
              <div>
                <h4 style="margin:0 0 .35rem 0;font-size:.9rem;line-height:1.3;font-weight:600">
                  <a href="\${href}" style="color:var(--accent,#0e6e8e);text-decoration:none">\${title}</a>
                </h4>
                \${excerpt ? `<p class="tiny" style="margin:0;line-height:1.4;color:var(--ink-mid,#3d5a6a)">\${excerpt}</p>` : ''}
              </div>
            </div>
            <a href="\${href}" class="pill" style="align-self:flex-start;font-size:.85rem;padding:.45rem .95rem;text-decoration:none">Read Article ‚Üí</a>
          </article>`;
      }).join('');

      const cards = [...rail.querySelectorAll('article.card')];
      cards.forEach((card,i)=>{
        const p = view[i] || {};
        const el = card.querySelector('img.article-thumb');
        const href  = (pick(p,['url','path'],'')||'').toLowerCase();
        const title = (pick(p,['title','name'],'')||'').toLowerCase();

        let primary = pick(p, ['thumb','thumbnail','image','cover','img'], null);

        // FORCE override for Top-20
        if (/(top-20|first-?cruise-?questions)/.test(href) || /top\s*20.*first.*cruise.*questions/.test(title)){
          primary = '/assets/articles/thumbs/top-20-questions/cover.webp';
        }
        // Friendly specifics
        if(!primary && (/freedom-of-your-own-wake/.test(href) || /freedom of your own wake/.test(title))){
          primary = '/assets/articles/thumbs/freedom-of-your-own-wake.webp';
        }
        if(!primary && (/why-i-started-solo-cruising/.test(href) || /why i started solo cruising/.test(title))){
          primary = '/assets/articles/thumbs/why-i-started-solo-cruising.webp';
        }
        if(!primary && (/\/travel(\.html)?$/.test(href) || /\btravel\b/.test(title))){
          primary = '/assets/articles/travel/cover.jpg';
        }

        // Heuristic fallback
        if(!primary){
          const slugify = s => (s||'').toLowerCase().replace(/https?:\/\/[^/]+/,'').replace(/[#?].*$/,'').split('/').filter(Boolean).pop()||'';
          const guess = slugify(href) || slugify(title);
          if(guess) primary = `/assets/articles/\${guess}/cover.jpg`;
        }

        const alts = [];
        if(primary){
          const base = primary.replace(/\.(jpg|jpeg|png|webp)$/i,'');
          alts.push(`\${base}.jpeg`, `\${base}.JPG`, `\${base}.webp`, `\${base}.png`);
        }
        setImageWithFallback(el, primary || '/assets/index_hero.webp', alts);
      });

      if(fallback) fallback.style.display = 'none';

      // Announce to screen readers
      const status = document.getElementById('a11y-status');
      if(status) {
        status.textContent = `\${view.length} recent articles loaded`;
      }
    })();
  })();
  </script>

<!-- Dropdown nav behavior (300ms Hover Delay) -->
  <script>
  (function(){
    "use strict";

    /* ===== Dropdown Menu with 300ms Hover Delay ===== */
    const dropdownGroups = Array.from(document.querySelectorAll('.nav-group'));
    if (dropdownGroups.length) {
      const hoverTimeouts = new Map();
      const HOVER_DELAY = 300;

      function setOpen(group, isOpen) {
        group.dataset.open = isOpen ? "true" : "false";
        const button = group.querySelector('
      }

      function closeAll(except = null) {
        dropdownGroups.forEach(group => {
          if (group !== except) {
            setOpen(group, false);
            if (hoverTimeouts.has(group)) {
              clearTimeout(hoverTimeouts.get(group));
              hoverTimeouts.delete(group);
            }
          }
        });
      }

      dropdownGroups.forEach(group => {
        const button = group.querySelector(');

        // Mouse enter: Open immediately
        group.addEventListener('mouseenter', () => {
          if (hoverTimeouts.has(group)) {
            clearTimeout(hoverTimeouts.get(group));
            hoverTimeouts.delete(group);
          }
          closeAll(group);
          setOpen(group, true);
        });

        // Mouse leave: Close after delay
        group.addEventListener('mouseleave', () => {
          const timeoutId = setTimeout(() => {
            setOpen(group, false);
            hoverTimeouts.delete(group);
          }, HOVER_DELAY);
          hoverTimeouts.set(group, timeoutId);
        });

        // Keyboard navigation
        group.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            setOpen(group, false);
            button && button.focus();
          }
          if ((e.key === 'ArrowDown' || e.key === 'ArrowUp') && document.activeElement === button) {
            e.preventDefault();
            setOpen(group, true);
            const firstLink = menu.querySelector('a, button, [tabindex]:not([tabindex="-1"])');
            firstLink && firstLink.focus();
          }
        });

        // Close when tabbing away
        menu.addEventListener('focusout', () => {
          setTimeout(() => {
            if (!group.contains(document.activeElement)) {
              setOpen(group, false);
            }
          }, 0);
        });
      });

      // Close all when clicking outside
      document.addEventListener('click', (e) => {
        if (!e.target.closest('.nav-group')) {
          closeAll();
        }
      });

      // Close all when window loses focus
      window.addEventListener('blur', () => {
        closeAll();
      });
    }
  })();
  </script>

  <!-- Load recent articles for right rail -->
  <script>
    (async function() {
      try {
        const response = await fetch('/assets/data/articles/index.json');
        const articles = await response.json();
        const rail = document.getElementById('recent-rail');

        if (rail && articles && articles.length > 0) {
          rail.innerHTML = articles.slice(0, 5).map(article => `
            <div style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid #e0e8f0;">
              <h4 style="margin: 0 0 0.25rem; font-size: 0.95rem;">
                <a href="${article.url}">${article.title}</a>
              </h4>
              <p style="margin: 0; font-size: 0.8rem; color: #666;">${article.date}</p>
            </div>
          `).join('');
        }
      } catch (err) {
        console.log('Could not load articles:', err);
      }
    })();
  </script>
  <!-- Navigation dropdown functionality -->
    <!-- Navigation dropdown functionality (New Clean Implementation) -->
  <script>
  (function() {
    'use strict';
    var dropdowns = document.querySelectorAll('.nav-dropdown');
    function toggleDropdown(dropdown) {
      var isOpen = dropdown.classList.contains('open');
      closeAllDropdowns();
      if (!isOpen) {
        dropdown.classList.add('open');
        var btn = dropdown.querySelector('button');
        if (btn) btn.setAttribute('aria-expanded', 'true');
      }
    }
    function closeAllDropdowns() {
      dropdowns.forEach(function(dd) {
        dd.classList.remove('open');
        var btn = dd.querySelector('button');
        if (btn) btn.setAttribute('aria-expanded', 'false');
      });
    }
    dropdowns.forEach(function(dropdown) {
      var btn = dropdown.querySelector('button');
      if (btn) {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          toggleDropdown(dropdown);
        });
        btn.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') { closeAllDropdowns(); btn.focus(); }
          if (e.key === 'ArrowDown') {
            e.preventDefault();
            dropdown.classList.add('open');
            btn.setAttribute('aria-expanded', 'true');
            var firstLink = dropdown.querySelector('.dropdown-menu a');
            if (firstLink) firstLink.focus();
          }
        });
      }
      var menu = dropdown.querySelector('.dropdown-menu');
      if (menu) {
        menu.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') { closeAllDropdowns(); if (btn) btn.focus(); }
        });
      }
    });
    document.addEventListener('click', function(e) {
      var isInsideDropdown = false;
      dropdowns.forEach(function(dd) { if (dd.contains(e.target)) isInsideDropdown = true; });
      if (!isInsideDropdown) closeAllDropdowns();
    });
  })();
  </script>
</body>
</html>
