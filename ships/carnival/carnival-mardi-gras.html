<!doctype html>
<!--
Soli Deo Gloria
All work on this project is offered as a gift to God.
"Trust in the LORD with all your heart, and do not lean on your own understanding." — Proverbs 3:5
"Whatever you do, work heartily, as for the Lord and not for men." — Colossians 3:23

STANDARDS: Every Page v3.010.300 · Production Template · Unified Nav v3.010.300 · A11y/WCAG 2.1 AA Compliant
-->
<html lang="en" class="no-js">
<head>
<!-- ai-breadcrumbs
     entity: Carnival Mardi Gras
     type: Ship Information Page
     parent: /ships.html
     category: Carnival Fleet
     cruise-line: Carnival Cruise Line
     ship-class: Excel Class
     siblings: Carnival Celebration, Carnival Jubilee
     related: /ships.html, /cruise-lines/carnival.html, /ports.html, /drink-calculator.html
     updated: 2025-12-02
     expertise: Carnival ship reviews, deck plans, dining analysis, cabin comparisons
     target-audience: Cruisers researching Carnival Mardi Gras or comparing Carnival ships
     answer-first: Carnival Mardi Gras is the lead Excel Class ship (180,000 GT, 5,282 guests, launched 2021) featuring BOLT roller coaster (first at sea), LNG power, and six themed zones, with deck plans, live tracking, dining venues, and video tours.
     -->
  <!-- ======================================================
       In the Wake — Carnival Mardi Gras • Carnival Cruise Line
       Version: 3.010.300  |  Soli Deo Gloria ✝️

       ✅ WCAG 2.1 Level AA Compliant
       ✅ SEO Optimized (JSON-LD, OpenGraph, Twitter Cards)
       ✅ Dropdown Menus with Hover Delay (300ms)
       ✅ AI-First SEO with E-E-A-T Person Schema
       ====================================================== -->

  <!-- Core -->
  <meta charset="utf-8"/>
  <script>document.documentElement.classList.remove('no-js');</script>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="referrer" content="no-referrer-when-downgrade"/>

  <!-- SEO: Robots & Crawling -->
  <meta name="robots" content="index,follow,max-image-preview:large,max-snippet:-1,max-video-preview:-1"/>
  <meta name="googlebot" content="index,follow"/>
  <meta name="bingbot" content="index,follow"/>

  <!-- SEO: Theme & Appearance -->
  <meta name="color-scheme" content="light"/>
  <meta name="theme-color" content="#0e6e8e"/>
  <meta name="version" content="3.010.300"/>
  <meta name="author" content="In the Wake"/>
  <meta name="publisher" content="In the Wake"/>

  <!-- ICP-Lite v1.0: AI-First Metadata -->
  <meta name="ai-summary" content="Carnival Mardi Gras: deck plans, live tracker, dining venues, and stateroom videos. Lead Excel-class ship with BOLT coaster and LNG power."/>
  <meta name="last-reviewed" content="2025-12-02"/>
  <meta name="content-protocol" content="ICP-Lite v1.0"/>

  <!-- Title & SEO -->
  <title>Carnival Mardi Gras — Deck Plans, Live Tracker, Dining & Videos | In the Wake (v3.010.300)</title>
  <link rel="canonical" href="https://cruisinginthewake.com/ships/carnival/carnival-mardi-gras.html"/>
  <meta name="description" content="Carnival Mardi Gras: deck plans, live tracker, dining venues, and stateroom videos. Plan your Carnival cruise with In the Wake."/>

  <!-- OpenGraph -->
  <meta property="og:type" content="website"/>
  <meta property="og:site_name" content="In the Wake"/>
  <meta property="og:title" content="Carnival Mardi Gras — Deck Plans, Live Tracker, Dining & Videos"/>
  <meta property="og:description" content="All the essentials for Carnival Mardi Gras: live map, dining, stats, and videos."/>
  <meta property="og:url" content="https://cruisinginthewake.com/ships/carnival/carnival-mardi-gras.html"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:image" content="https://cruisinginthewake.com/assets/ships/carnival-mardi-gras1.webp"/>

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:title" content="Carnival Mardi Gras — Deck Plans, Live Tracker, Dining & Videos"/>
  <meta name="twitter:description" content="Live tracker, dining, deck plans, and videos for Carnival Mardi Gras."/>
  <meta name="twitter:image" content="https://cruisinginthewake.com/assets/ships/carnival-mardi-gras1.webp"/>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WZP891PZXJ"></script>
  <script>
    window.dataLayer=window.dataLayer||[];
    function gtag(){dataLayer.push(arguments);}
    gtag('js',new Date());
    gtag('config','G-WZP891PZXJ',{anonymize_ip:true});
  </script>

  <!-- Umami (secondary analytics) -->
  <script defer src="https://cloud.umami.is/script.js" data-website-id="9661a449-3ba9-49ea-88e8-4493363578d2"></script>

  <!-- JSON-LD: Organization -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "In the Wake",
    "url": "https://cruisinginthewake.com",
    "logo": "https://cruisinginthewake.com/assets/logo_wake.png"
  }
  </script>

  <!-- JSON-LD: WebSite + SearchAction -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "In the Wake",
    "url": "https://cruisinginthewake.com/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://cruisinginthewake.com/search.html?q={query}",
      "query-input": "required name=query"
    }
  }
  </script>

  <!-- JSON-LD: BreadcrumbList -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://cruisinginthewake.com/"},
      {"@type": "ListItem", "position": 2, "name": "Ships", "item": "https://cruisinginthewake.com/ships.html"},
      {"@type": "ListItem", "position": 3, "name": "Carnival", "item": "https://cruisinginthewake.com/cruise-lines/carnival.html"},
      {"@type": "ListItem", "position": 4, "name": "Carnival Mardi Gras", "item": "https://cruisinginthewake.com/ships/carnival/carnival-mardi-gras.html"}
    ]
  }
  </script>

  <!-- JSON-LD: Review -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Review",
    "name": "Carnival Mardi Gras Overview",
    "author": {
      "@type": "Person",
      "name": "In the Wake Editorial Team"
    },
    "reviewBody": "Carnival Mardi Gras revolutionized cruising as the first ship with a roller coaster at sea and the first LNG-powered cruise ship in the Americas. Her six themed zones offer incredible variety.",
    "reviewRating": {
      "@type": "Rating",
      "ratingValue": 4.8,
      "bestRating": 5,
      "worstRating": 1
    },
    "itemReviewed": {
      "@type": "Cruise",
      "name": "Carnival Mardi Gras",
      "provider": {
        "@type": "Organization",
        "name": "Carnival Cruise Line",
        "url": "https://www.carnival.com"
      },
      "url": "https://cruisinginthewake.com/ships/carnival/carnival-mardi-gras.html",
      "description": "The lead Excel Class ship operated by Carnival Cruise Line, offering Caribbean cruises from Port Canaveral, Florida.",
      "image": "https://cruisinginthewake.com/assets/ships/carnival-mardi-gras1.webp"
    }
  }
  </script>

  <!-- JSON-LD: Person (E-E-A-T) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "Ken Baker",
    "url": "https://cruisinginthewake.com/authors/ken-baker.html",
    "jobTitle": "Founder and Editor",
    "description": "Traveler, pastor, and storyteller. Founder of In the Wake, a cruise traveler's logbook offering planning tools, travel tips, and faith-scented reflections for smoother sailings.",
    "image": "https://cruisinginthewake.com/authors/img/ken1.webp",
    "sameAs": ["https://www.flickersofmajesty.com"],
    "worksFor": {"@type": "Organization", "name": "In the Wake"},
    "knowsAbout": ["Cruise Planning", "Carnival Cruise Line", "Cruise Ships", "Travel Writing"]
  }
  </script>

  <!-- JSON-LD: WebPage (ICP-Lite) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "Carnival Mardi Gras — Deck Plans, Live Tracker, Dining & Videos",
    "url": "https://cruisinginthewake.com/ships/carnival/carnival-mardi-gras.html",
    "description": "Carnival Mardi Gras: deck plans, live tracker, dining venues, and stateroom videos. Plan your Carnival cruise with In the Wake."
  }
  </script>

  <!-- JSON-LD: FAQPage (ICP-Lite) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What makes Carnival Mardi Gras unique compared to other Carnival ships?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Carnival Mardi Gras is the lead Excel-class ship featuring BOLT—the first roller coaster at sea—and pioneering LNG propulsion (first in the Americas). At 180,000 GT with 5,282 guests across six themed zones, she offers unprecedented variety."
        }
      },
      {
        "@type": "Question",
        "name": "Which ships are in the same class as Carnival Mardi Gras?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Carnival Mardi Gras is the lead ship of the Excel Class, which includes Carnival Celebration (2022) and Carnival Jubilee (2023). A fourth Excel-class ship is planned for 2027."
        }
      },
      {
        "@type": "Question",
        "name": "What dining options are available on Carnival Mardi Gras?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Carnival Mardi Gras offers multiple dining venues including the main dining room, Lido Marketplace buffet, Guy's Burger Joint, BlueIguana Cantina, Emeril's Bistro 1396, Rudi's Seagrill, Fahrenheit 555 steakhouse, and Shaq's Big Chicken."
        }
      },
      {
        "@type": "Question",
        "name": "Where does Carnival Mardi Gras typically sail?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Carnival Mardi Gras operates from Port Canaveral, Florida, offering Eastern and Western Caribbean itineraries."
        }
      },
      {
        "@type": "Question",
        "name": "Does Carnival Mardi Gras have a roller coaster?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes! BOLT is the first roller coaster at sea, located atop the ship. Riders race around 800 feet of track at speeds up to 40 mph with stunning ocean views."
        }
      }
    ]
  }
  </script>

  <!-- Favicon / PWA -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/in_the_wake_icon_32x32.png"/>
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png"/>
  <link rel="manifest" href="/manifest.webmanifest"/>

  <!-- Service Worker Registration -->
  <script>
  if('serviceWorker' in navigator){
    window.addEventListener('load',()=>navigator.serviceWorker.register('/sw.js').catch(()=>{}));
  }
  </script>

  <link rel="stylesheet" href="/assets/styles.css?v=3.010.300"/>

  <!-- ===== Standards helpers (absolute URL + origin normalizer) ===== -->
  <script>
  (function(){
    const ORIGIN=(location.origin||(location.protocol+'//'+location.host)).replace(/\/$/,'');
    window._abs=function(path){ path=String(path||''); if(!path.startsWith('/')) path='/'+path; return ORIGIN+path; };

    document.addEventListener('DOMContentLoaded', function(){
      const sel=[
        'a[href^="https://cruisinginthewake.com/"]',
        'img[src^="https://cruisinginthewake.com/"]',
        'link[href^="https://cruisinginthewake.com/"]',
        'script[src^="https://cruisinginthewake.com/"]'
      ].join(',');
      document.querySelectorAll(sel).forEach(el=>{
        const attr=el.hasAttribute('href')?'href':'src';
        try{
          const u=new URL(el.getAttribute(attr));
          el.setAttribute(attr, ORIGIN+u.pathname+u.search+u.hash);
        }catch(_){}
      });
    },{once:true});
  })();
  </script>

  <!-- ===== Swiper (primary + CDN fallback) ===== -->
  <script>
  (function ensureSwiper(){
    function addCSS(h){ const l=document.createElement('link'); l.rel='stylesheet'; l.href=h; document.head.appendChild(l); }
    function addJS(src, ok, fail){
      const s=document.createElement('script'); s.src=src; s.async=true; s.onload=ok; s.onerror=fail||function(){}; document.head.appendChild(s);
    }
    const primaryCSS="https://cruisinginthewake.com/vendor/swiper/swiper-bundle.min.css";
    const primaryJS ="https://cruisinginthewake.com/vendor/swiper/swiper-bundle.min.js";
    const cdnCSS    ="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css";
    const cdnJS     ="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js";
    addCSS(primaryCSS);
    addJS(primaryJS, function(){ window.__swiperReady=true; }, function(){ addCSS(cdnCSS); addJS(cdnJS, function(){ window.__swiperReady=true; }); });
  })();
  </script>

  <!-- LCP Optimization: Preload critical hero images -->
  <link rel="preload" as="image" href="/assets/logo_wake_560.png" fetchpriority="high"/>
  <link rel="preload" as="image" href="/assets/compass_rose.svg?v=3.010.300" fetchpriority="high"/>
</head>
<body class="page">
  <!-- Skip Link -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- ARIA Live Regions -->
  <div id="a11y-status" role="status" aria-live="polite" aria-atomic="true" class="sr-only"></div>
  <div id="a11y-alerts" role="alert" aria-live="assertive" aria-atomic="true" class="sr-only"></div>

  <!-- HEADER -->
  <header class="hero-header" role="banner">
    <div class="navbar">
      <div class="brand">
        <img src="/assets/logo_wake_256.png" srcset="/assets/logo_wake_256.png 1x, /assets/logo_wake_512.png 2x" width="256" height="259" alt="In the Wake wordmark" decoding="async"/>
        <span class="tiny version-badge">v3.010.300</span>
      </div>
      <nav class="site-nav" aria-label="Main site navigation">
        <a class="nav-pill" href="/">Home</a>

        <!-- Planning Dropdown -->
        <div class="nav-dropdown" id="nav-planning">
          <button class="nav-pill" type="button" aria-expanded="false" aria-haspopup="true">
            Planning <span class="caret">&#9662;</span>
          </button>
          <div class="dropdown-menu" role="menu">
            <a href="/planning.html">Planning (overview)</a>
            <a href="/ships.html">Ships</a>
            <a href="/restaurants.html">Restaurants &amp; Menus</a>
            <a href="/ports.html">Ports</a>
            <a href="/drink-packages.html">Drink Packages</a>
            <a href="/drink-calculator.html">Drink Calculator</a>
            <a href="/stateroom-check.html">Stateroom Check</a>
            <a href="/cruise-lines.html">Cruise Lines</a>
            <a href="/packing-lists.html">Packing Lists</a>
            <a href="/accessibility.html">Accessibility</a>
          </div>
        </div>

        <!-- Travel Dropdown -->
        <div class="nav-dropdown" id="nav-travel">
          <button class="nav-pill" type="button" aria-expanded="false" aria-haspopup="true">
            Travel <span class="caret">&#9662;</span>
          </button>
          <div class="dropdown-menu" role="menu">
            <a href="/travel.html">Travel (overview)</a>
            <a href="/solo.html">Solo</a>
          </div>
        </div>

        <a class="nav-pill" href="/tools/port-tracker.html">Port Logbook</a>
        <a class="nav-pill" href="/tools/ship-tracker.html">Ship Logbook</a>
        <a class="nav-pill" href="/search.html">Search</a>
        <a class="nav-pill" href="/about-us.html">About</a>
      </nav>
    </div>

    <!-- Hero section -->
    <div class="hero" role="img" aria-label="Carnival Mardi Gras hero image">
      <div class="latlon-grid" aria-hidden="true">
        <svg viewBox="0 0 1200 400" preserveAspectRatio="none" aria-hidden="true">
          <defs>
            <pattern id="lat-grid" patternUnits="userSpaceOnUse" width="60" height="60">
              <path d="M 60 0 L 0 0 0 60" fill="none" stroke="rgba(14,110,142,.08)" stroke-width="1"/>
            </pattern>
          </defs>
          <rect width="100%" height="100%" fill="url(#lat-grid)"/>
        </svg>
      </div>
      <img class="hero-compass" src="/assets/compass_rose.svg?v=3.010.300" width="180" height="180" alt="" aria-hidden="true"/>
      <div class="hero-title">
        <img class="logo" src="/assets/logo_wake_560.png" srcset="/assets/logo_wake_560.png 1x, /assets/logo_wake_1120.png 2x" alt="In the Wake" decoding="async" fetchpriority="high" width="560" height="567"/>
        <div class="tagline">A Cruise Traveler's Logbook</div>
      </div>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main class="wrap page-grid" id="main-content" role="main" tabindex="-1" style="display: grid; grid-template-columns: 1fr; gap: 2rem; align-items: start;">
    <style>
      @media (min-width: 980px) {
        .page-grid {
          grid-template-columns: 1fr 360px !important;
        }
      }

      .author-card-vertical {
        text-align: center;
      }

      .author-card-vertical .author-avatar {
        width: 96px;
        height: 96px;
        border-radius: 50%;
        object-fit: cover;
        margin: 0 auto 1rem;
      }

      .author-card-vertical h4 {
        margin: 0.5rem 0 0.25rem;
      }

      .author-card-vertical p {
        margin: 0.25rem 0;
      }

      .rail-list {
        display: grid;
        gap: 1rem;
      }

      .grid-2 {
        display: grid;
        gap: 1rem;
        align-items: stretch;
      }

      .grid-2 > .card {
        display: flex;
        flex-direction: column;
      }

      @media (min-width: 980px) {
        .grid-2 {
          grid-template-columns: 1fr 1fr;
        }
      }

      .ship-stats.card.mini {
        margin-top: 0.6rem;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 0.4rem 0.8rem;
        font-size: 0.95rem;
      }

      .stat-line {
        display: flex;
        gap: 0.35rem;
        justify-content: space-between;
        border-bottom: 1px dashed #e4e9ec;
        padding: 0.2rem 0;
      }

      .stat-key {
        color: #355;
        font-weight: 600;
      }

      .stat-val {
        color: #024;
      }
    </style>

    <!-- Right Rail -->
    <aside class="rail" role="complementary" aria-label="Key facts, author & articles" style="grid-column: 2; grid-row: 1;">
      <!-- Quick Answer / Best For / Key Facts -->
      <section class="page-intro" style="grid-column: 1 / -1; max-width: 1100px; margin: 1rem auto 1.5rem;">
        <p class="answer-line" style="margin: 0.75rem 0; padding: 0.5rem 0.75rem; border-left: 3px solid var(--rope, #d9b382); background: #f7fdff; border-radius: 8px;">
          <strong>Quick Answer:</strong> Carnival Mardi Gras is the lead Excel-class ship. This page covers deck plans, live ship tracking, dining venues, and videos to help you plan your cruise.
        </p>

        <p class="fit-guidance" style="margin: 0.75rem 0; font-size: 0.95rem; color: #134; line-height: 1.6;">
          <strong>Best For:</strong> Cruisers researching Carnival Mardi Gras or comparing Carnival ships. Use this page to explore deck layouts, dining options, and onboard features before booking.
        </p>

        <div class="key-facts" style="margin: 1rem 0; padding: 1rem; background: #f7fdff; border-radius: 8px; border: 1px solid #e0f0f5;">
          <h3 style="margin: 0 0 0.5rem; font-size: 1rem; color: #134;">Key Facts</h3>
          <ul style="margin: 0; padding-left: 1.25rem;">
            <li><strong>Cruise Line:</strong> Carnival Cruise Line</li>
            <li><strong>Resources:</strong> Deck plans, dining venues, live tracker</li>
            <li><strong>Home Port:</strong> Port Canaveral, Florida</li>
          </ul>
        </div>
      </section>

      <!-- Author card (Vertical Layout) -->
      <section class="card author-card-vertical" aria-labelledby="author-heading">
        <h3 id="author-heading">About the Author</h3>
        <a href="/authors/ken-baker.html" aria-label="View Ken Baker's profile">
          <picture>
            <source srcset="/authors/img/ken1.webp?v=3.010.300" type="image/webp"/>
            <img class="author-avatar" src="/authors/img/ken1_96.webp" srcset="/authors/img/ken1_96.webp 1x, /authors/img/ken1_192.webp 2x" width="96" height="96" alt="Author photo" style="border-radius: 12px;" decoding="async" loading="lazy"/>
          </picture>
        </a>
        <h4><a href="/authors/ken-baker.html">Ken Baker</a></h4>
        <p class="tiny">Founder of In the Wake; writer and editor of the logbook.</p>
        <p class="tiny">
          <a href="https://www.flickersofmajesty.com" target="_blank" rel="noopener">Flickers of Majesty</a>
        </p>
      </section>

      <!-- Recent Stories rail -->
      <section class="card" aria-labelledby="recent-rail-title">
        <h3 id="recent-rail-title">Recent Stories</h3>
        <p class="tiny" style="margin-bottom: 1rem; color: var(--ink-mid, #3d5a6a); line-height: 1.5;">
          Real cruising experiences, practical guides, and heartfelt reflections from our community.
        </p>
        <div id="recent-rail" class="rail-list" aria-live="polite"></div>
        <p id="recent-rail-fallback" class="tiny" style="display:none">Loading articles…</p>
      </section>

      <!-- Whimsical Distance Units -->
      <section class="card" id="whimsical-units-container" style="background:#f7fdff;border:1px solid #e0f0f5;border-radius:12px;padding:1.25rem;">
      </section>
    </aside>

    <!-- Main Content Column -->
    <div style="grid-column: 1;">

      <!-- ICP-Lite: Page Intro -->
      <section class="page-intro" style="max-width: 1100px; margin: 1rem auto 1.5rem;" aria-label="Carnival Mardi Gras overview">
        <h1 style="font-size: clamp(1.6rem, 3vw, 2.1rem); color: var(--sea); margin: 0.75rem 0 0.5rem;">Carnival Mardi Gras — Deck Plans, Live Tracker, Dining &amp; Videos</h1>

        <p style="margin: 0.5rem 0; padding: 0.5rem 0.75rem; border-left: 3px solid var(--rope); background: #f7fdff; border-radius: 8px; font-size: 0.95rem; color: #134;">
          <strong style="display: block; font-size: 0.8rem; letter-spacing: 0.04em; text-transform: uppercase; color: #567; margin-bottom: 0.15rem;">Looking for Carnival Mardi Gras planning info?</strong>
          <span>This page covers deck plans, live ship tracking, dining venues, and video tours to help you plan your Carnival cruise aboard Carnival Mardi Gras.</span>
        </p>

        <p style="margin: 0.75rem 0; font-size: 0.95rem; color: #134; line-height: 1.6;">
          Carnival Mardi Gras tends to suit travelers who prefer Carnival's signature "Fun Ship" atmosphere with revolutionary mega-ship amenities.
          It's ideal if you want the BOLT roller coaster (first at sea), LNG-powered eco-friendly cruising, and six distinctive themed zones.
          If you're looking for a smaller or more intimate experience, you may want to explore Carnival's Spirit or Conquest class ships.
        </p>

      <!-- Row 1: First Look + Dining -->
      <section class="grid-2">
        <!-- First Look + Stats -->
        <section class="card" aria-labelledby="first-look">
          <h2 id="first-look">A First Look</h2>

          <div class="swiper firstlook" aria-label="Carnival Mardi Gras photo carousel">
            <div class="swiper-wrapper">
              <!-- 1 -->
              <div class="swiper-slide">
                <figure>
                  <img
                    src="/assets/ships/carnival-mardi-gras1.webp?v=3.010.300"
                    alt="Carnival Mardi Gras at port"
                    loading="lazy"
                    onerror="(function(i){var fb=['/assets/ships/carnival/carnival-mardi-gras/carnival-mardi-gras1.webp','/assets/ships/carnival-mardi-gras1.jpg'];i._fbi=(i._fbi||0);if(i._fbi<fb.length){i.src=fb[i._fbi++];}})(this)">
                  <figcaption class="tiny">Photo served locally (attribution in page footer).</figcaption>
                </figure>
              </div>
              <!-- 2 -->
              <div class="swiper-slide">
                <figure>
                  <img
                    src="/assets/ships/carnival-mardi-gras2.webp?v=3.010.300"
                    alt="Carnival Mardi Gras at sea"
                    loading="lazy"
                    onerror="(function(i){var fb=['/assets/ships/carnival/carnival-mardi-gras/carnival-mardi-gras2.webp','/assets/ships/carnival-mardi-gras2.jpg'];i._fbi=(i._fbi||0);if(i._fbi<fb.length){i.src=fb[i._fbi++];}})(this)">
                  <figcaption class="tiny">Photo served locally (attribution in page footer).</figcaption>
                </figure>
              </div>
              <!-- 3 -->
              <div class="swiper-slide">
                <figure>
                  <img
                    src="/assets/ships/carnival-mardi-gras3.webp?v=3.010.300"
                    alt="Carnival Mardi Gras stern view"
                    loading="lazy"
                    onerror="(function(i){var fb=['/assets/ships/carnival/carnival-mardi-gras/carnival-mardi-gras3.webp','/assets/ships/carnival-mardi-gras3.jpg'];i._fbi=(i._fbi||0);if(i._fbi<fb.length){i.src=fb[i._fbi++];}})(this)">
                  <figcaption class="tiny">Photo served locally (attribution in page footer).</figcaption>
                </figure>
              </div>
            </div>
            <div class="swiper-pagination" aria-hidden="true"></div>
            <div class="swiper-button-prev" aria-label="Previous image"></div>
            <div class="swiper-button-next" aria-label="Next image"></div>
          </div>

          <!-- Stats -->
          <section class="ship-stats card mini" aria-labelledby="statsHeading">
            <h3 id="statsHeading">Key Facts About Carnival Mardi Gras</h3>
            <div id="ship-stats" class="stats-grid" data-slug="carnival-mardi-gras"></div>
            <script type="application/json" id="ship-stats-fallback">
            {
              "slug": "carnival-mardi-gras",
              "name": "Carnival Mardi Gras",
              "class": "Excel Class (Lead Ship)",
              "entered_service": 2021,
              "gt": "180,000 GT",
              "guests": "5,282 (double) ~6,630 (max)",
              "crew": "1,735",
              "length": "1,130 ft (344 m)",
              "beam": "135 ft (41 m)",
              "registry": "Panama"
            }
            </script>
          </section>

          <!-- Sister Ships -->
          <section class="card mini carousel related-ships" aria-labelledby="related-ships">
            <h3 id="related-ships" class="card-title">Excel Class — Sister Ships</h3>
            <div class="related-pills" aria-label="Excel Class ships">
              <a class="pill" href="/ships/carnival/carnival-celebration.html">Carnival Celebration</a>
              <a class="pill" href="/ships/carnival/carnival-jubilee.html">Carnival Jubilee</a>
            </div>
            <p style="text-align:center"><a href="/ships.html" class="btn">See All Ships</a></p>
          </section>

          <!-- Ship Classes -->
          <section class="card mini carousel related-classes" aria-labelledby="related-classes">
            <h3 id="related-classes" class="card-title">Explore Carnival Classes</h3>
            <p class="small">Hop between ship classes to compare size, venues, and vibes.</p>
            <div class="class-pills">
              <a class="pill" href="/cruise-lines/carnival.html#excel-class">Excel Class</a>
              <a class="pill" href="/cruise-lines/carnival.html#vista-class">Vista Class</a>
              <a class="pill" href="/cruise-lines/carnival.html#dream-class">Dream Class</a>
              <a class="pill" href="/cruise-lines/carnival.html#conquest-class">Conquest Class</a>
              <a class="pill" href="/cruise-lines/carnival.html#spirit-class">Spirit Class</a>
            </div>
            <p style="text-align:center"><a href="/ships.html" class="btn">Browse All Ships</a></p>
          </section>
        </section>

        <!-- Dining -->
        <section id="dining-card" class="card" data-ship="Carnival Mardi Gras" aria-labelledby="diningHeading">
          <h2 id="diningHeading">Dining Venues on Carnival Mardi Gras <a href="/restaurants.html" style="font-size: 0.75rem; font-weight: 400; text-decoration: none; color: var(--accent); opacity: 0.8;" aria-label="Browse all restaurants">→ Browse All</a></h2>

          <img id="dining-hero" class="card-hero"
               src="/assets/ships/carnival/carnival-mardi-gras/dining-hero.jpg?v=3.010.300"
               alt="Carnival Mardi Gras dining venue" loading="lazy"
               onerror="(function(img){var fb=['/assets/ships/carnival-mardi-gras-dining.webp','/assets/img/Cordelia_Empress_Food_Court.webp'];img._fbi=(img._fbi||0);if(img._fbi<fb.length){img.src=fb[img._fbi++];}})(this)"/>

          <div class="dining-content" id="dining-content" aria-live="polite">
            <h3>Complimentary Dining</h3>
            <ul>
              <li><strong>Main Dining Room</strong> — Traditional multi-course dinners</li>
              <li><strong>Lido Marketplace</strong> — Buffet-style breakfast, lunch, and dinner</li>
              <li><strong>Guy's Burger Joint</strong> — Guy Fieri's famous burgers</li>
              <li><strong>BlueIguana Cantina</strong> — Fresh Mexican fare, tacos & burritos</li>
              <li><strong>Pizzeria del Capitano</strong> — 24-hour pizza</li>
            </ul>

            <h3>Specialty Dining (Additional Cost)</h3>
            <ul>
              <li><strong>Fahrenheit 555 Steakhouse</strong> — Premium steaks and seafood</li>
              <li><strong>Emeril's Bistro 1396</strong> — Emeril Lagasse's Creole-inspired cuisine</li>
              <li><strong>Rudi's Seagrill</strong> — Fresh seafood by Chef Rudi Sodamin</li>
              <li><strong>Cucina del Capitano</strong> — Italian family-style dining</li>
              <li><strong>Bonsai Sushi & Teppanyaki</strong> — Japanese cuisine</li>
              <li><strong>Shaq's Big Chicken</strong> — Shaquille O'Neal's fried chicken</li>
            </ul>
          </div>

          <script type="application/json" id="dining-data-source">{"provider":"carnival","json":"/assets/data/venues-v2.json","ship_slug":"carnival-mardi-gras","aliases":["Carnival Mardi Gras"]}</script>

          <p class="tiny">Prices can change at any time. These reflect the last sailing captured.</p>
        </section>
      </section>

      <!-- Logbook -->
      <section class="card note-kens-logbook" aria-labelledby="logbook">
        <h2 id="logbook">The Logbook — Tales From the Wake</h2>
        <div id="logbook-stories" class="prose"></div>
      </section>

      <!-- Videos -->
      <section class="card" aria-labelledby="video-highlights">
        <h2 id="video-highlights">Watch: Carnival Mardi Gras Highlights</h2>
        <p class="small">Swipe through ship walkthroughs, top-10s, and stateroom tours (including accessible where available).</p>
        <div class="swiper videos" aria-label="Featured video carousel">
          <div class="swiper-wrapper" id="featuredVideos"></div>
          <div class="swiper-pagination" aria-hidden="true"></div>
          <div class="swiper-button-prev" aria-label="Previous slide"></div>
          <div class="swiper-button-next" aria-label="Next slide"></div>
        </div>
        <div id="videoFallback" class="tiny hidden">Videos will appear once our sources sync for this ship.</div>
      </section>

      <!-- Row: Deck Plans + Live Tracker -->
      <section class="grid-2">
        <section class="card" aria-labelledby="deck-plans">
          <h2 id="deck-plans">Ship Map (Deck Plans)</h2>
          <p><a class="btn" href="https://www.carnival.com/cruise-ships/carnival-mardi-gras#deck-plans" target="_blank" rel="noopener">Open Official Deck Plans →</a></p>
          <figure>
            <img src="/assets/ship-map.png" alt="Carnival Mardi Gras simplified deck plan preview" loading="lazy"/>
          </figure>
        </section>

        <section class="card itinerary" aria-labelledby="liveTrackHeading" data-imo="9837444" data-name="CARNIVAL-MARDI-GRAS">
          <h2 id="liveTrackHeading">Where Is Mardi Gras Right Now?</h2>
          <p>See the ship's current position, speed, and next port on a live tracker.</p>

          <div id="vf-tracker-container" style="width:100%;height:500px;position:relative;"></div>
          <p class="tiny">See <a href="/ports.html">ports</a> for more information about individual ports.</p>
        </section>
      </section>

      <!-- FAQ Section (ICP-Lite) -->
      <section class="card faq" aria-labelledby="faq-heading">
        <h2 id="faq-heading">Frequently Asked Questions</h2>

        <details style="margin: 0.75rem 0; padding: 0.5rem 0; border-bottom: 1px solid var(--rope);">
          <summary style="cursor: pointer; font-weight: 600; padding: 0.5rem 0;">What makes Carnival Mardi Gras unique compared to other Carnival ships?</summary>
          <p style="margin: 0.5rem 0; padding-left: 1rem;">Carnival Mardi Gras is the lead Excel-class ship featuring BOLT—the first roller coaster at sea—and pioneering LNG propulsion (first in the Americas). At 180,000 GT with 5,282 guests across six themed zones, she offers unprecedented variety.</p>
        </details>

        <details style="margin: 0.75rem 0; padding: 0.5rem 0; border-bottom: 1px solid var(--rope);">
          <summary style="cursor: pointer; font-weight: 600; padding: 0.5rem 0;">Which ships are in the same class as Carnival Mardi Gras?</summary>
          <p style="margin: 0.5rem 0; padding-left: 1rem;">Carnival Mardi Gras is the lead ship of the <a href="/cruise-lines/carnival.html#excel-class">Excel Class</a>, which includes <a href="/ships/carnival/carnival-celebration.html">Carnival Celebration</a> (2022) and <a href="/ships/carnival/carnival-jubilee.html">Carnival Jubilee</a> (2023). A fourth Excel-class ship is planned for 2027.</p>
        </details>

        <details style="margin: 0.75rem 0; padding: 0.5rem 0; border-bottom: 1px solid var(--rope);">
          <summary style="cursor: pointer; font-weight: 600; padding: 0.5rem 0;">Does Carnival Mardi Gras have a roller coaster?</summary>
          <p style="margin: 0.5rem 0; padding-left: 1rem;">Yes! BOLT is the first roller coaster at sea, located atop the Ultimate Playground zone. Riders race around 800 feet of track at speeds up to 40 mph, 187 feet above the ocean. It's an extra-fee attraction.</p>
        </details>

        <details style="margin: 0.75rem 0; padding: 0.5rem 0; border-bottom: 1px solid var(--rope);">
          <summary style="cursor: pointer; font-weight: 600; padding: 0.5rem 0;">Where does Carnival Mardi Gras typically sail?</summary>
          <p style="margin: 0.5rem 0; padding-left: 1rem;">Carnival Mardi Gras operates from Port Canaveral, Florida, offering Eastern and Western Caribbean itineraries. Port Canaveral's proximity to Orlando makes her accessible for guests combining cruise and theme park vacations.</p>
        </details>

        <details style="margin: 0.75rem 0; padding: 0.5rem 0;">
          <summary style="cursor: pointer; font-weight: 600; padding: 0.5rem 0;">How can I see Carnival Mardi Gras's current location?</summary>
          <p style="margin: 0.5rem 0; padding-left: 1rem;">Use the <a href="#liveTrackHeading">live ship tracker</a> on this page (in the "Where Is Mardi Gras Right Now?" section) to see the ship's current position, speed, and next port in real-time.</p>
        </details>
      </section>

      <!-- Attribution -->
      <section class="card attributions">
        <h2>Image Attributions</h2>
        <ul>
          <li>
            Ship photography from <a href="https://commons.wikimedia.org/wiki/Category:Mardi_Gras_(2020_ship)" target="_blank" rel="noopener">Wikimedia Commons</a>.
            Licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener">CC BY-SA 4.0</a>.
          </li>
        </ul>
      </section>
    </div><!-- End main content column -->
  </main>

  <!-- FOOTER -->
  <footer class="wrap" role="contentinfo">
    <p>© 2025 In the Wake · A Cruise Traveler's Logbook · All rights reserved.</p>
    <p class="tiny" style="margin-top: 0.5rem;">
      <a href="/privacy.html">Privacy</a> ·
      <a href="/terms.html">Terms</a> ·
      <a href="/about-us.html">About</a> ·
      <a href="/accessibility.html">Accessibility &amp; WCAG 2.1 AA Commitment</a>
    </p>
    <p class="tiny center" style="opacity:0;position:absolute;pointer-events:none;" aria-hidden="true">Soli Deo Gloria — Every pixel and part of this project is offered as worship to God, in gratitude for the beautiful things He has created for us to enjoy. ✝️</p>
  </footer>

  <!-- ===== First Look Carousel Init ===== -->
  <script>
  (function initFirstLook(){
    function go(){
      if(!window.__swiperReady||!window.Swiper) return setTimeout(go,120);
      try{
        new Swiper('.swiper.firstlook',{
          loop:false,lazy:true,watchOverflow:true,
          pagination:{el:'.swiper.firstlook .swiper-pagination',clickable:true},
          navigation:{nextEl:'.swiper.firstlook .swiper-button-next',prevEl:'.swiper.firstlook .swiper-button-prev'},
          a11y:{enabled:true}
        });
      }catch(_){}
    }
    go();
  })();
  </script>

  <!-- ===== Logbook loader (safe absolute fetch + a11y carousel) ===== -->
  <script>
  (function initShipLogbook(){
    const mount=document.getElementById('logbook-stories'); if(!mount) return;
    function abs(p){return (window._abs?_abs(p):p);}
    function clamp(n,a,b){return Math.max(a,Math.min(b,n));}
    function getShipContext(){
      const stats=document.getElementById('ship-stats');
      const attrSlug=(stats&&stats.getAttribute('data-slug'))||'';
      const m=location.pathname.match(/\/ships\/([^/]+)\/([^/.]+)/i);
      const line=(m&&m[1])||'carnival'; const inferred=(m&&m[2])||'';
      return {line:line.toLowerCase(),slug:(attrSlug||inferred||'carnival-mardi-gras').toLowerCase()};
    }
    const ctx=getShipContext();
    const shortSlug=ctx.slug.replace('carnival-',''); const SOURCES=[abs('/ships/'+ctx.line+'/assets/'+ctx.slug+'.json'),abs('/ships/'+ctx.line+'/assets/'+shortSlug+'.json'),abs('/assets/data/logbook/'+ctx.line+'/'+ctx.slug+'.json'),abs('/assets/data/ships/'+ctx.line+'/'+ctx.slug+'.json')];
    function fetchFirst(i){i=i||0; if(i>=SOURCES.length) return Promise.resolve(null);
      return fetch(SOURCES[i],{cache:'no-store'}).then(r=>r.ok?r.json():fetchFirst(i+1)).catch(()=>fetchFirst(i+1));}
    function mdToHtml(src){let html=String(src||'').trim(); if(!html) return '';
      html=html.replace(/^###?\s+(.+)$/gm,'<h3>$1</h3>').replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>').replace(/\*(.+?)\*/g,'<em>$1</em>').replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2">$1</a>');
      html='<p>'+html.replace(/\n{2,}/g,'</p><p>').replace(/\n/g,'<br/>')+'</p>'; return html.replace(/^<p>\s*<\/p>/,'');}
    const state={i:0,items:[]};
    function renderOne(p){const title=String(p.title||p.persona_label||p.heading||'Guest Perspective').replace(/</g,'&lt;');
      const body=String(p.markdown||p.body||p.content||p.html||p.text||p.story||p.notes||'').trim(); if(!body) return '';
      return '<article class="story" aria-live="polite"><h3 tabindex="0">'+title+'</h3><div class="story-body">'+mdToHtml(body)+'</div></article>';}
    function ensureNav(){
      if(document.getElementById('logbook-nav')) return;
      const nav=document.createElement('nav'); nav.id='logbook-nav'; nav.className='logbook-nav'; nav.setAttribute('aria-label','Logbook navigation');
      const prev=document.createElement('button'); prev.type='button'; prev.className='logbook-btn logbook-prev'; prev.textContent='‹ Previous'; prev.setAttribute('aria-label','Previous story');
      const next=document.createElement('button'); next.type='button'; next.className='logbook-btn logbook-next'; next.textContent='Next ›'; next.setAttribute('aria-label','Next story');
      nav.append(prev,next); mount.before(nav);
      prev.onclick=()=>{ state.i=clamp(state.i-1,0,state.items.length-1); renderCurrent(); };
      next.onclick=()=>{ state.i=clamp(state.i+1,0,state.items.length-1); renderCurrent(); };
    }
    function renderCurrent(){
      const i=state.i,arr=state.items; if(!arr.length){mount.innerHTML='<p class="tiny">No logbook entries yet.</p>'; return;}
      const html=renderOne(arr[i]); mount.innerHTML=html;
      const nav=document.getElementById('logbook-nav'); if(!nav) return;
      nav.querySelector('.logbook-prev').disabled=(i===0);
      nav.querySelector('.logbook-next').disabled=(i===arr.length-1);
    }
    fetchFirst().then(data=>{
      if(!data) {
        mount.innerHTML='<article class="story"><h3>Carnival Mardi Gras — A Revolution at Sea</h3><div class="story-body"><p>Carnival Mardi Gras revolutionized cruising when she debuted in 2021. Named to honor the original Mardi Gras (1972), Carnival\'s very first ship, this modern namesake represents a quantum leap in cruising.</p><p>What makes Mardi Gras special? She\'s a ship of firsts: first roller coaster at sea with BOLT, first LNG-powered cruise ship in the Americas, and Carnival\'s first ship organized into six distinctive themed zones. From the French Quarter\'s jazz-filled streets to the Ultimate Playground\'s thrills, she offers unprecedented variety.</p></div></article>';
        return;
      }
      const arr=data.personas||data.perspectives||data.logbook||data.stories||data.entries||[];
      if(!arr.length) return;
      state.items=arr; state.i=0; ensureNav(); renderCurrent();
    });
  })();
  </script>

  <!-- ===== Video carousel loader ===== -->
  <script>
  (function initVideos(){
    const mount=document.getElementById('featuredVideos'); if(!mount) return;
    const fallback=document.getElementById('videoFallback');
    function abs(p){return (window._abs?_abs(p):p);}
    function getVideoURL(videoId,provider){
      if(!videoId) return null;
      if(provider==='youtube'||!provider) return 'https://www.youtube-nocookie.com/embed/'+videoId+'?rel=0&modestbranding=1';
      if(provider==='vimeo') return 'https://player.vimeo.com/video/'+videoId+'?title=0&byline=0&portrait=0';
      return null;
    }
    function renderVideos(arr){
      if(!arr||!arr.length){ if(fallback) fallback.classList.remove('hidden'); return; }
      mount.innerHTML=arr.map(v=>{
        const url=getVideoURL(v.videoId,v.provider); if(!url) return '';
        const title=String(v.title||'Carnival Mardi Gras').replace(/</g,'&lt;');
        return '<div class="swiper-slide"><iframe src="'+url+'" title="'+title+'" allow="encrypted-media" allowfullscreen loading="lazy"></iframe></div>';
      }).join('');
      if(mount.children.length&&window.__swiperReady&&window.Swiper){
        setTimeout(()=>{
          try{
            new Swiper('.swiper.videos',{
              loop:false,lazy:true,watchOverflow:true,
              pagination:{el:'.swiper.videos .swiper-pagination',clickable:true},
              navigation:{nextEl:'.swiper.videos .swiper-button-next',prevEl:'.swiper.videos .swiper-button-prev'},
              a11y:{enabled:true}
            });
          }catch(_){}
        },150);
      }
    }
    function fetchVideoData(){
      const SOURCES=[abs('/assets/data/videos/carnival/carnival-mardi-gras.json'),abs('/ships/carnival/assets/carnival-mardi-gras-videos.json')];
      function tryFetch(i){i=i||0; if(i>=SOURCES.length) return Promise.resolve(null);
        return fetch(SOURCES[i],{cache:'no-store'}).then(r=>r.ok?r.json():tryFetch(i+1)).catch(()=>tryFetch(i+1));}
      return tryFetch();
    }
    fetchVideoData().then(data=>{ if(data) renderVideos(data.videos||data); });
  })();
  </script>

  <!-- ===== Ship stats loader ===== -->
  <script>
  (function initStats(){
    const mount=document.getElementById('ship-stats'); if(!mount) return;
    const fallbackEl=document.getElementById('ship-stats-fallback');
    function abs(p){return (window._abs?_abs(p):p);}
    function renderStats(obj){
      if(!obj) return;
      const keys=['class','entered_service','gt','guests','crew','length','beam','registry'];
      const labels={class:'Class',entered_service:'Entered Service',gt:'Gross Tonnage',guests:'Guests',crew:'Crew',length:'Length',beam:'Beam',registry:'Registry'};
      mount.innerHTML=keys.map(k=>{
        const val=obj[k]; if(!val) return '';
        let statHtml = '<div class="stat-line"><span class="stat-key">'+labels[k]+'</span><span class="stat-val">'+String(val).replace(/</g,'&lt;')+'</span>';

        if((k==='length'||k==='beam') && window.funDistance){
          const feetMatch = String(val).match(/(\d+(?:,\d+)?)\s*(?:ft|feet)/i);
          if(feetMatch){
            const feet = parseInt(feetMatch[1].replace(/,/g,''));
            const conversion = k==='length' ? window.funDistance.shipLength(feet) : window.funDistance.shipBeam(feet);
            if(conversion && (conversion.practical || conversion.absurd)){
              const parts = [];
              if(conversion.practical) parts.push(conversion.practical);
              if(conversion.absurd) parts.push(conversion.absurd);
              if(parts.length > 0){
                statHtml += '<span class="stat-fun">'+parts.join(', or ')+'</span>';
              }
            }
          }
        }

        statHtml += '</div>';
        return statHtml;
      }).join('');
    }
    if(fallbackEl){
      try{ const fb=JSON.parse(fallbackEl.textContent||'{}'); if(fb) renderStats(fb); }catch(_){}
    }
    const SOURCES=[abs('/assets/data/ships/carnival-mardi-gras.json'),abs('/ships/carnival/assets/carnival-mardi-gras.json')];
    function tryFetch(i){i=i||0; if(i>=SOURCES.length) return Promise.resolve(null);
      return fetch(SOURCES[i],{cache:'no-store'}).then(r=>r.ok?r.json():tryFetch(i+1)).catch(()=>tryFetch(i+1));}
    tryFetch().then(data=>{ if(data) renderStats(data); });
  })();
  </script>

  <!-- ===== Live tracker (CruiseMapper iframe: auto-centers on ship by IMO) ===== -->
  <script>
  (function initLiveTracker(){
    const card=document.querySelector('.card.itinerary[data-imo]');
    if(!card) return;
    const imo=card.getAttribute('data-imo');
    const container=document.getElementById('vf-tracker-container');
    if(!imo||!container) return;

    const wrapper = document.createElement('div');
    wrapper.style.cssText = 'width:100%;height:500px;position:relative;background:#f0f4f8;border-radius:8px;overflow:hidden;';

    const iframe = document.createElement('iframe');
    iframe.style.cssText = 'width:100%;height:100%;border:0;';
    iframe.title = 'Live ship tracker for ' + card.getAttribute('data-name');
    iframe.setAttribute('loading', 'lazy');
    iframe.src = 'https://www.cruisemapper.com/?imo=' + imo;

    wrapper.appendChild(iframe);
    container.appendChild(wrapper);
  })();
  </script>

  <!-- ===== Recent Articles Rail ===== -->
  <script>
  (function(){
    "use strict";

    (async function recentRail(){
      const rail = document.getElementById('recent-rail');
      if(!rail) return;

      const fallback = document.getElementById('recent-rail-fallback');
      if(fallback) fallback.style.display = '';

      async function fetchJSONWithFallback(urls){
        for (const u of urls){
          try{
            const res = await fetch(u, { credentials: 'omit', cache: 'no-cache' });
            if (res.ok) return await res.json();
          }catch(err){}
        }
        return null;
      }

      const pick = (obj, keys, fallback=null)=>{ for(const k of keys){ if(obj && obj[k] != null) return obj[k]; } return fallback; };

      const raw = await fetchJSONWithFallback(['/assets/data/articles/index.json','/assets/data/articles.json']);
      if(!raw) {
        if(fallback) {
          fallback.textContent = 'Unable to load articles';
          fallback.style.display = '';
        }
        return;
      }

      const items = Array.isArray(raw?.articles) ? raw.articles : (Array.isArray(raw) ? raw : []);
      if(!items.length) return;

      const here = location.pathname.replace(/\/+$/,'');
      const view = items.filter(p=>{
        const href = pick(p,['url','path'],'#');
        const norm = (href||'').replace(/\/+$/,'');
        return norm && norm !== here;
      }).slice(0,4);

      rail.innerHTML = view.map(p=>{
        const title = pick(p,['title','name'],'Article');
        const href  = pick(p,['url','path'],'#');
        return `
          <article class="rail-article">
            <a href="${href}" style="color:var(--accent,#0e6e8e);text-decoration:none;font-weight:500">${title}</a>
          </article>`;
      }).join('');

      if(fallback) fallback.style.display = 'none';

      const status = document.getElementById('a11y-status');
      if(status) {
        status.textContent = `${view.length} recent articles loaded`;
      }
    })();
  })();
  </script>

  <!-- Navigation dropdown functionality -->
  <script>
  (function() {
    'use strict';
    var dropdowns = document.querySelectorAll('.nav-dropdown');
    function toggleDropdown(dropdown) {
      var isOpen = dropdown.classList.contains('open');
      closeAllDropdowns();
      if (!isOpen) {
        dropdown.classList.add('open');
        var btn = dropdown.querySelector('button');
        if (btn) btn.setAttribute('aria-expanded', 'true');
      }
    }
    function closeAllDropdowns() {
      dropdowns.forEach(function(dd) {
        dd.classList.remove('open');
        var btn = dd.querySelector('button');
        if (btn) btn.setAttribute('aria-expanded', 'false');
      });
    }
    dropdowns.forEach(function(dropdown) {
      var btn = dropdown.querySelector('button');
      if (btn) {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          toggleDropdown(dropdown);
        });
        btn.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') { closeAllDropdowns(); btn.focus(); }
          if (e.key === 'ArrowDown') {
            e.preventDefault();
            dropdown.classList.add('open');
            btn.setAttribute('aria-expanded', 'true');
            var firstLink = dropdown.querySelector('.dropdown-menu a');
            if (firstLink) firstLink.focus();
          }
        });
      }
      var menu = dropdown.querySelector('.dropdown-menu');
      if (menu) {
        menu.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') { closeAllDropdowns(); if (btn) btn.focus(); }
        });
      }
    });
    document.addEventListener('click', function(e) {
      var isInsideDropdown = false;
      dropdowns.forEach(function(dd) { if (dd.contains(e.target)) isInsideDropdown = true; });
      if (!isInsideDropdown) closeAllDropdowns();
    });
  })();
  </script>

  <!-- Whimsical Distance Units Script -->
  <script src="/assets/js/whimsical-port-units.js"></script>

</body>
</html>
