<!--
Soli Deo Gloria
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>

  <!-- ICP-Lite v1.0 Meta Tags -->
  <meta name="ai-summary" content="Track your cruise port visits across all cruise lines, earn achievement badges, and build your personal port collection." />
  <meta name="last-reviewed" content="2025-11-24" />
  <meta name="content-protocol" content="ICP-Lite v1.0" />

  <title>Port Logbook | In the Wake</title>
  <meta name="description" content="Track your cruise port visits across all cruise lines, earn achievement badges, and build your personal port collection!"/>
  <link rel="canonical" href="https://cruisinginthewake.com/tools/port-tracker.html"/>
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/in_the_wake_icon_32x32.png"/>
  <!-- Service Worker Registration -->
  <script>
  if('serviceWorker' in navigator){
    window.addEventListener('load',()=>navigator.serviceWorker.register('/sw.js').catch(()=>{}));
  }
  </script>

  <link rel="stylesheet" href="/assets/styles.css"/>
  <style>
    .tracker-container { max-width: 1400px; margin: 2rem auto; padding: 0 1rem; }
    .tracker-header { text-align: center; margin-bottom: 2rem; }
    .tracker-header h1 { font-size: 2.5rem; color: var(--sea, #0a3d62); margin-bottom: 0.5rem; }
    .tracker-header p { font-size: 1.1rem; color: #666; }
    
    .stats-bar { display: grid; grid-template-columns: repeat(5, 1fr); gap: 0.75rem; margin-bottom: 2rem; }
    .stat-card { background: linear-gradient(135deg, #0e6e8e 0%, #0a3d62 100%); color: white; padding: 1rem; border-radius: 10px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
    .stat-number { font-size: 1.75rem; font-weight: bold; display: block; margin-bottom: 0.25rem; }
    .stat-label { font-size: 0.8rem; opacity: 0.9; line-height: 1.2; }

    @media (max-width: 768px) {
      .stats-bar { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 0.5rem; }
      .stat-number { font-size: 1.5rem; }
      .stat-label { font-size: 0.75rem; }
    }
    
    .tracker-grid { display: grid; grid-template-columns: 250px 1fr 320px; gap: 2rem; }
    
    @media (max-width: 1024px) {
      .tracker-grid { grid-template-columns: 1fr; }
    }
    
    .filter-panel { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); position: sticky; top: 1rem; max-height: calc(100vh - 2rem); overflow-y: auto; }
    .filter-panel h3 { margin-top: 0; font-size: 1.1rem; color: var(--sea); }
    .filter-button { display: block; width: 100%; text-align: left; padding: 0.75rem 1rem; margin-bottom: 0.5rem; background: #f7fdff; border: 1px solid #e0f0f5; border-radius: 8px; cursor: pointer; transition: all 0.2s; }
    .filter-button:hover { background: #e0f0f5; }
    .filter-button.active { background: var(--sea); color: white; border-color: var(--sea); }
    
    .search-box { width: 100%; padding: 0.75rem; margin-bottom: 1rem; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; }
    
    .port-list { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .region-section { margin-bottom: 2rem; border: 1px solid #e0f0f5; border-radius: 8px; overflow: hidden; }
    .region-title { font-size: 1.3rem; color: var(--sea); margin-bottom: 0; padding: 1rem; background: linear-gradient(135deg, #f7fdff 0%, #e6f4f8 100%); cursor: pointer; user-select: none; display: flex; align-items: center; justify-content: space-between; transition: background 0.3s; }
    .region-title:hover { background: linear-gradient(135deg, #e0f0f5 0%, #d4e8ee 100%); }
    .region-title-text { flex: 1; }
    .region-progress { font-size: 0.9rem; color: #666; margin-left: 1rem; }
    .region-toggle { font-size: 1.5rem; transition: transform 0.3s; }
    .region-section.collapsed .region-toggle { transform: rotate(-90deg); }
    .region-ports { padding: 1rem; max-height: 2000px; overflow: hidden; transition: max-height 0.3s ease-out, padding 0.3s; }
    .region-section.collapsed .region-ports { max-height: 0; padding: 0 1rem; }
    
    .port-item { display: flex; align-items: center; padding: 0.75rem; margin-bottom: 0.5rem; background: #f7fdff; border-radius: 8px; cursor: pointer; transition: all 0.2s; }
    .port-item:hover { background: #e0f0f5; }
    .port-item.visited { background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%); border-left: 4px solid #28a745; }
    
    .port-checkbox { width: 24px; height: 24px; margin-right: 1rem; cursor: pointer; flex-shrink: 0; }
    .port-name { flex: 1; font-size: 1rem; color: var(--sea); text-decoration: none; font-weight: 500; }
    .port-name:hover { text-decoration: underline; }
    .port-country { font-size: 0.85rem; color: #666; margin-left: auto; }
    
    .bingo-panel { background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); position: sticky; top: 1rem; max-height: calc(100vh - 2rem); overflow-y: auto; }
    .bingo-panel h3 { margin-top: 0; font-size: 1.1rem; color: var(--sea); }
    
    .bingo-card { margin-bottom: 1.5rem; padding: 1rem; background: #f7fdff; border-radius: 8px; border: 2px solid #e0f0f5; position: relative; cursor: help; transition: all 0.3s; }
    .bingo-card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .bingo-card.completed { background: linear-gradient(135deg, #fff4e6 0%, #ffe8cc 100%); border-color: #d97706; }
    .bingo-card.completed .bingo-icon { display: inline; }

    .bingo-title { font-size: 1rem; font-weight: bold; margin-bottom: 0.5rem; color: #134; }
    .bingo-icon { display: none; margin-right: 0.5rem; }
    .bingo-progress { font-size: 0.85rem; color: #666; margin-bottom: 0.5rem; }
    .progress-bar { height: 8px; background: #e0e0e0; border-radius: 4px; overflow: hidden; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #0e6e8e 0%, #0a3d62 100%); transition: width 0.3s; }
    .bingo-card.completed .progress-fill { background: linear-gradient(90deg, #d97706 0%, #b45309 100%); }

    .bingo-tooltip { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; background: rgba(10, 61, 98, 0.95); color: white; margin-top: 0.5rem; padding: 0; border-radius: 6px; font-size: 0.8rem; line-height: 1.4; }
    .bingo-card:hover .bingo-tooltip { max-height: 200px; padding: 0.75rem; }
    
    .action-buttons { display: flex; gap: 1rem; margin-top: 2rem; flex-wrap: wrap; }
    .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; transition: all 0.2s; }
    .btn-primary { background: linear-gradient(135deg, #0e6e8e 0%, #0a3d62 100%); color: white; }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
    .btn-secondary { background: white; color: var(--sea); border: 2px solid var(--sea); }
    .btn-secondary:hover { background: #f7fdff; }
    
    .share-modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1000; align-items: center; justify-content: center; }
    .share-modal.active { display: flex; }
    .share-content { background: white; padding: 2rem; border-radius: 12px; max-width: 500px; width: 90%; }
    .share-canvas { border: 2px solid #ddd; border-radius: 8px; margin: 1rem 0; width: 100%; }
    .social-buttons { display: flex; gap: 1rem; margin-top: 1rem; }
    
    .comparison-section { background: linear-gradient(135deg, #f7fdff 0%, #e6f4f8 100%); padding: 2rem; border-radius: 12px; margin-bottom: 2rem; border: 2px solid #0e6e8e; }
    .comparison-section h2 { margin-top: 0; color: var(--sea); text-align: center; margin-bottom: 1.5rem; }
    .comparison-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; }
    .comparison-card { background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .comparison-card h3 { margin-top: 0; font-size: 1rem; color: #666; margin-bottom: 1rem; }
    .comparison-stat { font-size: 2rem; font-weight: bold; color: var(--sea); margin-bottom: 0.5rem; }
    .comparison-label { font-size: 0.9rem; color: #666; line-height: 1.5; }
    .comparison-badge { display: inline-block; padding: 0.5rem 1rem; background: linear-gradient(135deg, #d97706 0%, #b45309 100%); color: white; border-radius: 20px; font-size: 0.85rem; font-weight: bold; margin-top: 0.5rem; }
    .comparison-note { text-align: center; margin-top: 1rem; font-size: 0.85rem; color: #666; font-style: italic; }
  </style>
</head>
<body class="page">
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <!-- ARIA Live Regions -->
  <div id="a11y-status" role="status" aria-live="polite" aria-atomic="true" class="sr-only"></div>
  <div id="a11y-alerts" role="alert" aria-live="assertive" aria-atomic="true" class="sr-only"></div>

  <!-- Skip link -->
  <a class="visually-hidden" href="#content">Skip to content</a>

  <!-- Header / Hero (standard unified header) -->
  <header class="hero-header" role="banner">
    <div class="navbar">
      <div class="brand">
        <a href="/">
          <img src="/assets/logo_wake_256.png" srcset="/assets/logo_wake_256.png 1x, /assets/logo_wake_512.png 2x" width="256" height="259" alt="In the Wake wordmark" decoding="async"/>
        </a>
        <span class="tiny version-badge" aria-label="Site version 3.010.300">v3.010.300</span>
      </div>
            <nav class="site-nav" aria-label="Main site navigation">
        <a class="nav-pill" href="/">Home</a>

        <!-- Planning Dropdown -->
        <div class="nav-dropdown" id="nav-planning">
          <button class="nav-pill" type="button" aria-expanded="false" aria-haspopup="true">
            Planning <span class="caret">&#9662;</span>
          </button>
          <div class="dropdown-menu" role="menu">
            <a href="/planning.html">Planning (overview)</a>
            <a href="/ships.html">Ships</a>
            <a href="/restaurants.html">Restaurants &amp; Menus</a>
            <a href="/ports.html">Ports</a>
            <a href="/drink-packages.html">Drink Packages</a>
            <a href="/drink-calculator.html">Drink Calculator</a>
            <a href="/stateroom-check.html">Stateroom Check</a>
            <a href="/cruise-lines.html">Cruise Lines</a>
            <a href="/packing-lists.html">Packing Lists</a>
            <a href="/accessibility.html">Accessibility</a>
          </div>
        </div>

        <!-- Travel Dropdown -->
        <div class="nav-dropdown" id="nav-travel">
          <button class="nav-pill" type="button" aria-expanded="false" aria-haspopup="true">
            Travel <span class="caret">&#9662;</span>
          </button>
          <div class="dropdown-menu" role="menu">
            <a href="/travel.html">Travel (overview)</a>
            <a href="/solo.html">Solo</a>
          </div>
        </div>

        <a class="nav-pill" href="/tools/port-tracker.html">Port Tracker</a>
        <a class="nav-pill" href="/tools/ship-tracker.html">Ship Tracker</a>
        <a class="nav-pill" href="/search.html">Search</a>
        <a class="nav-pill" href="/about-us.html">About</a>
      </nav></div>

    <div class="hero" role="img" aria-label="Ship wake at sunrise">
      <div class="latlon-grid" aria-hidden="true"></div>
      <img class="hero-compass" src="/assets/compass_rose.svg?v=3.010.300" width="180" height="180" alt="" aria-hidden="true" decoding="async"/>
      <div class="hero-title">
        <img class="logo" src="/assets/logo_wake_560.png" srcset="/assets/logo_wake_560.png 1x, /assets/logo_wake_1120.png 2x" alt="In the Wake" decoding="async" fetchpriority="high" width="560" height="567"/>
      </div>
      <p class="tagline" aria-hidden="true">A Cruise Traveler's Logbook</p>
      <div class="hero-credit">
        <a class="pill" href="https://instagram.com/flickersofmajesty" target="_blank" rel="noopener">Photo ¬© Flickers of Majesty ‚Äî Instagram</a>
      </div>
    </div></header>

  <!-- Main Content -->
  <main class="wrap" id="content" tabindex="-1">
    <div class="tracker-container">
    <header class="tracker-header">
      <h1>üåç Port Logbook</h1>
      <p>Track your cruise port visits across all lines, earn achievement badges, and build your collection!</p>
    </header>
    
    <div class="stats-bar">
      <div class="stat-card">
        <span class="stat-number" id="stat-ports">0</span>
        <span class="stat-label">Ports Visited</span>
      </div>
      <div class="stat-card">
        <span class="stat-number" id="stat-percentage">0%</span>
        <span class="stat-label">of RC Ports</span>
      </div>
      <div class="stat-card">
        <span class="stat-number" id="stat-countries">0</span>
        <span class="stat-label">Countries</span>
      </div>
      <div class="stat-card">
        <span class="stat-number" id="stat-continents">0</span>
        <span class="stat-label">Continents</span>
      </div>
      <div class="stat-card">
        <span class="stat-number" id="stat-bingos">0</span>
        <span class="stat-label">Bingos Earned</span>
      </div>
    </div>

    <!-- How You Compare Section -->
    <div class="comparison-section" id="comparison-section">
      <h2>üìä How You Compare to Other Cruisers</h2>
      <div class="comparison-grid">
        <div class="comparison-card">
          <h3>Port Collector Ranking</h3>
          <div class="comparison-stat" id="compare-percentile">--</div>
          <div class="comparison-label" id="compare-label">Check some ports to see your ranking!</div>
          <div id="compare-badge"></div>
        </div>
        <div class="comparison-card">
          <h3>Average Cruiser Stats</h3>
          <div class="comparison-stat">12 ports</div>
          <div class="comparison-label">The average cruiser has visited 12 ports across 2-3 cruises. You're at <strong id="compare-vs-avg">0</strong> ports!</div>
        </div>
        <div class="comparison-card">
          <h3>Super Cruiser Club</h3>
          <div class="comparison-stat" id="compare-club">--</div>
          <div class="comparison-label" id="compare-club-label">Visit 50+ ports to join the elite Super Cruiser Club (top 5%)</div>
        </div>
        <div class="comparison-card">
          <h3>Country Explorer</h3>
          <div class="comparison-stat" id="compare-countries-stat">0</div>
          <div class="comparison-label">Average cruisers visit 6 countries. You've explored <strong id="compare-countries-count">0</strong> countries!</div>
        </div>
      </div>
      <p class="comparison-note">Rankings based on typical Royal Caribbean cruiser statistics and port visit data.</p>
    </div>
    
    <div class="tracker-grid">
      <!-- Left Sidebar: Filters -->
      <aside class="filter-panel">
        <h3>Filter by Region</h3>
        <input type="text" class="search-box" id="search-box" placeholder="Search ports...">
        <button class="filter-button active" data-region="all">üìç All Ports</button>
        <button class="filter-button" data-region="Caribbean">üèùÔ∏è Caribbean</button>
        <button class="filter-button" data-region="Alaska">‚ùÑÔ∏è Alaska</button>
        <button class="filter-button" data-region="Hawaii">üå∫ Hawaii</button>
        <button class="filter-button" data-region="Canada & New England">üçÅ Canada/New England</button>
        <button class="filter-button" data-region="Mediterranean">üèõÔ∏è Mediterranean</button>
        <button class="filter-button" data-region="Northern Europe">üõ°Ô∏è Northern Europe</button>
        <button class="filter-button" data-region="Asia">üåè Asia</button>
        <button class="filter-button" data-region="Australia & Pacific">ü¶ò Australia/Pacific</button>
        <button class="filter-button" data-region="Other">üåç Other</button>
      <!-- Recent Articles rail -->
      <section style="grid-column: 1; grid-row: 1 / span 999;" class="card" aria-labelledby="recent-rail-title">
        <h3 id="recent-rail-title">Recent Stories</h3>
        <p class="tiny" style="margin-bottom: 1rem; color: var(--ink-mid, #3d5a6a); line-height: 1.5;">
          Real cruising experiences, practical guides, and heartfelt reflections from our community. Explore stories that inform, inspire, and connect.
        </p>
        <div id="recent-rail" class="rail-list" aria-live="polite"></div>
        <p id="recent-rail-fallback" class="tiny" style="display:none">Loading articles‚Ä¶</p>
      </section>
    
      </aside>
      
      <!-- Center: Port List -->
      <main class="port-list" id="port-list">
        <!-- Dynamically populated -->
      </main>
      
      <!-- Right Sidebar: Bingo Cards -->
      <aside class="bingo-panel">
        <h3>üèÜ Achievement Bingos</h3>
        <div id="bingo-cards">
          <!-- Dynamically populated -->
        </div>
      </aside>
    </div>
    
    <div class="action-buttons">
      <button class="btn btn-primary" id="share-btn">üì§ Share Image</button>
      <button class="btn btn-primary" id="copy-link-btn">üîó Copy Share Link</button>
      <button class="btn btn-secondary" id="export-btn">üíæ Export Data</button>
      <button class="btn btn-secondary" id="import-btn">üì• Import Data</button>
      <button class="btn btn-secondary" id="reset-btn">üîÑ Reset All</button>
    </div>
  </div>
  
  <!-- Share Modal -->
  <div class="share-modal" id="share-modal">
    <div class="share-content">
      <h2>Share Your Cruise Stats</h2>
      <canvas id="share-canvas" class="share-canvas" width="600" height="400"></canvas>
      <div class="social-buttons">
        <button class="btn btn-primary" id="download-btn">Download Image</button>
        <button class="btn btn-secondary" id="close-modal-btn">Close</button>
      </div>
    </div>
  </div>
  
  <input type="file" id="import-file" accept=".json" style="display:none;">
  
  <script>
// Port Tracker App
(function() {
  'use strict';
  
  // Port database - all 142 ports with metadata and URLs
  const PORTS_DB = [
  {
    "id": "ajaccio",
    "name": "Ajaccio",
    "country": "France",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/ajaccio.html"
  },
  {
    "id": "alesund",
    "name": "\u00c5lesund",
    "country": "Norway",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/alesund.html"
  },
  {
    "id": "amalfi",
    "name": "Amalfi",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/amalfi.html"
  },
  {
    "id": "amsterdam",
    "name": "Amsterdam",
    "country": "Netherlands",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/amsterdam.html"
  },
  {
    "id": "aruba",
    "name": "Aruba",
    "country": "Aruba",
    "region": "Caribbean",
    "continent": "South America",
    "url": "/ports/aruba.html"
  },
  {
    "id": "athens",
    "name": "Athens",
    "country": "Greece",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/athens.html"
  },
  {
    "id": "auckland",
    "name": "Auckland",
    "country": "New Zealand",
    "region": "Australia & Pacific",
    "continent": "Oceania",
    "url": "/ports/auckland.html"
  },
  {
    "id": "bali",
    "name": "Bali",
    "country": "Indonesia",
    "region": "Asia",
    "continent": "Asia",
    "url": "/ports/bali.html"
  },
  {
    "id": "bangkok",
    "name": "Bangkok",
    "country": "Thailand",
    "region": "Asia",
    "continent": "Asia",
    "url": "/ports/bangkok.html"
  },
  {
    "id": "bar-harbor",
    "name": "Bar Harbor",
    "country": "United States",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/bar-harbor.html"
  },
  {
    "id": "barcelona",
    "name": "Barcelona",
    "country": "Spain",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/barcelona.html"
  },
  {
    "id": "belfast",
    "name": "Belfast",
    "country": "Northern Ireland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/belfast.html"
  },
  {
    "id": "belize",
    "name": "Belize City",
    "country": "Belize",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/belize.html"
  },
  {
    "id": "bergen",
    "name": "Bergen",
    "country": "Norway",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/bergen.html"
  },
  {
    "id": "bermuda",
    "name": "Bermuda",
    "country": "Bermuda",
    "region": "Other",
    "continent": "North America",
    "url": "/ports/bermuda.html"
  },
  {
    "id": "bilbao",
    "name": "Bilbao",
    "country": "Spain",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/bilbao.html"
  },
  {
    "id": "bonaire",
    "name": "Bonaire",
    "country": "Bonaire",
    "region": "Caribbean",
    "continent": "South America",
    "url": "/ports/bonaire.html"
  },
  {
    "id": "bordeaux",
    "name": "Bordeaux",
    "country": "France",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/bordeaux.html"
  },
  {
    "id": "boston",
    "name": "Boston",
    "country": "United States",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/boston.html"
  },
  {
    "id": "brisbane",
    "name": "Brisbane",
    "country": "Australia",
    "region": "Australia & Pacific",
    "continent": "Oceania",
    "url": "/ports/brisbane.html"
  },
  {
    "id": "cadiz",
    "name": "C\u00e1diz",
    "country": "Spain",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/cadiz.html"
  },
  {
    "id": "cagliari",
    "name": "Cagliari",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/cagliari.html"
  },
  {
    "id": "cannes",
    "name": "Cannes",
    "country": "France",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/cannes.html"
  },
  {
    "id": "cartagena-spain",
    "name": "Cartagena",
    "country": "Spain",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/cartagena-spain.html"
  },
  {
    "id": "cartagena",
    "name": "Cartagena",
    "country": "Colombia",
    "region": "Caribbean",
    "continent": "South America",
    "url": "/ports/cartagena.html"
  },
  {
    "id": "casablanca",
    "name": "Casablanca",
    "country": "Morocco",
    "region": "Other",
    "continent": "Africa",
    "url": "/ports/casablanca.html"
  },
  {
    "id": "charlottetown",
    "name": "Charlottetown",
    "country": "Canada",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/charlottetown.html"
  },
  {
    "id": "cherbourg",
    "name": "Cherbourg",
    "country": "France",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/cherbourg.html"
  },
  {
    "id": "civitavecchia",
    "name": "Rome (Civitavecchia)",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/civitavecchia.html"
  },
  {
    "id": "cococay",
    "name": "Perfect Day at CocoCay",
    "country": "Bahamas",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/cococay.html"
  },
  {
    "id": "copenhagen",
    "name": "Copenhagen",
    "country": "Denmark",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/copenhagen.html"
  },
  {
    "id": "corfu",
    "name": "Corfu",
    "country": "Greece",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/corfu.html"
  },
  {
    "id": "cork",
    "name": "Cork (Cobh)",
    "country": "Ireland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/cork.html"
  },
  {
    "id": "costa-maya",
    "name": "Costa Maya",
    "country": "Mexico",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/costa-maya.html"
  },
  {
    "id": "cozumel",
    "name": "Cozumel",
    "country": "Mexico",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/cozumel.html"
  },
  {
    "id": "curacao",
    "name": "Cura\u00e7ao",
    "country": "Cura\u00e7ao",
    "region": "Caribbean",
    "continent": "South America",
    "url": "/ports/curacao.html"
  },
  {
    "id": "dominica",
    "name": "Dominica",
    "country": "Dominica",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/dominica.html"
  },
  {
    "id": "dover",
    "name": "Dover",
    "country": "England",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/dover.html"
  },
  {
    "id": "dublin",
    "name": "Dublin",
    "country": "Ireland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/dublin.html"
  },
  {
    "id": "dubrovnik",
    "name": "Dubrovnik",
    "country": "Croatia",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/dubrovnik.html"
  },
  {
    "id": "gdansk",
    "name": "Gdansk",
    "country": "Poland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/gdansk.html"
  },
  {
    "id": "genoa",
    "name": "Genoa",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/genoa.html"
  },
  {
    "id": "gibraltar",
    "name": "Gibraltar",
    "country": "UK",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/gibraltar.html"
  },
  {
    "id": "glacier-bay",
    "name": "Glacier Bay",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/glacier-bay.html"
  },
  {
    "id": "gothenburg",
    "name": "Gothenburg",
    "country": "Sweden",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/gothenburg.html"
  },
  {
    "id": "grand-cayman",
    "name": "Grand Cayman",
    "country": "Cayman Islands",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/grand-cayman.html"
  },
  {
    "id": "grand-turk",
    "name": "Grand Turk",
    "country": "Turks & Caicos",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/grand-turk.html"
  },
  {
    "id": "grenada",
    "name": "Grenada",
    "country": "Grenada",
    "region": "Caribbean",
    "continent": "South America",
    "url": "/ports/grenada.html"
  },
  {
    "id": "guadeloupe",
    "name": "Guadeloupe",
    "country": "Guadeloupe",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/guadeloupe.html"
  },
  {
    "id": "haines",
    "name": "Haines",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/haines.html"
  },
  {
    "id": "halifax",
    "name": "Halifax",
    "country": "Canada",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/halifax.html"
  },
  {
    "id": "helsinki",
    "name": "Helsinki",
    "country": "Finland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/helsinki.html"
  },
  {
    "id": "heraklion",
    "name": "Heraklion (Crete)",
    "country": "Greece",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/heraklion.html"
  },
    {
    "id": "hilo",
    "name": "Hilo",
    "country": "United States",
    "region": "Hawaii",
    "continent": "North America",
    "url": "/ports/hilo.html"
  },
  {
  {
    "id": "holyhead",
    "name": "Holyhead",
    "country": "Wales",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/holyhead.html"
  },
    {
    "id": "honolulu",
    "name": "Honolulu",
    "country": "United States",
    "region": "Hawaii",
    "continent": "North America",
    "url": "/ports/honolulu.html"
  },
  {
  {
    "id": "honfleur",
    "name": "Honfleur",
    "country": "France",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/honfleur.html"
  },
  {
    "id": "hong-kong",
    "name": "Hong Kong",
    "country": "Hong Kong",
    "region": "Asia",
    "continent": "Asia",
    "url": "/ports/hong-kong.html"
  },
  {
    "id": "ibiza",
    "name": "Ibiza",
    "country": "Spain",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/ibiza.html"
  },
  {
    "id": "icy-strait-point",
    "name": "Icy Strait Point",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/icy-strait-point.html"
  },
  {
    "id": "invergordon",
    "name": "Invergordon",
    "country": "Scotland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/invergordon.html"
  },
  {
    "id": "jamaica",
    "name": "Jamaica",
    "country": "Jamaica",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/jamaica.html"
  },
  {
    "id": "juneau",
    "name": "Juneau",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/juneau.html"
  },
  {
    "id": "ketchikan",
    "name": "Ketchikan",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/ketchikan.html"
  },
  {
    "id": "key-west",
    "name": "Key West",
    "country": "United States",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/key-west.html"
  },
  {
    "id": "kiel",
    "name": "Kiel",
    "country": "Germany",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/kiel.html"
  },
  {
    "id": "kirkwall",
    "name": "Kirkwall",
    "country": "Scotland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/kirkwall.html"
  },
  {
    "id": "koper",
    "name": "Koper",
    "country": "Slovenia",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/koper.html"
  },
    {
    "id": "kona",
    "name": "Kailua-Kona",
    "country": "United States",
    "region": "Hawaii",
    "continent": "North America",
    "url": "/ports/kona.html"
  },
  {
  {
    "id": "kotor",
    "name": "Kotor",
    "country": "Montenegro",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/kotor.html"
  },
  {
    "id": "kusadasi",
    "name": "Kusadasi (Ephesus)",
    "country": "Turkey",
    "region": "Mediterranean",
    "continent": "Asia",
    "url": "/ports/kusadasi.html"
  },
  {
    "id": "la-coruna",
    "name": "La Coru\u00f1a",
    "country": "Spain",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/la-coruna.html"
  },
  {
    "id": "labadee",
    "name": "Labadee",
    "country": "Haiti",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/labadee.html"
  },
  {
    "id": "le-havre",
    "name": "Le Havre (Paris)",
    "country": "France",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/le-havre.html"
  },
  {
    "id": "lerwick",
    "name": "Lerwick",
    "country": "Scotland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/lerwick.html"
  },
  {
    "id": "lisbon",
    "name": "Lisbon",
    "country": "Portugal",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/lisbon.html"
  },
  {
    "id": "liverpool",
    "name": "Liverpool",
    "country": "England",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/liverpool.html"
  },
  {
    "id": "livorno",
    "name": "Livorno (Florence)",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/livorno.html"
  },
  {
    "id": "malaga",
    "name": "M\u00e1laga",
    "country": "Spain",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/malaga.html"
  },
  {
    "id": "marseille",
    "name": "Marseille",
    "country": "France",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/marseille.html"
  },
  {
    "id": "martinique",
    "name": "Martinique",
    "country": "Martinique",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/martinique.html"
  },
    {
    "id": "maui",
    "name": "Maui (Kahului)",
    "country": "United States",
    "region": "Hawaii",
    "continent": "North America",
    "url": "/ports/maui.html"
  },
  {
  {
    "id": "messina",
    "name": "Messina",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/messina.html"
  },
  {
    "id": "monte-carlo",
    "name": "Monte Carlo",
    "country": "Monaco",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/monte-carlo.html"
  },
  {
    "id": "mykonos",
    "name": "Mykonos",
    "country": "Greece",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/mykonos.html"
  },
    {
    "id": "nawiliwili",
    "name": "Nawiliwili",
    "country": "United States",
    "region": "Hawaii",
    "continent": "North America",
    "url": "/ports/nawiliwili.html"
  },
  {
  {
    "id": "naples",
    "name": "Naples",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/naples.html"
  },
  {
    "id": "nassau",
    "name": "Nassau",
    "country": "Bahamas",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/nassau.html"
  },
  {
    "id": "newcastle",
    "name": "Newcastle",
    "country": "England",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/newcastle.html"
  },
  {
    "id": "newport",
    "name": "Newport",
    "country": "United States",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/newport.html"
  },
  {
    "id": "norwegian-fjords",
    "name": "Norwegian Fjords",
    "country": "Norway",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/norwegian-fjords.html"
  },
  {
    "id": "oslo",
    "name": "Oslo",
    "country": "Norway",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/oslo.html"
  },
  {
    "id": "palma",
    "name": "Palma de Mallorca",
    "country": "Spain",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/palma.html"
  },
  {
    "id": "panama-canal",
    "name": "Panama Canal",
    "country": "Panama",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/panama-canal.html"
  },
  {
    "id": "portland-maine",
    "name": "Portland, Maine",
    "country": "United States",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/portland-maine.html"
  },
  {
    "id": "portland",
    "name": "Portland (Dorset)",
    "country": "England",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/portland.html"
  },
  {
    "id": "porto",
    "name": "Porto",
    "country": "Portugal",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/porto.html"
  },
  {
    "id": "progreso",
    "name": "Progreso",
    "country": "Mexico",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/progreso.html"
  },
  {
    "id": "quebec-city",
    "name": "Quebec City",
    "country": "Canada",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/quebec-city.html"
  },
  {
    "id": "ravenna",
    "name": "Ravenna",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/ravenna.html"
  },
  {
    "id": "reykjavik",
    "name": "Reykjavik",
    "country": "Iceland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/reykjavik.html"
  },
  {
    "id": "rhodes",
    "name": "Rhodes",
    "country": "Greece",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/rhodes.html"
  },
  {
    "id": "riga",
    "name": "Riga",
    "country": "Latvia",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/riga.html"
  },
  {
    "id": "roatan",
    "name": "Roatan",
    "country": "Honduras",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/roatan.html"
  },
  {
    "id": "saguenay",
    "name": "Saguenay",
    "country": "Canada",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/saguenay.html"
  },
  {
    "id": "saint-john",
    "name": "Saint John",
    "country": "Canada",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/saint-john.html"
  },
  {
    "id": "samana",
    "name": "Saman\u00e1",
    "country": "Dominican Republic",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/samana.html"
  },
  {
    "id": "san-juan",
    "name": "San Juan",
    "country": "Puerto Rico",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/san-juan.html"
  },
  {
    "id": "santorini",
    "name": "Santorini",
    "country": "Greece",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/santorini.html"
  },
  {
    "id": "scotland",
    "name": "Scotland",
    "country": "UK",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/scotland.html"
  },
  {
    "id": "seward",
    "name": "Seward",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/seward.html"
  },
  {
    "id": "shanghai",
    "name": "Shanghai",
    "country": "China",
    "region": "Asia",
    "continent": "Asia",
    "url": "/ports/shanghai.html"
  },
  {
    "id": "singapore",
    "name": "Singapore",
    "country": "Singapore",
    "region": "Asia",
    "continent": "Asia",
    "url": "/ports/singapore.html"
  },
  {
    "id": "sitka",
    "name": "Sitka",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/sitka.html"
  },
  {
    "id": "skagway",
    "name": "Skagway",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/skagway.html"
  },
  {
    "id": "south-pacific",
    "name": "South Pacific",
    "country": "Pacific Islands",
    "region": "Australia & Pacific",
    "continent": "Oceania",
    "url": "/ports/south-pacific.html"
  },
  {
    "id": "southampton",
    "name": "Southampton",
    "country": "UK",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/southampton.html"
  },
  {
    "id": "split",
    "name": "Split",
    "country": "Croatia",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/split.html"
  },
  {
    "id": "st-kitts",
    "name": "St. Kitts",
    "country": "St. Kitts & Nevis",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/st-kitts.html"
  },
  {
    "id": "st-maarten",
    "name": "Sint Maarten",
    "country": "Sint Maarten",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/st-maarten.html"
  },
  {
    "id": "st-petersburg",
    "name": "St. Petersburg",
    "country": "Russia",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/st-petersburg.html"
  },
  {
    "id": "st-thomas",
    "name": "St. Thomas",
    "country": "US Virgin Islands",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/st-thomas.html"
  },
  {
    "id": "stavanger",
    "name": "Stavanger",
    "country": "Norway",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/stavanger.html"
  },
  {
    "id": "stockholm",
    "name": "Stockholm",
    "country": "Sweden",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/stockholm.html"
  },
  {
    "id": "sydney-ns",
    "name": "Sydney, Nova Scotia",
    "country": "Canada",
    "region": "Canada & New England",
    "continent": "North America",
    "url": "/ports/sydney-ns.html"
  },
  {
    "id": "sydney",
    "name": "Sydney",
    "country": "Australia",
    "region": "Australia & Pacific",
    "continent": "Oceania",
    "url": "/ports/sydney.html"
  },
  {
    "id": "tallinn",
    "name": "Tallinn",
    "country": "Estonia",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/tallinn.html"
  },
  {
    "id": "tangier",
    "name": "Tangier",
    "country": "Morocco",
    "region": "Other",
    "continent": "Africa",
    "url": "/ports/tangier.html"
  },
  {
    "id": "taormina",
    "name": "Taormina",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/taormina.html"
  },
  {
    "id": "tokyo",
    "name": "Tokyo",
    "country": "Japan",
    "region": "Asia",
    "continent": "Asia",
    "url": "/ports/tokyo.html"
  },
  {
    "id": "tortola",
    "name": "Tortola",
    "country": "British Virgin Islands",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/tortola.html"
  },
  {
    "id": "tracy-arm",
    "name": "Tracy Arm Fjord",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/tracy-arm.html"
  },
  {
    "id": "trieste",
    "name": "Trieste",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/trieste.html"
  },
  {
    "id": "tromso",
    "name": "Troms\u00f8",
    "country": "Norway",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/tromso.html"
  },
  {
    "id": "tunis",
    "name": "Tunis",
    "country": "Tunisia",
    "region": "Other",
    "continent": "Africa",
    "url": "/ports/tunis.html"
  },
  {
    "id": "valencia",
    "name": "Valencia",
    "country": "Spain",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/valencia.html"
  },
  {
    "id": "valletta",
    "name": "Valletta",
    "country": "Malta",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/valletta.html"
  },
  {
    "id": "venice",
    "name": "Venice",
    "country": "Italy",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/venice.html"
  },
  {
    "id": "victoria-bc",
    "name": "Victoria, BC",
    "country": "Canada",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/victoria-bc.html"
  },
  {
    "id": "vigo",
    "name": "Vigo",
    "country": "Spain",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/vigo.html"
  },
  {
    "id": "villefranche",
    "name": "Villefranche (Nice)",
    "country": "France",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/villefranche.html"
  },
  {
    "id": "virgin-gorda",
    "name": "Virgin Gorda",
    "country": "British Virgin Islands",
    "region": "Caribbean",
    "continent": "North America",
    "url": "/ports/virgin-gorda.html"
  },
  {
    "id": "warnemunde",
    "name": "Warnem\u00fcnde (Berlin)",
    "country": "Germany",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/warnemunde.html"
  },
  {
    "id": "waterford",
    "name": "Waterford",
    "country": "Ireland",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/waterford.html"
  },
  {
    "id": "whittier",
    "name": "Whittier",
    "country": "United States",
    "region": "Alaska",
    "continent": "North America",
    "url": "/ports/whittier.html"
  },
  {
    "id": "zadar",
    "name": "Zadar",
    "country": "Croatia",
    "region": "Mediterranean",
    "continent": "Europe",
    "url": "/ports/zadar.html"
  },
  {
    "id": "zeebrugge",
    "name": "Zeebrugge (Brussels)",
    "country": "Belgium",
    "region": "Northern Europe",
    "continent": "Europe",
    "url": "/ports/zeebrugge.html"
  }
];
  
  // Bingo card definitions
  const BINGO_CARDS = [
    { id: 'abc-islands', name: 'üé® ABC Islands', ports: ['aruba', 'bonaire', 'curacao'], howTo: 'Collect this badge by visiting all 3 ABC Islands (Aruba, Bonaire, and Cura√ßao)!' },
    { id: 'western-caribbean', name: 'üå¥ Western Caribbean', ports: ['cozumel', 'costa-maya', 'roatan', 'belize', 'grand-cayman', 'jamaica', 'progreso', 'grand-turk'], howTo: 'Collect this badge by visiting all major Western Caribbean ports!' },
    { id: 'eastern-caribbean', name: '‚õµ Eastern Caribbean', ports: ['st-thomas', 'st-maarten', 'san-juan', 'st-kitts', 'tortola', 'dominica', 'samana', 'martinique'], howTo: 'Collect this badge by visiting all major Eastern Caribbean ports!' },
    { id: 'southern-caribbean', name: 'üåä Southern Caribbean', ports: ['aruba', 'curacao', 'grenada', 'bonaire', 'cartagena', 'guadeloupe'], howTo: 'Collect this badge by visiting all Southern Caribbean gems!' },
    { id: 'private-islands', name: 'üèñÔ∏è Private Islands', ports: ['cococay', 'labadee'], howTo: 'Collect this badge by visiting both Royal Caribbean private islands!' },
    { id: 'alaska', name: '‚ùÑÔ∏è Alaska Complete', ports: ['juneau', 'skagway', 'sitka', 'ketchikan', 'icy-strait-point', 'haines', 'seward', 'whittier', 'glacier-bay', 'tracy-arm', 'victoria-bc'], howTo: 'Collect this badge by visiting all major Alaskan ports and scenic cruising areas!' },
    { id: 'hawaii', name: 'üå∫ Hawaiian Islands', ports: ['honolulu', 'kona', 'hilo', 'maui', 'nawiliwili'], howTo: 'Collect this badge by visiting all Hawaiian island ports!' },
    { id: 'canada-ne', name: 'üçÅ Canada/New England', ports: ['bar-harbor', 'portland-maine', 'boston', 'newport', 'quebec-city', 'halifax', 'charlottetown', 'saint-john', 'saguenay', 'sydney-ns'], howTo: 'Collect this badge by visiting all Canada & New England ports!' },
    { id: 'greek-isles', name: 'üóø Greek Isles Master', ports: ['santorini', 'mykonos', 'rhodes', 'corfu', 'heraklion'], howTo: 'Collect this badge by visiting all major Greek island ports!' },
    { id: 'italian-coast', name: 'üçï Italian Coastline', ports: ['venice', 'civitavecchia', 'naples', 'livorno', 'messina', 'taormina', 'ravenna', 'trieste'], howTo: 'Collect this badge by visiting all major Italian coastal ports!' },
    { id: 'norwegian-fjords', name: 'üåâ Norwegian Fjords', ports: ['bergen', 'alesund', 'stavanger', 'norwegian-fjords'], howTo: 'Collect this badge by visiting all Norwegian fjord ports!' },
    { id: 'british-isles', name: 'üè∞ British Isles', ports: ['liverpool', 'dublin', 'cork', 'belfast', 'scotland', 'invergordon', 'kirkwall', 'lerwick', 'holyhead', 'waterford', 'newcastle', 'dover', 'portland'], howTo: 'Collect this badge by visiting all British Isles ports!' },
    { id: 'port-hopper', name: 'üóΩ Port Hopper (25 ports)', ports: [], min: 25, howTo: 'Collect this badge by visiting any 25 ports!' },
    { id: 'world-cruiser', name: 'üåç World Cruiser (50 ports)', ports: [], min: 50, howTo: 'Collect this badge by visiting any 50 ports!' },
    { id: 'ultimate', name: 'üëë Ultimate Cruiser (100 ports)', ports: [], min: 100, howTo: 'Collect this badge by visiting 100 or more ports - the ultimate achievement!' }
  ];
  
  // App state
  let visitedPorts = new Set(JSON.parse(localStorage.getItem('visited-ports') || '[]'));
  let currentFilter = 'all';

  // Analytics tracking helper
  function trackEvent(eventName, params = {}) {
    if (typeof gtag !== 'undefined') {
      gtag('event', eventName, params);
    }
    // Also log to console in development
    console.log('[Analytics]', eventName, params);
  }
  
  // Initialize app
  function init() {
    // Track page view
    if (typeof gtag !== 'undefined') {
      gtag('event', 'page_view', {
        page_title: 'Port Tracker',
        page_location: window.location.href
      });
    }
    renderPortList();
    renderBingoCards();
    updateStats();
    attachEventListeners();
  }
  
  // Render port list with CLICKABLE LINKS
  function renderPortList() {
    const portList = document.getElementById('port-list');
    const searchTerm = document.getElementById('search-box').value.toLowerCase();
    
    // Group ports by region
    const regions = {};
    PORTS_DB.forEach(port => {
      if (!regions[port.region]) regions[port.region] = [];
      regions[port.region].push(port);
    });
    
    portList.innerHTML = '';
    
    Object.keys(regions).sort().forEach(region => {
      if (currentFilter !== 'all' && currentFilter !== region) return;
      
      const ports = regions[region].filter(p => 
        p.name.toLowerCase().includes(searchTerm) ||
        p.country.toLowerCase().includes(searchTerm)
      );
      
      if (ports.length === 0) return;
      
      const visited = ports.filter(p => visitedPorts.has(p.id)).length;
      const total = ports.length;
      
      const section = document.createElement('div');
      section.className = 'region-section collapsed';
      section.innerHTML = `
        <div class="region-title" onclick="toggleSection(this)">
          <div class="region-title-text">
            ${region}
            <span class="region-progress">${visited}/${total} visited</span>
          </div>
          <span class="region-toggle">‚ñº</span>
        </div>
        <div class="region-ports">
      `;
      
      ports.forEach(port => {
        const item = document.createElement('div');
        item.className = 'port-item' + (visitedPorts.has(port.id) ? ' visited' : '');
        item.innerHTML = `
          <input type="checkbox" class="port-checkbox" data-port="${port.id}" 
                 ${visitedPorts.has(port.id) ? 'checked' : ''}>
          <a href="${port.url}" class="port-name" target="_blank" onclick="trackEvent('port_link_clicked', {port_id: '${port.id}', port_name: '${port.name}'})">${port.name}</a>
          <span class="port-country">${port.country}</span>
        `;
        section.querySelector('.region-ports').appendChild(item);
      });

      section.innerHTML += '</div>';
      portList.appendChild(section);
    });
  }
  
  // Render bingo cards
  function renderBingoCards() {
    const container = document.getElementById('bingo-cards');
    container.innerHTML = '';

    // Calculate completion for all cards first for sorting
    const cardsWithCompletion = BINGO_CARDS.map(card => {
      let completed = 0;
      let total = 0;

      if (card.min) {
        total = card.min;
        completed = Math.min(visitedPorts.size, total);
      } else {
        total = card.ports.length;
        completed = card.ports.filter(p => visitedPorts.has(p)).length;
      }

      const percentage = total > 0 ? (completed / total * 100) : 0;
      const isCompleted = completed >= total;

      return { card, completed, total, percentage, isCompleted };
    });

    // Sort: completed first, then by percentage descending
    cardsWithCompletion.sort((a, b) => {
      if (a.isCompleted && !b.isCompleted) return -1;
      if (!a.isCompleted && b.isCompleted) return 1;
      return b.percentage - a.percentage;
    });

    cardsWithCompletion.forEach(({ card, completed, total, percentage, isCompleted }) => {
      
      // Track bingo completion (only track once per bingo)
      const wasCompleted = sessionStorage.getItem(`bingo_${card.id}_completed`);
      if (isCompleted && !wasCompleted) {
        trackEvent('bingo_completed', {
          bingo_id: card.id,
          bingo_name: card.name,
          total_bingos: BINGO_CARDS.filter(c => {
            if (c.min) return visitedPorts.size >= c.min;
            return c.ports.every(p => visitedPorts.has(p));
          }).length
        });
        sessionStorage.setItem(`bingo_${card.id}_completed`, 'true');
      } else if (!isCompleted && wasCompleted) {
        sessionStorage.removeItem(`bingo_${card.id}_completed`);
      }
      
      const cardEl = document.createElement('div');
      cardEl.className = 'bingo-card' + (isCompleted ? ' completed' : '');
      cardEl.innerHTML = `
        <div class="bingo-title">
          <span class="bingo-icon">${isCompleted ? '‚úÖ' : ''}</span>
          ${card.name}
        </div>
        <div class="bingo-progress">${completed}/${total} ports</div>
        <div class="progress-bar">
          <div class="progress-fill" style="width: ${percentage}%"></div>
        </div>
        <div class="bingo-tooltip">${card.howTo}</div>
      `;
      container.appendChild(cardEl);
    });
  }
  
  // Update statistics
  function updateStats() {
    const visited = visitedPorts.size;
    const total = PORTS_DB.length;
    const percentage = total > 0 ? Math.round(visited / total * 100) : 0;
    
    const countries = new Set();
    visitedPorts.forEach(portId => {
      const port = PORTS_DB.find(p => p.id === portId);
      if (port) countries.add(port.country);
    });
    
    const continents = new Set();
    visitedPorts.forEach(portId => {
      const port = PORTS_DB.find(p => p.id === portId);
      if (port) continents.add(port.continent);
    });
    
    const completedBingos = BINGO_CARDS.filter(card => {
      if (card.min) {
        return visitedPorts.size >= card.min;
      } else {
        return card.ports.every(p => visitedPorts.has(p));
      }
    }).length;
    
    document.getElementById('stat-ports').textContent = visited;
    document.getElementById('stat-percentage').textContent = percentage + '%';
    document.getElementById('stat-countries').textContent = countries.size;
    document.getElementById('stat-continents').textContent = continents.size;
    document.getElementById('stat-bingos').textContent = completedBingos;
    
    // Update comparison stats
    updateComparisonStats(visited, countries.size);
  }
  
  // Event listeners
  function attachEventListeners() {
    // Port checkboxes
    document.addEventListener('change', (e) => {
      if (e.target.classList.contains('port-checkbox')) {
        const portId = e.target.dataset.port;
        if (e.target.checked) {
          visitedPorts.add(portId);
          trackEvent('port_checked', {
            port_id: portId,
            total_ports: visitedPorts.size
          });
        } else {
          visitedPorts.delete(portId);
          trackEvent('port_unchecked', {
            port_id: portId,
            total_ports: visitedPorts.size
          });
        }
        saveData();
        renderPortList();
        renderBingoCards();
        updateStats();
      }
    });
    
    // Filter buttons
    document.querySelectorAll('.filter-button').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.dataset.region;
        trackEvent('filter_changed', {
          region: currentFilter
        });
        renderPortList();
      });
    });
    
    // Search box with debounced analytics tracking
    let searchTimeout;
    document.getElementById('search-box').addEventListener('input', (e) => {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => {
        if (e.target.value.length > 2) {
          trackEvent('port_search', {
            search_term: e.target.value,
            results_count: document.querySelectorAll('.port-item').length
          });
        }
      }, 1000);
      renderPortList();
    });
    
    // Share button
    document.getElementById('share-btn').addEventListener('click', () => {
      trackEvent('share_stats_opened', {
        ports_visited: visitedPorts.size
      });
      generateShareImage();
    });

    // Copy share link button
    document.getElementById('copy-link-btn').addEventListener('click', () => {
      copyShareURL();
    });
    
    // Export button
    document.getElementById('export-btn').addEventListener('click', () => {
      trackEvent('data_exported', {
        ports_visited: visitedPorts.size
      });
      exportData();
    });
    
    // Import button
    document.getElementById('import-btn').addEventListener('click', () => {
      document.getElementById('import-file').click();
    });
    
    document.getElementById('import-file').addEventListener('change', importData);
    
    // Reset button
    document.getElementById('reset-btn').addEventListener('click', () => {
      if (confirm('Are you sure you want to reset all your port visits? This cannot be undone.')) {
        trackEvent('data_reset', {
          ports_cleared: visitedPorts.size
        });
        visitedPorts.clear();
        saveData();
        renderPortList();
        renderBingoCards();
        updateStats();
      }
    });
    
    // Close modal
    document.getElementById('close-modal-btn').addEventListener('click', () => {
      document.getElementById('share-modal').classList.remove('active');
    });
    
    // Download share image
    document.getElementById('download-btn').addEventListener('click', downloadShareImage);
  }
  
  // Save data to localStorage
  function saveData() {
    localStorage.setItem('visited-ports', JSON.stringify([...visitedPorts]));
  }
  
  // Generate shareable image
  function generateShareImage() {
    const canvas = document.getElementById('share-canvas');
    const ctx = canvas.getContext('2d');

    // Background gradient
    const gradient = ctx.createLinearGradient(0, 0, 600, 400);
    gradient.addColorStop(0, '#0e6e8e');
    gradient.addColorStop(1, '#0a3d62');
    ctx.fillStyle = gradient;
    ctx.fillRect(0, 0, 600, 400);

    // Branding header
    ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
    ctx.fillRect(0, 0, 600, 80);

    // Title with branding
    ctx.fillStyle = '#ffffff';
    ctx.font = 'bold 28px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('‚öì Cruising In The Wake', 300, 35);
    ctx.font = 'bold 20px Arial';
    ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
    ctx.fillText('Port Logbook', 300, 60);

    // Stats section
    ctx.fillStyle = '#ffffff';
    ctx.font = 'bold 24px Arial';
    ctx.fillText('My Port Collection', 300, 110);

    const countries = new Set();
    visitedPorts.forEach(portId => {
      const port = PORTS_DB.find(p => p.id === portId);
      if (port) countries.add(port.country);
    });

    const stats = [
      { label: 'Ports Visited', value: visitedPorts.size },
      { label: 'Countries', value: countries.size },
      { label: 'Badges Earned', value: BINGO_CARDS.filter(card => {
        if (card.min) return visitedPorts.size >= card.min;
        return card.ports.every(p => visitedPorts.has(p));
      }).length }
    ];

    ctx.font = 'bold 48px Arial';
    let y = 170;
    stats.forEach(stat => {
      ctx.fillText(stat.value.toString(), 300, y);
      ctx.font = '20px Arial';
      ctx.fillText(stat.label, 300, y + 30);
      ctx.font = 'bold 48px Arial';
      y += 80;
    });

    // Footer with URL
    ctx.font = 'bold 18px Arial';
    ctx.fillStyle = '#ffffff';
    ctx.fillText('Track your ports at:', 300, 360);
    ctx.font = '16px Arial';
    ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
    ctx.fillText('cruisinginthewake.com/tools/port-tracker', 300, 385);

    // Show modal
    document.getElementById('share-modal').classList.add('active');
  }
  
  // Download share image
  function downloadShareImage() {
    trackEvent('share_image_downloaded', {
      ports_visited: visitedPorts.size
    });
    const canvas = document.getElementById('share-canvas');
    const link = document.createElement('a');
    link.download = 'my-cruise-ports.png';
    link.href = canvas.toDataURL();
    link.click();
  }
  
  // Export data as JSON
  function exportData() {
    const data = {
      visited: [...visitedPorts],
      exportDate: new Date().toISOString()
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = 'cruise-port-tracker-data.json';
    link.click();
    URL.revokeObjectURL(url);
  }
  
  // Import data from JSON
  function importData(e) {
    const file = e.target.files[0];
    if (!file) return;
    
    const reader = new FileReader();
    reader.onload = (event) => {
      try {
        const data = JSON.parse(event.target.result);
        if (data.visited && Array.isArray(data.visited)) {
          visitedPorts = new Set(data.visited);
          saveData();
          renderPortList();
          renderBingoCards();
          updateStats();
          trackEvent('data_imported', {
            ports_imported: data.visited.length
          });
          alert('Data imported successfully!');
        } else {
          alert('Invalid data format');
        }
      } catch (err) {
        alert('Error importing data: ' + err.message);
      }
    };
    reader.readAsText(file);
  }

  // Update comparison statistics
  function updateComparisonStats(portsVisited, countriesVisited) {
    // Calculate percentile based on typical cruiser distribution
    // Distribution: Most cruisers (70%) visit 5-20 ports, 20% visit 20-50, 10% visit 50+
    let percentile;
    let label;
    let badge = '';
    
    if (portsVisited === 0) {
      percentile = '--';
      label = 'Check some ports to see your ranking!';
    } else if (portsVisited <= 5) {
      percentile = 'Top 85%';
      label = 'You\'re just getting started! Keep cruising to climb the ranks.';
    } else if (portsVisited <= 10) {
      percentile = 'Top 70%';
      label = 'You\'ve visited more ports than most first-time cruisers!';
    } else if (portsVisited <= 15) {
      percentile = 'Top 50%';
      label = 'You\'re an average cruiser - right in the middle of the pack!';
      badge = '<span class="comparison-badge">‚≠ê Average Cruiser</span>';
    } else if (portsVisited <= 25) {
      percentile = 'Top 30%';
      label = 'You\'ve visited more ports than most cruisers. Well done!';
      badge = '<span class="comparison-badge">üåü Enthusiast</span>';
    } else if (portsVisited <= 35) {
      percentile = 'Top 20%';
      label = 'You\'re a serious cruiser! More ports than 80% of travelers.';
      badge = '<span class="comparison-badge">üèÜ Experienced Cruiser</span>';
    } else if (portsVisited <= 50) {
      percentile = 'Top 10%';
      label = 'Impressive! You\'ve visited more ports than 90% of cruisers!';
      badge = '<span class="comparison-badge">üíé Elite Cruiser</span>';
    } else if (portsVisited <= 75) {
      percentile = 'Top 5%';
      label = 'You\'re in the Super Cruiser Club! Only 5% reach this level.';
      badge = '<span class="comparison-badge">üëë Super Cruiser</span>';
    } else if (portsVisited <= 100) {
      percentile = 'Top 2%';
      label = 'Legendary! You\'ve explored more ports than 98% of cruisers!';
      badge = '<span class="comparison-badge">üåü Port Master</span>';
    } else {
      percentile = 'Top 1%';
      label = 'Ultimate Cruiser! You\'re among the most traveled cruisers in the world!';
      badge = '<span class="comparison-badge">üèÖ Ultimate Cruiser</span>';
    }
    
    document.getElementById('compare-percentile').textContent = percentile;    
    // Track achievement level changes
    const currentLevel = localStorage.getItem('last_achievement_level');
    const newLevel = percentile;
    if (currentLevel !== newLevel && percentile !== '--') {
      trackEvent('achievement_level_reached', {
        level: percentile,
        ports_visited: portsVisited,
        badge: badge.replace(/<[^>]*>/g, '').trim() // Remove HTML tags
      });
      localStorage.setItem('last_achievement_level', newLevel);
    }
    
    document.getElementById('compare-label').textContent = label;
    document.getElementById('compare-badge').innerHTML = badge;
    document.getElementById('compare-vs-avg').textContent = portsVisited;
    
    // Super Cruiser Club status
    if (portsVisited >= 50) {
      document.getElementById('compare-club').textContent = '‚úÖ Member';
      document.getElementById('compare-club-label').textContent = 'Welcome to the Super Cruiser Club! You\'re in the top 5% of all cruisers.';
    } else {
      const remaining = 50 - portsVisited;
      document.getElementById('compare-club').textContent = remaining + ' to go';
      document.getElementById('compare-club-label').textContent = `Visit ${remaining} more port${remaining > 1 ? 's' : ''} to join the elite Super Cruiser Club (top 5%)`;
    }
    
    // Country comparison
    document.getElementById('compare-countries-stat').textContent = countriesVisited;
    document.getElementById('compare-countries-count').textContent = countriesVisited;
    
    const avgCountries = 6;
    if (countriesVisited > avgCountries * 2) {
      document.getElementById('compare-countries-count').textContent = countriesVisited + ' (exceptional!)';
    } else if (countriesVisited > avgCountries) {
      document.getElementById('compare-countries-count').textContent = countriesVisited + ' (above average!)';
    }
  }
  
  // Toggle collapsible sections
  window.toggleSection = function(element) {
    const section = element.closest('.region-section');
    section.classList.toggle('collapsed');
  };

  // URL State Sharing
  function loadStateFromURL() {
    const params = new URLSearchParams(window.location.search);
    const portsParam = params.get('ports');
    if (portsParam) {
      try {
        // Decode base64 encoded port list
        const decoded = atob(portsParam);
        const portIds = decoded.split(',');
        visitedPorts = new Set(portIds.filter(id => PORTS_DB.some(p => p.id === id)));
        saveData();
      } catch (e) {
        console.error('Error loading state from URL:', e);
      }
    }
  }

  function generateShareURL() {
    const portIds = Array.from(visitedPorts).join(',');
    const encoded = btoa(portIds);
    const url = new URL(window.location.href);
    url.searchParams.set('ports', encoded);
    return url.toString();
  }

  function copyShareURL() {
    const url = generateShareURL();
    navigator.clipboard.writeText(url).then(() => {
      alert('Share link copied to clipboard! Send it to your friends to compare port collections.');
      trackEvent('share_url_copied', {
        ports_visited: visitedPorts.size
      });
    }).catch(err => {
      console.error('Failed to copy:', err);
      prompt('Copy this link to share:', url);
    });
  }

  // Load state from URL on init
  loadStateFromURL();

  // Initialize on load
  init();
})();
  </script>

  <!-- Navigation dropdown functionality -->
    <!-- Navigation dropdown functionality (New Clean Implementation) -->
  <script>
  (function() {
    'use strict';
    var dropdowns = document.querySelectorAll('.nav-dropdown');
    function toggleDropdown(dropdown) {
      var isOpen = dropdown.classList.contains('open');
      closeAllDropdowns();
      if (!isOpen) {
        dropdown.classList.add('open');
        var btn = dropdown.querySelector('button');
        if (btn) btn.setAttribute('aria-expanded', 'true');
      }
    }
    function closeAllDropdowns() {
      dropdowns.forEach(function(dd) {
        dd.classList.remove('open');
        var btn = dd.querySelector('button');
        if (btn) btn.setAttribute('aria-expanded', 'false');
      });
    }
    dropdowns.forEach(function(dropdown) {
      var btn = dropdown.querySelector('button');
      if (btn) {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          toggleDropdown(dropdown);
        });
        btn.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') { closeAllDropdowns(); btn.focus(); }
          if (e.key === 'ArrowDown') {
            e.preventDefault();
            dropdown.classList.add('open');
            btn.setAttribute('aria-expanded', 'true');
            var firstLink = dropdown.querySelector('.dropdown-menu a');
            if (firstLink) firstLink.focus();
          }
        });
      }
      var menu = dropdown.querySelector('.dropdown-menu');
      if (menu) {
        menu.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') { closeAllDropdowns(); if (btn) btn.focus(); }
        });
      }
    });
    document.addEventListener('click', function(e) {
      var isInsideDropdown = false;
      dropdowns.forEach(function(dd) { if (dd.contains(e.target)) isInsideDropdown = true; });
      if (!isInsideDropdown) closeAllDropdowns();
    });
  })();
  </script>
  </div><!-- /.tracker-container -->
  </main><!-- /#content -->

  <script>
  (function(){
    "use strict";

    /* ===== Recent Articles Rail ===== */
    (async function recentRail(){
      const rail = document.getElementById('recent-rail');
      if(!rail) return;

      const fallback = document.getElementById('recent-rail-fallback');
      if(fallback) fallback.style.display = '';

      async function fetchJSONWithFallback(urls){
        for (const u of urls){
          try{
            const res = await fetch(u, { credentials: 'omit', cache: 'no-cache' });
            if (res.ok) return await res.json();
          }catch(err){

          }
        }
        return null;
      }

      const pick = (obj, keys, fallback=null)=>{ for(const k of keys){ if(obj && obj[k] != null) return obj[k]; } return fallback; };

      function setImageWithFallback(imgEl, primary, altPaths=[]){
        if(!imgEl) return;
        const stamp='v=3.010.300';
        const tried=new Set();
        const queue=[primary,...altPaths].filter(Boolean).map(p => p.includes('?')?p+'&'+stamp:p+'?'+stamp);
        function tryNext(){
          const next=queue.shift();
          if(!next){ imgEl.removeAttribute && imgEl.removeAttribute('onerror'); return; }
          if(tried.has(next)) return tryNext();
          tried.add(next);
          imgEl.src=next;
        }
        imgEl.onerror=tryNext;
        tryNext();
      }

      const raw = await fetchJSONWithFallback(['/assets/data/articles/index.json','/assets/data/articles.json']);
      if(!raw) {
        if(fallback) {
          fallback.textContent = 'Unable to load articles';
          fallback.style.display = '';
        }
        return;
      }

      const items = Array.isArray(raw?.articles) ? raw.articles : (Array.isArray(raw) ? raw : []);
      if(!items.length) return;

      const here = location.pathname.replace(/\/+$/,'');
      const view = items.filter(p=>{
        const href = pick(p,['url','path'],'#');
        const norm = (href||'').replace(/\/+$/,'');
        return norm && norm !== here;
      }).slice(0,6);

      rail.innerHTML = view.map(p=>{
        const title = pick(p,['title','name'],'Article');
        const href  = pick(p,['url','path'],'#');
        const excerpt = pick(p,['excerpt','description'],'');
        return `
          <article class="card" style="display:flex;flex-direction:column;gap:.75rem;padding:.85rem">
            <div style="display:grid;grid-template-columns:80px 1fr;gap:.75rem;align-items:start">
              <div style="width:80px;height:60px;overflow:hidden;border-radius:8px;background:#eef4f6;border:1px solid #dfe7ea;flex-shrink:0">
                <img class="article-thumb" alt="" decoding="async" loading="lazy" style="width:100%;height:100%;object-fit:cover">
              </div>
              <div>
                <h4 style="margin:0 0 .35rem 0;font-size:.9rem;line-height:1.3;font-weight:600">
                  <a href="\${href}" style="color:var(--accent,#0e6e8e);text-decoration:none">\${title}</a>
                </h4>
                \${excerpt ? `<p class="tiny" style="margin:0;line-height:1.4;color:var(--ink-mid,#3d5a6a)">\${excerpt}</p>` : ''}
              </div>
            </div>
            <a href="\${href}" class="pill" style="align-self:flex-start;font-size:.85rem;padding:.45rem .95rem;text-decoration:none">Read Article ‚Üí</a>
          </article>`;
      }).join('');

      const cards = [...rail.querySelectorAll('article.card')];
      cards.forEach((card,i)=>{
        const p = view[i] || {};
        const el = card.querySelector('img.article-thumb');
        const href  = (pick(p,['url','path'],'')||'').toLowerCase();
        const title = (pick(p,['title','name'],'')||'').toLowerCase();

        let primary = pick(p, ['thumb','thumbnail','image','cover','img'], null);

        // FORCE override for Top-20
        if (/(top-20|first-?cruise-?questions)/.test(href) || /top\s*20.*first.*cruise.*questions/.test(title)){
          primary = '/assets/articles/thumbs/top-20-questions/cover.webp';
        }
        // Friendly specifics
        if(!primary && (/freedom-of-your-own-wake/.test(href) || /freedom of your own wake/.test(title))){
          primary = '/assets/articles/thumbs/freedom-of-your-own-wake.webp';
        }
        if(!primary && (/why-i-started-solo-cruising/.test(href) || /why i started solo cruising/.test(title))){
          primary = '/assets/articles/thumbs/why-i-started-solo-cruising.webp';
        }
        if(!primary && (/\/travel(\.html)?$/.test(href) || /\btravel\b/.test(title))){
          primary = '/assets/articles/travel/cover.jpg';
        }

        // Heuristic fallback
        if(!primary){
          const slugify = s => (s||'').toLowerCase().replace(/https?:\/\/[^/]+/,'').replace(/[#?].*$/,'').split('/').filter(Boolean).pop()||'';
          const guess = slugify(href) || slugify(title);
          if(guess) primary = `/assets/articles/\${guess}/cover.jpg`;
        }

        const alts = [];
        if(primary){
          const base = primary.replace(/\.(jpg|jpeg|png|webp)$/i,'');
          alts.push(`\${base}.jpeg`, `\${base}.JPG`, `\${base}.webp`, `\${base}.png`);
        }
        setImageWithFallback(el, primary || '/assets/index_hero.webp', alts);
      });

      if(fallback) fallback.style.display = 'none';

      // Announce to screen readers
      const status = document.getElementById('a11y-status');
      if(status) {
        status.textContent = `\${view.length} recent articles loaded`;
      }
    })();
  })();
  </script>

<!-- Dropdown nav behavior (300ms Hover Delay) -->
  <script>
  (function(){"use strict";
    /* ===== Dropdown Menu with 300ms Hover Delay ===== */
    const dropdownGroups = Array.from(document.querySelectorAll('.nav-group'));
    if (dropdownGroups.length) {
      const hoverTimeouts = new Map();
      const HOVER_DELAY = 300;

      function setOpen(group, isOpen) {
        group.dataset.open = isOpen ? "true" : "false";
        const button = group.querySelector('
      }

      function closeAll(except = null) {
        dropdownGroups.forEach(group => {
          if (group !== except) {
            setOpen(group, false);
            if (hoverTimeouts.has(group)) {
              clearTimeout(hoverTimeouts.get(group));
              hoverTimeouts.delete(group);
            }
          }
        });
      }

      dropdownGroups.forEach(group => {
        const button = group.querySelector(');

        group.addEventListener('mouseenter', () => {
          if (hoverTimeouts.has(group)) {
            clearTimeout(hoverTimeouts.get(group));
            hoverTimeouts.delete(group);
          }
          closeAll(group);
          setOpen(group, true);
        });

        group.addEventListener('mouseleave', () => {
          const timeoutId = setTimeout(() => {
            setOpen(group, false);
            hoverTimeouts.delete(group);
          }, HOVER_DELAY);
          hoverTimeouts.set(group, timeoutId);
        });

        group.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            setOpen(group, false);
            button && button.focus();
          }
          if ((e.key === 'ArrowDown' || e.key === 'ArrowUp') && document.activeElement === button) {
            e.preventDefault();
            setOpen(group, true);
            const firstLink = menu.querySelector('a, button, [tabindex]:not([tabindex="-1"])');
            firstLink && firstLink.focus();
          }
        });

        menu.addEventListener('focusout', () => {
          setTimeout(() => {
            if (!group.contains(document.activeElement)) {
              setOpen(group, false);
            }
          }, 0);
        });
      });

      document.addEventListener('click', (e) => {
        if (!e.target.closest('.nav-group')) {
          closeAll();
        }
      });

      window.addEventListener('blur', () => {
        closeAll();
      });
    }
  })();
  </script>

</body>
</html>
