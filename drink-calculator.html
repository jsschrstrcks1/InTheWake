<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ========================== CONFIG (keep at top) ========================== -->
  <script>
    window.ITW_PAGE = {
      id: "drinks-calculator",
      title: "Drink Packages — Break-Even Calculator",
      version: "v3.010.102",
      hero: { image: "/assets/img/sea-hero.jpg", creditHTML: 'Photo © Flickers of Majesty' },
      navActive: "Planning",           // highlights Planning in navbar
      rail: { showRecent: true, showAuthor: true },
      calculator: {
        useWorker: true,
        datasetURL: "/assets/data/lines/royal-caribbean.json",
        fx: { supported: ["USD","GBP","EUR","CAD","AUD","INR","CNY","MXN","BRL"] }
      }
    };
  </script>
  <!-- ======================================================================== -->

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Drink Packages — Break-Even Calculator | In the Wake</title>
  <meta name="description" content="Find your break-even for Soda, Refreshment, and Deluxe packages, with kid discounts, gratuity, and per-day ranges. Works offline." />

  <!-- Site styles (reuse your existing bundle) -->
  <link rel="stylesheet" href="/assets/styles.css?v=v3.010.102" />
  <!-- (Optional) calculator tweak styles -->
  <style>
    /* Hero image keeps ship-lockup from overflowing on small screens */
    .hero-viewport { position: relative; max-height: min(52vh, 640px); overflow: clip; }
    .hero-viewport img { width: 100%; height: auto; display:block; object-fit: cover; }

    /* Page grid mirrors planning.html: main + rail */
    .page-wrap { max-width: 1200px; margin: 0 auto; padding: 20px 16px 48px; display: grid; grid-template-columns: 1fr 320px; gap: 24px; }
    @media (max-width: 1100px){ .page-wrap{ grid-template-columns: 1fr; } }

    /* Calculator card */
    .calc-card { background:#fff; border:1px solid var(--bd, #e5e7eb); border-radius:16px; padding:18px; box-shadow: 0 2px 8px rgba(0,0,0,.04); }

    /* Winner “packages” row harmonized with site pills */
    .packages .pkg { border:1px solid var(--bd,#e5e7eb); border-radius:14px; padding:12px; }
    .packages .pkg.winner { border-color:#059669; box-shadow: 0 0 0 2px rgba(5,150,105,.15); }

    /* Right rail cards (match Planning) */
    .rail .card { background:#fff; border:1px solid var(--bd,#e5e7eb); border-radius:14px; padding:12px; margin-bottom:14px; }

    /* Tiny header tweaks so the logo lockup never runs off-screen */
    .site-brand img { max-width: clamp(160px, 28vw, 360px); height: auto; }
    .nav-wrap { overflow: visible; }
  </style>

  <!-- Chart.js (required by the calculator’s chart) -->
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!-- Your site shell helpers (reuse existing) -->
  <script defer src="/assets/js/site-cache.js?v=v3.010.102"></script>
  <script defer src="/assets/js/sw-bridge.js?v=v3.010.102"></script>
  <script defer src="/assets/js/install.js?v=v3.010.102"></script>

  <!-- Calculator core (reuse your actual files/paths) -->
  <script type="module" defer src="/assets/js/drink-calculator.app.js?v=v.9.000.004"></script>
</head>

<body class="theme-in-the-wake">
  <!-- ===== Top Nav / Header (same skeleton as index/planning; portal-ready) ===== -->
  <header class="site-header">
    <div class="nav-bar">
      <a class="site-brand" href="/" aria-label="In the Wake — Home">
        <img src="/assets/img/lockups/in-the-wake.svg" alt="In the Wake" />
      </a>
      <div class="nav-wrap">
        <nav class="nav">
          <a class="btn" href="/">Home</a>

          <!-- Planning (portal dropdown) -->
          <div class="menu-portal">
            <button class="btn has-caret" data-portal="planning">Planning</button>
            <div class="menu" data-portal-target="planning">
              <a href="/planning.html">Overview</a>
              <a href="/ships/">Ships</a>
              <a href="/restaurants.html">Restaurants</a>
              <a href="/ports.html">Ports</a>
              <a class="active" href="/drinks-calculator.html">Drink Packages</a>
            </div>
          </div>

          <!-- Travel (portal dropdown) -->
          <div class="menu-portal">
            <button class="btn has-caret" data-portal="travel">Travel</button>
            <div class="menu" data-portal-target="travel">
              <a href="/solo.html">Solo</a>
              <a href="/packing-lists.html">Packing Lists</a>
              <a href="/travel.html">All Travel</a>
            </div>
          </div>

          <a class="btn" href="/about.html">About</a>
        </nav>
        <div class="build-pill">
          <img src="/assets/img/lockups/itw-mini.svg" alt="" aria-hidden="true" />
          <span id="build-version">v3.010.102</span>
        </div>
      </div>
    </div>
  </header>

  <!-- ============================= Hero ============================= -->
  <section class="hero-viewport">
    <img src="/assets/img/sea-hero-wide.jpg" alt="" />
    <div class="hero-credit pill">
      <span id="hero-credit">Photo © Flickers of Majesty</span>
    </div>
  </section>

  <!-- ===================== Main Content + Right Rail ===================== -->
  <main class="page-wrap">
    <!-- Main column -->
    <article class="calc-card">
      <h1>Drink Packages — Break-Even Calculator</h1>
      <p class="lede">Compare à-la-carte vs Soda, Refreshment, and Deluxe. Add minors (50% off), sea/port weighting, and currency display. Works offline.</p>

      <!-- FX note & offline chip (from your app) -->
      <p id="currency-note" class="small" style="margin:.25rem 0 .75rem">
        <!-- populated by renderFxNote() -->
      </p>
      <span id="offline-chip" class="pill" style="display:none">Offline</span>

      <!-- Calculator UI (mount points your app expects) -->
      <section id="calculator">
        <!-- Best value banner -->
        <div class="banner">
          <span id="best-chip" class="pill">Best value: —</span>
          <div id="best-text" class="small"></div>
        </div>

        <!-- Totals -->
        <p id="totals" class="totals strong" aria-live="polite"></p>

        <!-- Packages row (the app toggles .winner) -->
        <div class="packages">
          <div id="pkg-soda" class="pkg" data-card="soda">
            <div class="phd"><strong>Soda</strong> <span data-pkg-price="soda" class="pill"></span></div>
            <div class="small">Included value: <span data-inc="soda">—</span></div>
            <div id="soda-breakeven" class="small"></div>
          </div>
          <div id="pkg-refresh" class="pkg" data-card="refresh">
            <div class="phd"><strong>Refreshment</strong> <span data-pkg-price="refresh" class="pill"></span></div>
            <div class="small">Included value: <span data-inc="refresh">—</span></div>
            <div id="refresh-breakeven" class="small"></div>
          </div>
          <div id="pkg-deluxe" class="pkg" data-card="deluxe">
            <div class="phd"><strong>Deluxe</strong> <span data-pkg-price="deluxe" class="pill"></span> <span id="cap-badge" class="pill">$14.00</span></div>
            <div class="small">Included value: <span data-inc="deluxe">—</span> • Over-cap est: <span id="overcap-est">—</span></div>
            <div id="deluxe-breakeven" class="small"></div>
          </div>
        </div>

        <!-- Chart -->
        <div class="chart-wrap" style="height:280px;margin-top:10px">
          <canvas id="breakeven-chart" aria-label="Daily cost comparison chart"></canvas>
        </div>
        <p id="range-note" class="small muted"></p>

        <!-- Inputs and controls (your app wires these by [data-input]) -->
        <section class="inputs">
          <!-- Trip -->
          <fieldset class="row">
            <label for="input-days">Days</label>
            <input id="input-days" data-input="days" type="number" inputmode="numeric" min="1" max="365" value="7" />
            <label for="input-seadays">Sea days</label>
            <input id="input-seadays" data-input="seadays" type="number" inputmode="numeric" min="0" max="365" value="3" />
            <label class="switch"><input id="sea-toggle" type="checkbox" data-input="seaapply" checked />Weight sea/port</label>
            <label>Sea bias <span id="sea-weight-val">20%</span></label>
            <input type="range" min="0" max="40" step="1" value="20" data-input="seaweight" />
          </fieldset>

          <!-- Group -->
          <fieldset class="row">
            <label for="input-adults">Adults</label>
            <input id="input-adults" data-input="adults" type="number" min="1" max="20" value="1" />
            <label for="input-minors">Minors</label>
            <input id="input-minors" data-input="minors" type="number" min="0" max="20" value="0" />
          </fieldset>

          <!-- Mode -->
          <fieldset class="row">
            <label class="radio"><input type="radio" name="mode" id="mode-simple" checked /> Simple</label>
            <label class="radio"><input type="radio" name="mode" id="mode-itinerary" /> Itinerary (per-day)</label>
            <button id="jump-winner" type="button" class="pill">Jump to Best Value</button>
          </fieldset>

          <!-- Drinks (steppers use window.stepInput) -->
          <fieldset class="grid">
            <!-- a few examples; the app supports all keys -->
            <div class="row row--stepper">
              <label>Soda <span data-price-pill="soda" class="pill small"></span></label>
              <div class="input-stepper">
                <button type="button" onclick="stepInput('soda',-1)">−</button>
                <input data-input="soda" value="0" inputmode="decimal" />
                <button type="button" onclick="stepInput('soda',+1)">+</button>
              </div>
            </div>
            <div class="row row--stepper">
              <label>Cocktail <span data-price-pill="cocktail" class="pill small"></span></label>
              <div class="input-stepper">
                <button type="button" onclick="stepInput('cocktail',-1)">−</button>
                <input data-input="cocktail" value="0" inputmode="decimal" />
                <button type="button" onclick="stepInput('cocktail',+1)">+</button>
              </div>
            </div>
            <!-- …repeat for remaining types your app knows… -->
          </fieldset>

          <!-- Actions -->
          <div class="row">
            <button type="button" class="btn" onclick="resetInputs()">Reset</button>
            <button type="button" class="btn" onclick="shareScenario()">Share Scenario</button>
            <button type="button" class="btn" onclick="printResults()">Print</button>
          </div>
        </section>

        <!-- Group breakdown -->
        <section id="group-breakdown" hidden>
          <h2>Group Breakdown</h2>
          <table class="table">
            <thead><tr><th>Who</th><th>Package</th><th>Per-day</th><th>Trip</th></tr></thead>
            <tbody id="group-table-body"></tbody>
          </table>
        </section>

        <!-- a11y live region -->
        <div id="a11y-status" class="sr-only" aria-live="polite"></div>
      </section>
    </article>

    <!-- Right rail (borrows Planning layout) -->
    <aside class="rail">
      <section class="card">
        <h3>Recent Articles</h3>
        <ul class="list-media">
          <li><a href="/solo/freedom-of-your-own-wake.html"><img src="/assets/img/articles/freedom-thumb.jpg" alt="" /> Freedom of Your Own Wake</a></li>
          <li><a href="/solo/why-i-started-solo-cruising.html"><img src="/assets/img/articles/solo-started-thumb.jpg" alt="" /> Why I Started Solo Cruising</a></li>
          <li><a href="/planning/top-20-first-cruise-questions.html"><img src="/assets/img/articles/top20-thumb.jpg" alt="" /> Top 20 First-Cruise Questions</a></li>
        </ul>
      </section>

      <section class="card">
        <h3>About the Author</h3>
        <div class="media">
          <img class="avatar" src="/assets/img/authors/ken-baker.jpg" alt="Ken Baker" />
          <div>
            <strong>Ken Baker</strong>
            <p class="small">Founder of <em>In the Wake</em>; writer and editor of the logbook.</p>
            <p class="small"><a href="https://instagram.com/flickersofmajesty">@flickersofmajesty</a></p>
          </div>
        </div>
      </section>
    </aside>
  </main>

  <!-- Footer matches the rest of the site -->
  <footer class="site-footer">
    <p class="small">© <span id="year"></span> In the Wake.</p>
  </footer>

  <script>
    // Tiny page boot that reuses your existing calculator app and site chrome
    (function(){
      // version badge + year
      document.getElementById('build-version').textContent = window.ITW_PAGE?.version || 'v';
      document.getElementById('year').textContent = new Date().getFullYear();
      // hero credit
      const c = document.getElementById('hero-credit'); if (c) c.innerHTML = window.ITW_PAGE?.hero?.creditHTML || '';
      // mark active nav
      const active = (window.ITW_PAGE && ITW_PAGE.navActive) || '';
      document.querySelectorAll('.nav a, .menu a').forEach(a=>{
        if (active && a.textContent.trim()===active) a.classList.add('active');
      });
      // if your portal menu JS needs a hook, it can target [data-portal]/[data-portal-target]
      // Calculator flags
      if (window.ITW_PAGE?.calculator) {
        window.fxDriftPct = 0; // keep default, your app reads this
      }
    })();
  </script>
</body>
</html>
