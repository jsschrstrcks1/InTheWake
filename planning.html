<!--
Soli Deo Gloria — may every pixel and paragraph bear His reflection, this site is offered as worship to God.

STANDARDS: Every Page v3.008 · Root/Main v3.008 · Unified Nav v3.008 · Right-Rail Articles+Author v3.008.025
A11y/WCAG Addendum v3.100 · CMP/Consent v3.008.020 · FB Domain Verification v3.008.021
Page: /planning.html · v3.008.025 · Built: 2025-10-20T00:00:00Z
GUARD RAIL: DO NOT REMOVE OR CHANGE USER-APPROVED VERBIAGE.
-->
<!doctype html>
<html lang="en">
<head>
  <!-- Consent (autoblocking) -->
  <script type="text/javascript" data-cmp-ab="1"
    src="https://cdn.consentmanager.net/delivery/autoblocking/e11a25480244a.js"
    data-cmp-host="a.delivery.consentmanager.net"
    data-cmp-cdn="cdn.consentmanager.net"
    data-cmp-codesrc="16"></script>

  <!-- Analytics -->
  <script defer src="https://cloud.umami.is/script.js" data-website-id="9661a449-3ba9-49ea-88e8-4493363578d2"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WZP891PZXJ"></script>
  <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-WZP891PZXJ');</script>

  <!-- Core meta -->
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="referrer" content="no-referrer">
  <meta name="robots" content="index, follow">
  <meta name="theme-color" content="#0e6e8e">
  <meta name="version" content="3.008.025"/>
  <meta name="page:version" content="3.008.025"/>
  <meta name="standards:baseline" content="3.008"/>
  <meta name="facebook-domain-verification" content="18im6oc23fy1oy8f8clbsb8bxniv4x"/>

  <!-- SEO -->
  <title>Planning — In the Wake (v3.008.025)</title>
  <meta name="description" content="Plan your voyage with confidence: calm guidance, state-by-state cruise ports, nearby airports, typical drive times, and gentle cautions—curated from real sailings." />

  <!-- Canonical & Social -->
  <link rel="canonical" href="https://www.cruisinginthewake.com/planning.html"/>
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="In the Wake">
  <meta property="og:url" content="https://www.cruisinginthewake.com/planning.html">
  <meta property="og:title" content="Planning — In the Wake">
  <meta property="og:description" content="Cruise planning made simple—timelines, airport-to-port tips, and steady answers in a gentle voice.">
  <meta property="og:image" content="https://www.cruisinginthewake.com/assets/social/planning-hero.jpg?v=3.008.025">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Breadcrumb JSON-LD -->
  <script type="application/ld+json">{
    "@context":"https://schema.org","@type":"BreadcrumbList",
    "itemListElement":[
      {"@type":"ListItem","position":1,"name":"Home","item":"https://www.cruisinginthewake.com/"},
      {"@type":"ListItem","position":2,"name":"Planning","item":"https://www.cruisinginthewake.com/planning.html"}
    ]
  }</script>

  <!-- URL normalizer -->
  <script>
  (function(){
    const ORIGIN=(location.origin||(location.protocol+'//'+location.host)).replace(/\/$/,'');
    window._abs=function(p){p=String(p||'');if(!p.startsWith('/'))p='/'+p;return ORIGIN+p;};
    function normalize(){
      const sel=['a[href^="https://www.cruisinginthewake.com/"]','img[src^="https://www.cruisinginthewake.com/"]','link[href^="https://www.cruisinginthewake.com/"]','script[src^="https://www.cruisinginthewake.com/"]'].join(',');
      document.querySelectorAll(sel).forEach(el=>{
        const attr=el.hasAttribute('href')?'href':'src';
        try{const u=new URL(el.getAttribute(attr));el.setAttribute(attr,ORIGIN+u.pathname+u.search+u.hash);}catch(_){}
      });
    }
    if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',normalize,{once:true});}else{normalize();}
  })();
  </script>

  <!-- External link hardener -->
  <script>
  (function(){
    const here=location.hostname.replace(/^www\./,'');
    function upgrade(){
      document.querySelectorAll('a[href]').forEach(a=>{
        const href=a.getAttribute('href')||'';
        if(/^(#|mailto:|tel:)/i.test(href))return;
        try{
          const u=new URL(href,location.href);
          const host=u.hostname.replace(/^www\./,'');
          if(host!==here||a.rel==='external'){
            a.target='_blank';
            a.rel=['noopener','noreferrer'].concat((a.rel||'').split(/\s+/)).filter(Boolean).join(' ');
          }
        }catch(_){}
      });
    }
    if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',upgrade,{once:true});}else{upgrade();}
  })();
  </script>

  <!-- Site cache & SW -->
  <script src="/assets/js/site-cache.js?v=3.008.025" defer></script>
  <script>
  if('serviceWorker' in navigator){
    window.addEventListener('load',()=>navigator.serviceWorker.register('/sw.js?v=3.008.025').catch(()=>{}));
  }
  </script>

  <!-- CSS -->
  <link rel="stylesheet" href="https://www.cruisinginthewake.com/assets/styles.css?v=3.008.025">

  <!-- LCP preload -->
  <link rel="preload" as="image" href="https://www.cruisinginthewake.com/assets/index_hero.jpg?v=3.008.025" fetchpriority="high">

  <!-- Page styles -->
  <style>
    @media (prefers-reduced-motion: reduce){
      *{animation-duration:.001ms!important;animation-iteration-count:1!important;transition-duration:.001ms!important;scroll-behavior:auto!important}
    }
    .visually-hidden-focusable{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
    .visually-hidden-focusable:focus{position:fixed;left:12px;top:12px;width:auto;height:auto;padding:.45rem .7rem;background:#fff;border:2px solid var(--sea,#0e6e8e);border-radius:10px;z-index:9999}
    .planning-grid{display:grid;gap:1.2rem}
    @media (min-width:1060px){ .planning-grid{grid-template-columns:minmax(0,1fr) 360px} }
    .hero{background:url('/assets/index_hero.jpg?v=3.008.025') center/cover no-repeat!important}
    .hero::before,.hero::after{content:none!important}
    .rail{display:grid;gap:.9rem}
    .rail .card .tiny.muted{opacity:.75}
    .rail-item{display:grid;grid-template-columns:112px 1fr;gap:.75rem;align-items:start}
    .rail-item .thumb img{display:block;width:112px;height:72px;object-fit:cover;border-radius:.5rem}
    .rail-item .avatar{width:20px;height:20px;border-radius:50%;vertical-align:middle;margin-right:.25rem}
    .card{position:relative;overflow:hidden}
    .card::after{content:"";position:absolute;inset:0;margin:auto;width:min(60%,360px);height:min(60%,360px);background:url('/assets/watermark.png?v=3.008.025') center/contain no-repeat;opacity:.06;pointer-events:none}
    .banner{padding:.7rem .9rem;border:1px solid var(--rope,#cfd9df);border-radius:.75rem;background:#fbfdff}
    .banner.warn{background:#fff8f8;border-color:#ffd1d1}
    .grid-airports{display:grid;grid-template-columns:1fr;gap:.6rem}
    @media(min-width:560px){ .grid-airports{grid-template-columns:repeat(2,minmax(0,1fr));} }
    .airport{padding:.7rem .8rem;border:1px solid var(--rope,#dfe7ee);border-radius:.6rem;background:#fff}
    .airport .code{font-weight:700}
    details.qa{border:1px solid var(--rope,#dfe7ee);border-radius:.6rem;padding:.5rem .7rem;background:#fff}
    details.qa + details.qa{margin-top:.5rem}

    /* state buttons + panels */
    .state-buttons{display:flex;flex-wrap:wrap;gap:.4rem .5rem}
    .state-buttons .btn{display:inline-block;padding:.35rem .7rem;border:1px solid var(--rope,#dfe7ee);border-radius:999px;background:#fff;cursor:pointer}
    .state-buttons .btn[aria-current="true"]{background:var(--sky,#f4fbff);border-color:var(--sea,#0e6e8e)}
  </style>
</head>

<body class="page">
  <a class="visually-hidden-focusable" href="#content">Skip to main content</a>

  <header class="site-header hero-header">
    <div class="navbar">
      <div class="brand">
        <img src="/assets/logo_wake.png?v=3.008.025" width="256" height="64" alt="In the Wake wordmark">
        <span class="tiny version-badge">v3.008.025</span>
      </div>
      <nav class="pill-nav pills" aria-label="Primary">
        <a href="https://www.cruisinginthewake.com/">Home</a>
        <a href="https://www.cruisinginthewake.com/ships/">Ships</a>
        <a href="https://www.cruisinginthewake.com/restaurants.html">Restaurants &amp; Menus</a>
        <a href="https://www.cruisinginthewake.com/ports.html">Ports</a>
        <a href="https://www.cruisinginthewake.com/disability-at-sea.html">Accessibility</a>
        <a href="https://www.cruisinginthewake.com/drink-packages.html">Drink Packages</a>
        <a href="https://www.cruisinginthewake.com/packing-lists.html">Packing Lists</a>
        <a href="https://www.cruisinginthewake.com/planning.html" aria-current="page">Planning</a>
        <a href="https://www.cruisinginthewake.com/solo.html">Solo</a>
        <a href="https://www.cruisinginthewake.com/travel.html">Travel</a>
        <a href="https://www.cruisinginthewake.com/cruise-lines.html">Cruise Lines</a>
        <a href="https://www.cruisinginthewake.com/about-us.html">About</a>
      </nav>
    </div>

    <div class="hero" role="img" aria-label="Ship wake at sunrise">
      <div class="latlon-grid" aria-hidden="true"></div>
      <img class="hero-compass" src="/assets/compass_rose.svg?v=3.008.025" width="180" height="180" alt="" aria-hidden="true">
      <div class="hero-title">
        <img class="logo" src="/assets/logo_wake.png?v=3.008.025" width="256" height="64" alt="In the Wake">
        <div class="tagline">A Cruise Traveler’s Logbook</div>
      </div>
      <div class="hero-credit">
        <a class="pill long" href="https://instagram.com/flickersofmajesty" target="_blank" rel="noopener">Photo © Flickers of Majesty</a>
      </div>
    </div>
  </header>

  <main id="content" class="wrap planning-grid" role="main">
    <!-- LEFT -->
    <div>
      <section class="card prose" aria-labelledby="planning-intro">
        <h1 id="planning-intro">Planning That Feels Like Smooth Water</h1>
        <p class="motto"><em>The calmest seas are found in another’s wake.</em></p>
        <p>Good planning trades hurry for margin. Fly in a day early when you can, keep documents backed up, and give yourself a little space at every hand-off. Our goal is to help you tuck in behind a steady hull—so the chop softens, the course steadies, and decisions feel easy.</p>
        <div class="banner">
          <strong>Quick Tips:</strong>
          <ul>
            <li>Arrive the day before embarkation; sleep near the port when possible.</li>
            <li>Keep photos of IDs, insurance, and tickets (and one cloud copy).</li>
            <li>Book nonstops when you can; delay risk compounds with connections.</li>
            <li>Pad transfers around <em>rush hour</em>, events, and school breaks.</li>
          </ul>
        </div>
      </section>

      <section class="card" aria-labelledby="state-port-selector">
        <h2 id="state-port-selector">Find Your Departure</h2>
        <p class="tiny muted">Click a <strong>button</strong> for your state or country, then pick your port. We’ll show nearby airports, typical drives, and gentle cautions.</p>

        <div class="state-buttons" id="state-buttons" role="tablist" aria-label="States and Countries"></div>
        <div id="state-panels" style="margin-top:.8rem"></div>
      </section>

      <section class="card" aria-labelledby="timing">
        <h2 id="timing">Timing That Loves Your Future Self</h2>
        <div class="banner tiny" id="school-breaks"></div>
      </section>
    </div>

    <!-- RIGHT RAIL -->
    <aside class="rail" aria-label="Right rail">
      <section class="card" aria-labelledby="jr-title">
        <h3 id="jr-title">From the Journal</h3>
        <p class="tiny muted">Articles from our writers’ wakes.</p>
        <div class="rail" id="rail-mount"></div>
        <p id="journal-rail-fallback" class="tiny" aria-live="polite" style="display:none">Loading articles…</p>
      </section>

      <section class="card" aria-labelledby="author-title">
        <h3 id="author-title">About the Author</h3>
        <article class="rail-item" role="article">
          <a class="thumb" href="/authors/ken-baker.html">
            <img src="/assets/authors/ken.jpg?v=3.008.025" alt="Ken Baker" onerror="this.onerror=null;this.src='/assets/placeholders/author.jpg?v=3.008.025'">
          </a>
          <div class="meta">
            <h4><a href="/authors/ken-baker.html">Ken Baker</a></h4>
            <p class="tiny">Traveler, pastor, storyteller. Writing toward calmer seas for every cruiser.</p>
            <p class="tiny"><a href="/solo.html">Solo</a> · <a href="/travel.html">Travel</a></p>
          </div>
        </article>
      </section>
    </aside>
  </main>

  <footer class="wrap" role="contentinfo">
    © 2025 In the Wake — A Cruise Traveler’s Logbook ·
    <a href="/accessibility.html">Accessibility &amp; WCAG 2.1 AA Commitment</a>
    <p class="tiny center" style="margin-top:.5rem">Soli Deo Gloria — may every pixel and paragraph bear His reflection, this site is offered as worship to God.</p>
  </footer>

  <!-- ===== Inline dataset (primary) ===== -->
  <script id="planning-dataset-inline" type="application/json">{
    "version":"0.6-intl",
    "last_updated":"2025-10-20T00:00:00Z",
    "school_break_signals":{
      "spring_break":{"window":"mid-Feb → early Apr","notes":"K-12 varies by district (most in March). Colleges peak early–mid March. Expect crowded airports/interstates and pricier hotels."},
      "fall_break":{"window":"late Sep → mid-Oct","notes":"Adopted by some districts; modest demand bump on long weekends."},
      "other_spikes":["Thanksgiving week","Christmas–New Year’s","Long weekends: MLK, Presidents', Memorial, Labor, Indigenous/Columbus, Veterans"]
    },
    "states":[
      {
        "code":"FL","name":"Florida",
        "blurb":"Florida is home base for many itineraries. Fly in a day early if possible—thunderstorms and rush hour can stack delays.",
        "tips":["Book refundable hotels near the port","Use SunPass-ready rentals or plan for tolls","Budget extra time for I-95 / I-595 backups"],
        "warnings":["Summer storms can ground flights temporarily","I-95/I-195/I-395 rush hour is real","Holiday weekends = heavy port traffic"],
        "ports":[
          {"id":"MIA","name":"PortMiami","city":"Miami","rcl":true,
            "airports":[
              {"code":"MIA","name":"Miami (MIA)","approxDriveMins":20,"notes":"Closest to the port."},
              {"code":"FLL","name":"Fort Lauderdale (FLL)","approxDriveMins":40,"notes":"Often cheaper; I-95 variability."},
              {"code":"PBI","name":"Palm Beach (PBI)","approxDriveMins":80,"notes":"Smaller; Brightline+rideshare can work."}
            ]
          },
          {"id":"FLL","name":"Port Everglades","city":"Fort Lauderdale","rcl":true,
            "airports":[
              {"code":"FLL","name":"Fort Lauderdale (FLL)","approxDriveMins":12,"notes":"Closest/simplest hop."},
              {"code":"MIA","name":"Miami (MIA)","approxDriveMins":50,"notes":"More long-hauls; add buffer."}
            ]
          },
          {"id":"PCV","name":"Port Canaveral","city":"Cape Canaveral","rcl":true,
            "airports":[
              {"code":"MCO","name":"Orlando (MCO)","approxDriveMins":55,"notes":"Tolls on 528; rental e-toll useful."},
              {"code":"MLB","name":"Melbourne (MLB)","approxDriveMins":40,"notes":"Small/easy; limited routes."},
              {"code":"SFB","name":"Sanford (SFB)","approxDriveMins":75,"notes":"Budget carriers; longer drive."}
            ],
            "callouts":[
              {"kind":"launches","html":"Space Coast launches are magical. See the <a href='https://spaceflightnow.com/launch-schedule/' rel='noopener' target='_blank'>Spaceflight Now launch schedule</a>."}
            ]
          },
          {"id":"TPA","name":"Port Tampa Bay","city":"Tampa","rcl":true,
            "airports":[
              {"code":"TPA","name":"Tampa (TPA)","approxDriveMins":25,"notes":"Primary; excellent rideshare flow."},
              {"code":"PIE","name":"St. Pete–Clearwater (PIE)","approxDriveMins":40,"notes":"Budget carriers; beach traffic variability."},
              {"code":"SRQ","name":"Sarasota (SRQ)","approxDriveMins":70,"notes":"Small/easy; good for regional fares."}
            ]
          }
        ],
        "intraStateAirWarn":[
          "MIA↔FLL ~35–60 min; add time for I-95 backups",
          "MCO↔Port Canaveral ~50–75 min; NASA/528 congestion possible",
          "TPA↔Port Tampa ~20–35 min; bridges + game days can spike delays"
        ],
        "schoolBreaks":[
          "Spring breaks stagger Feb–Apr (K-12 & colleges).",
          "Summer family travel surges mid-Jun–mid-Aug.",
          "Thanksgiving, Christmas–New Year = premium demand."
        ]
      },
      {
        "code":"TX","name":"Texas",
        "blurb":"Galveston serves much of the central US. Consider flying into HOU for more Southwest options.",
        "tips":["Arrive a day early during storm season","Book parking early on sold-out weekends"],
        "warnings":["I-45 construction can snarl traffic","Fog can pause port ops in winter"],
        "ports":[
          {"id":"GLS","name":"Port of Galveston","city":"Galveston","rcl":true,
            "airports":[
              {"code":"HOU","name":"Houston Hobby (HOU)","approxDriveMins":55,"notes":"Often quickest."},
              {"code":"IAH","name":"Bush Intercontinental (IAH)","approxDriveMins":80,"notes":"Most nonstops; longer drive."}
            ]
          }
        ]
      },
      {
        "code":"NJ","name":"New Jersey",
        "blurb":"Cape Liberty is Newark-adjacent and a strong Northeast gateway.",
        "tips":["Target EWR for shortest transfer","Arrive early in winter for weather buffers"],
        "warnings":["Bridge/tunnel traffic peaks weekday PM","Winter nor’easters can disrupt flights"],
        "ports":[
          {"id":"EWRP","name":"Cape Liberty (Bayonne)","city":"Bayonne","rcl":true,
            "airports":[
              {"code":"EWR","name":"Newark (EWR)","approxDriveMins":20,"notes":"Closest, easiest."},
              {"code":"JFK","name":"JFK (NYC)","approxDriveMins":75,"notes":"Allow extra time; traffic variable."},
              {"code":"LGA","name":"LaGuardia (LGA)","approxDriveMins":60,"notes":"Weekend work can affect routes."}
            ]
          }
        ]
      },
      {
        "code":"MD","name":"Maryland",
        "blurb":"Baltimore is convenient to the Mid-Atlantic and capital region.",
        "tips":["Use BWI for shortest transfer","Watch for I-95 weekend delays"],
        "warnings":["Harbor tunnel closures/repairs add time"],
        "ports":[
          {"id":"BALT","name":"Port of Baltimore","city":"Baltimore","rcl":true,
            "airports":[
              {"code":"BWI","name":"Baltimore/Washington (BWI)","approxDriveMins":20,"notes":"Closest."},
              {"code":"DCA","name":"Reagan National (DCA)","approxDriveMins":65,"notes":"DC traffic variability."},
              {"code":"IAD","name":"Dulles (IAD)","approxDriveMins":80,"notes":"Consider only for intl routings."}
            ]
          }
        ]
      },
      {
        "code":"WA","name":"Washington",
        "blurb":"Seattle is your Alaska gateway; ships alternate Piers 66/91.",
        "tips":["Fly in at least a day ahead for Alaska sailings","Budget time for cruise-day traffic near Belltown/Interbay"],
        "warnings":["Incidents can quickly jam I-5","Summer events spike downtown traffic"],
        "ports":[
          {"id":"SEA","name":"Port of Seattle","city":"Seattle","rcl":true,
            "airports":[
              {"code":"SEA","name":"Seattle/Tacoma (SEA)","approxDriveMins":25,"notes":"Link light rail + rideshare options."},
              {"code":"PAE","name":"Paine Field (PAE)","approxDriveMins":50,"notes":"Limited but pleasant."}
            ]
          }
        ]
      },

      /* ===== INTERNATIONAL (displayed as countries) ===== */
      {
        "code":"CA-BC","name":"Canada — British Columbia",
        "blurb":"Vancouver is a beautiful, walkable embarkation city with easy transit from YVR.",
        "tips":["Arrive a day early; enjoy the seawall and Gastown","Canada Line (YVR→Waterfront) + short walk works well"],
        "warnings":["Peak summer + cruise weekends raise hotel rates"],
        "ports":[
          {"id":"YVRP","name":"Vancouver (Canada Place)","city":"Vancouver","rcl":true,
            "airports":[
              {"code":"YVR","name":"Vancouver Intl (YVR)","approxDriveMins":30,"notes":"Canada Line rail to Waterfront is ~30 min + walk."}
            ],
            "traffic_iframe":""
          }
        ]
      },
      {
        "code":"AU-NSW","name":"Australia — New South Wales",
        "blurb":"Sydney’s Overseas Passenger Terminal delivers iconic sail-aways beside the Opera House.",
        "tips":["Time your arrival to avoid Harbour Bridge peaks","Stay in The Rocks/CBD for an easy morning"],
        "warnings":["Event weeks (New Year, Mardi Gras) surge prices"],
        "ports":[
          {"id":"SYD","name":"Sydney (Overseas Passenger Terminal)","city":"Sydney","rcl":true,
            "airports":[
              {"code":"SYD","name":"Sydney (SYD)","approxDriveMins":25,"notes":"Train (T8) + Circular Quay is simple."}
            ],
            "traffic_iframe":""
          }
        ]
      },
      {
        "code":"UK-ENG","name":"United Kingdom — England",
        "blurb":"Southampton is the UK’s major cruise hub with direct rail from London Waterloo.",
        "tips":["Arrive day-early; consider a London night then rail","Pre-book transfers on busy turnarounds"],
        "warnings":["Strike days and weekend works alter rail schedules"],
        "ports":[
          {"id":"SOU","name":"Southampton","city":"Southampton","rcl":true,
            "airports":[
              {"code":"LHR","name":"London Heathrow (LHR)","approxDriveMins":90,"notes":"Rail/coach options; traffic variable."},
              {"code":"LGW","name":"Gatwick (LGW)","approxDriveMins":110,"notes":"Coach + rail viable."},
              {"code":"SOU","name":"Southampton (SOU)","approxDriveMins":15,"notes":"Regional flights; easiest when available."}
            ],
            "traffic_iframe":""
          }
        ]
      }
    ]
  }</script>

  <!-- ===== Right rail (articles) ===== -->
  <script>
  (function(){
    const V='3.008.025';
    const mount=document.getElementById('rail-mount');
    const fallback=document.getElementById('journal-rail-fallback');
    if(!mount) return;
    const abs=(p)=> (typeof _abs==='function'?_abs(p):p);
    function showFallback(on){ if(fallback) fallback.style.display=on?'':'none'; }

    const SOURCES=[
      '/assets/data/articles.json?v='+V,
      '/assets/data/articles/index.json?v='+V,
      '/solo/articles/index.json?v='+V
    ];

    const SEED=[
      {url:'/travel.html#top-20-questions',title:'Top 20 First-Cruise Questions (Answered)',date:'2025-10-17',
       dek:'Planning, packing, ports, and ship life—steady answers.',
       // Try the exact image used on Travel; fallback handled below:
       image:'/assets/articles/top-20-questions/cover.jpg?v='+V,
       author:{name:'Ken Baker',url:'/authors/ken-baker.html',image:'/assets/authors/ken.jpg?v='+V}},
      {url:'/solo/articles/freedom-of-your-own-wake.html',title:'Freedom of Your Own Wake',date:'2025-10-17',
       dek:'On choosing solitude without being alone.',
       image:'/assets/index_hero.jpg?v='+V,
       author:{name:'Ken Baker',url:'/authors/ken-baker.html',image:'/assets/authors/ken.jpg?v='+V}},
      {url:'/travel/tina-planning-grace-and-margin.html',title:'Travel Days with Grace & Margin',date:'2025-10-12',
       dek:'Tina’s calm, practical rhythm for less-stress embarkations.',
       image:'/assets/articles/tina-planning/cover.jpg?v='+V,
       author:{name:'Tina',url:'/authors/tina.html',image:'/assets/authors/tina.jpg?v='+V}}
    ];

    function normalize(payload){
      const list = Array.isArray(payload?.articles) ? payload.articles : (Array.isArray(payload) ? payload : []);
      return list.map(a=>({
        url: a.url||a.permalink||'#',
        title: a.title||a.headline||'Article',
        dek: a.dek||a.description||a.excerpt||'',
        date: a.datePublished||a.date||'',
        image: a.image||'',
        author: a.author||a.by||null
      })).filter(x=> x.url && (x.url.startsWith('/') || /^https?:\/\//.test(x.url)));
    }

    function safeDate(d){ return isNaN(Date.parse(d)) ? '' : new Date(d).toLocaleDateString(); }

    function card(a){
      // resilient image: try provided → special cases → placeholder
      let src = a.image || '';
      const special20 = ['/assets/articles/top-20-questions/cover.jpg?v='+V,
                         '/assets/travel/top-20-questions.jpg?v='+V,
                         '/assets/travel/top-20-hero.jpg?v='+V];
      const onerr = `this.onerror=null;this.src='${abs('/assets/placeholders/article-thumb.jpg?v='+V)}'`;
      return `
        <article class="rail-item">
          <a class="thumb" href="${a.url}">
            <img alt="${a.title}"
                 src="${src||special20[0]}"
                 onerror="this.onerror=null; if(this.dataset.alt1){ this.src=this.dataset.alt1; this.dataset.alt1=''; }
                          else if(this.dataset.alt2){ this.src=this.dataset.alt2; this.dataset.alt2=''; }
                          else { ${onerr} }"
                 data-alt1="${special20[1]}" data-alt2="${special20[2]}">
          </a>
          <div class="meta">
            <h4><a href="${a.url}">${a.title}</a></h4>
            <p class="tiny muted">
              ${a.date?safeDate(a.date):''}
              ${a.author?.name?` · <img class="avatar" src="${abs(a.author.image||'/assets/authors/ken.jpg?v='+V)}" alt="${a.author.name}"
                     onerror="this.onerror=null;this.src='${abs('/assets/placeholders/author.jpg?v='+V)}'"> <a class="author" href="${a.author.url||'#'}">${a.author.name}</a>`:''}
            </p>
            ${a.dek?`<p class="tiny">${a.dek}</p>`:''}
          </div>
        </article>`;
    }

    async function fetchFirst(urls){
      for(const u of urls){
        try{ const r=await fetch(abs(u),{cache:'no-store'}); if(r.ok) return await r.json(); }catch(_){}
      }
      return null;
    }

    (async function boot(){
      showFallback(true);
      let data = normalize(await fetchFirst(SOURCES));
      if(!data.length) data = SEED;
      // prefer Travel/Solo planning items first
      const score = (a)=> (/\btravel\b|\bsolo\b/i.test(a.url)?2:0) + (/\bquestion|\bplanning/i.test(a.title||'')?1:0);
      data.sort((a,b)=>score(b)-score(a));
      mount.innerHTML = data.slice(0,4).map(card).join('');
      showFallback(false);
    })();
  })();
  </script>

  <!-- ===== Planner runtime (buttons + panels) ===== -->
  <script>
  (function(){
    const abs=(p)=> (typeof _abs==='function'? _abs(p): p);
    const buttonsEl=document.getElementById('state-buttons');
    const panelsEl =document.getElementById('state-panels');
    const breaksEl =document.getElementById('school-breaks');

    function html(s){ return String(s||''); }
    function esc(s){ return String(s||'').replace(/[&<>"]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }

    function renderBreaks(meta){
      const sb = meta?.school_break_signals || {};
      const rows = [
        `<strong>Spring Break:</strong> ${esc(sb.spring_break?.window||'varies')} — ${esc(sb.spring_break?.notes||'')}`,
        `<strong>Fall Break:</strong> ${esc(sb.fall_break?.window||'varies')} — ${esc(sb.fall_break?.notes||'')}`,
        sb.other_spikes?.length ? `<strong>Also Busy:</strong> ${sb.other_spikes.join(', ')}` : ''
      ].filter(Boolean);
      breaksEl.innerHTML = rows.map(r=>`<div>${r}</div>`).join('');
    }

    function buildButtons(states, currentCode){
      buttonsEl.innerHTML='';
      states.forEach(s=>{
        const a=document.createElement('a');
        a.href='#';
        a.className='btn';
        a.textContent=s.name;
        a.setAttribute('role','tab');
        a.setAttribute('id','tab-'+s.code);
        a.dataset.code=s.code;
        if(s.code===currentCode) a.setAttribute('aria-current','true');
        a.addEventListener('click',(e)=>{
          e.preventDefault();
          selectState(s.code, states);
        });
        buttonsEl.appendChild(a);
      });
    }

    function panelForState(s){
      return `
      <section class="card" id="panel-${esc(s.code)}" role="tabpanel" aria-labelledby="tab-${esc(s.code)}">
        <h2>${esc(s.name)}</h2>
        ${s.blurb?`<p class="dek">${esc(s.blurb)}</p>`:''}
        ${s.tips?.length?`<h3>Tips</h3><ul>${s.tips.map(t=>`<li>${esc(t)}</li>`).join('')}</ul>`:''}
        ${s.warnings?.length?`<h3>Warnings</h3><ul class="tiny">${s.warnings.map(w=>`<li>${esc(w)}</li>`).join('')}</ul>`:''}
        ${Array.isArray(s.ports)&&s.ports.length?`
          <h3>Ports & Airports</h3>
          <div class="rail">
            ${s.ports.map(p=>`
              <article class="rail-item">
                <div class="thumb" aria-hidden="true"></div>
                <div class="meta">
                  <h4>${esc(p.name)} — ${esc(p.city)}</h4>
                  <p class="tiny muted">${p.rcl?'Royal Caribbean served':''}</p>
                  <ul class="tiny">
                    ${p.airports.map(a=>`<li><strong>${esc(a.code)}</strong> ${esc(a.name)} · ~${esc(a.approxDriveMins)} min <span class="muted">${esc(a.notes||'')}</span></li>`).join('')}
                  </ul>
                  ${Array.isArray(p.callouts)&&p.callouts.length? p.callouts.map(c=>`<div class="banner tiny" style="margin-top:.5rem">${html(c.html||'')}</div>`).join('') : '' }
                  ${p.traffic_iframe?`
                    <div class="banner" style="margin-top:.5rem">
                      <strong>Live Port Traffic:</strong>
                      <div class="port-traffic" style="margin-top:.5rem;aspect-ratio:16/9;background:#fff;border:1px solid #e5eef5;border-radius:.5rem;overflow:hidden">
                        <iframe title="Port Traffic — ${esc(p.name)}"
                                src="${esc(p.traffic_iframe)}"
                                loading="lazy" referrerpolicy="no-referrer"
                                style="width:100%;height:100%;border:0"></iframe>
                      </div>
                    </div>`:''}
                </div>
              </article>
            `).join('')}
          </div>`:''}
        ${s.intraStateAirWarn?.length?`<p class="tiny muted"><strong>Transfer notes:</strong> ${s.intraStateAirWarn.map(esc).join(' • ')}</p>`:''}
        ${s.schoolBreaks?.length?`<p class="tiny muted"><strong>Peak calendars:</strong> ${s.schoolBreaks.map(esc).join(' • ')}</p>`:''}
      </section>`;
    }

    function buildPanels(states, currentCode){
      panelsEl.innerHTML = states.map(s=>panelForState(s)).join('');
      states.forEach(s=>{
        const panel=document.getElementById('panel-'+s.code);
        if (panel) panel.hidden = s.code!==currentCode;
      });
    }

    function selectState(code, states){
      // toggle current button
      [...buttonsEl.querySelectorAll('.btn')].forEach(b=>b.removeAttribute('aria-current'));
      const btn = buttonsEl.querySelector(`[data-code="${CSS.escape(code)}"]`);
      if(btn) btn.setAttribute('aria-current','true');
      // toggle panels
      states.forEach(s=>{
        const panel=document.getElementById('panel-'+s.code);
        if(panel) panel.hidden = s.code!==code;
      });
      // scroll into view (respect reduced motion)
      const panel=document.getElementById('panel-'+code);
      if(panel){
        if(matchMedia('(prefers-reduced-motion: reduce)').matches){ panel.scrollIntoView(); }
        else { panel.scrollIntoView({behavior:'smooth',block:'start'}); }
      }
    }

    async function loadData(){
      // prefer inline; keep hooks here if you later serve as external JSON
      try{ return JSON.parse(document.getElementById('planning-dataset-inline').textContent); }
      catch(_){ return { states:[], school_break_signals:{} }; }
    }

    (async function boot(){
      const data = await loadData();
      const states = (data.states||[]).slice();

      // Deduplicate by code; prefer first occurrence
      const seen=new Set();
      const deduped=states.filter(s=>{ const key=s.code||s.name; if(!key||seen.has(key)) return false; seen.add(key); return true; });

      // Sort: Florida first, then alpha
      deduped.sort((a,b)=> (a.code==='FL'?-1:b.code==='FL'?1:(a.name||'').localeCompare(b.name||'')));

      renderBreaks(data);
      const defaultCode = deduped.length ? deduped[0].code : null;
      buildButtons(deduped, defaultCode);
      buildPanels(deduped, defaultCode);
    })();
  })();
  </script>
</body>
</html>
